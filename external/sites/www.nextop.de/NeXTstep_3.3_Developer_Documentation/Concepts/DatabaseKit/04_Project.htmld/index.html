<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<!-- Created with LatinByrd III -->
<!-- File: /Apps/NextDev/Concepts/DatabaseKit/04_Project.rtfd -->
<!-- Date: Sun Jun 28 19:35:54 1998 -->
<head>
<title>04_Project</title>
</head>

<body bgcolor="#FFFFFF" text="#000000" link="#0000FF" alink="#FF00FF" vlink="#FF0000">

<basefont size=3>

<p><font face="Times" size="-1">Release 3.3 Copyright</font> <font size="-1">&copy;</font><font face="Times" size="-1">1995 by NeXT Computer, Inc.&nbsp; All Rights Reserved.</font>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=6></td>

<td><font face="Helvetica" size="+3" color="#FF00FF"><b>4</b></font></td></tr>

</table>

<p><br><br>

<p><font face="Times" size="+3"><i>Creating a Database Project</i></font>

<p><br><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">Organizing a Database Kit application, as with all applications in NEXTSTEP, starts with a visit to Project Builder.&nbsp; After you use Project Builder to prepare your project for the special needs of a Database Kit application, you then design the application's user interface with Interface Builder.</font>

<p><font face="Times">This chapter describes the things you can do in Project Builder and Interface Builder</font><br>
<font face="Times">to accommodate a database application.&nbsp; The lion's share of the material presented here</font><br>
<font face="Times">is a demonstration of how you use Interface Builder to manipulate the objects in the</font><br>
<font face="Times">Database Kit palette.&nbsp; The fundamentals of Project Builder and Interface Builder are</font><br>
<font face="Times">presented in the <i>NEXTSTEP Development Tools and Techniques</i> manual (<b>/NextLibrary/Bookshelves/NextDeveloper</b>); it's assumed that you have some</font><br>
<font face="Times">familiarity with these applications.</font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=6></td>

<td><font face="Helvetica" size="+1"><b>Project Builder</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">The first thing you need to do is launch Project Builder and create a new project.&nbsp; Having accomplished this, you must prepare your project for its meeting with the Database Kit by:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Including the Database Kit library.</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Forcing the loading of unreferenced symbols.</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Incorporating model files.</font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Helvetica" size="+1"><b>The Database Kit Library</b></font>

<p><font face="Times">The Database Kit library contains the code that you need to make your database application work.&nbsp; To include the library in your project, double-click the Libraries suitcase in Project Builder's File Viewer, and select the file <b>libdbkit_s.a</b> in the Add Libraries panel.&nbsp; The Add Libraries panel automatically points to the <b>/usr/lib</b> directory, the default location for NEXTSTEP library files.&nbsp; This is where the Database Kit library is stored.</font>

<p><font face="Times">Figure 34 shows the File Viewer and Add Libraries panel poised for including the Database Kit library.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=107></td>

<td><img src="F0.gif" width=593 height=603></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Helvetica"><b>Figure 34</b></font><font face="Times">.&nbsp; Adding the Database Kit Library to your Project</font>

<p><br><br>

<p><font face="Times">In the File Viewer's list of libraries, the Database Kit library appears as <b>dbkit_s</b>, as shown in Figure 35.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=107></td>

<td><img src="F39.gif" width=501 height=377></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Helvetica"><b>Figure 35</b></font><font face="Times">.&nbsp; The Database Kit Library in Project Builder's Library List</font>

<p><br><br><br>

<p><font face="Helvetica" size="+1"><b>Loading Unreferenced Symbols</b></font>

<p><font face="Times">The Database Kit dynamically loads the adaptor(s) that you need.&nbsp; The adaptor code may refer to symbols from the Database Kit library, but since these references aren't resolved when your application is being compiled, these symbols won't necessarily be loaded into your application's executable image.&nbsp; To rectify this, you need to force the loader to load all the symbols that the adaptor might refer to; this is done by adding the following line to your project's <b>Makefile.preamble</b> file:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">OTHER_LDFLAGS = -u libdbkit_s -u libNeXT_s -u libsys_s</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">This line tells the loader to load all the symbols from the named libraries--even if they aren't referred to when the application is being compiled.&nbsp; When, in the course of your application's execution, an adaptor is dynamically loaded and used, the symbols that it needs are, thus, guaranteed to be present.</font>

<p><br><br><br>

<p><font face="Helvetica" size="+1"><b>Model Files</b></font>

<p><font face="Times">To incorporate a model file, whether in archive or ASCII format, you drag it into the Other Resources suitcase.&nbsp; You can incorporate as many models as you want; Figure 36 shows a project that has incorporated the Oracle and Sybase example models.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=107></td>

<td><img src="F1.gif" width=501 height=377></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Helvetica"><b>Figure 36</b></font><font face="Times">.&nbsp; Model Files in Project Builder</font>

<p><br><br>

<p><font face="Times">Double-clicking a model file entry in the Other Resources list opens the file in DBModeler.&nbsp; However, you should note that the changes that you make to a model may not be immediately recognized by your project's interface as presented through Interface Builder.</font>

<p><br><br><br>

<p><font face="Helvetica"><b>Model File Locations</b></font>

<p><font face="Times">When you drag a model file into Project Builder, the file is copied into the project.&nbsp; Exactly where it's placed depends on the file's format:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Archive models are copied into the main bundle (the <i>&quot;</i>.app&quot; directory).</font></td></tr>

<tr valign=top>

<td width=105 height=12></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">ASCII models are copied into the project directory (the directory immediately above the main bundle).</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">Only archive model files can be used in your (running) application, thus only archive format models are copied directly into the main bundle.&nbsp; However, when Project Builder builds your application, it creates, for each ASCII model that it finds in the project directory, an archive file that it stores in your project's main bundle.</font>

<p><font face="Times">Keep in mind that the models that are available to your application aren't limited to the files that you drag into your project.&nbsp; The model files stored in a <b>Databases</b> library (<b>~/Library/Databases</b>, <b>/LocalLibrary/Databases</b>, or <b>/NextLibrary/Databases</b>, if present) can also be used.</font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=6></td>

<td><font face="Helvetica" size="+1"><b>Interface Builder</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">The interface objects that are provided by the Database Kit for use in Interface Builder are manipulated in the same manner as standard Application Kit objects such as Button and Slider:&nbsp; You drag an object into a window and drop it on or connect it to some other object.</font>

<p><font face="Times">But even more than the standard objects, the Database Kit objects know about their neighbors and can create, configure, and connect a &quot;background&quot; layer of objects that provides the guts behind the interface skin.&nbsp; You can build a complete, working database application simply by manipulating the Database Kit interface objects.&nbsp; More remarkable still, most applications can actually form a connection to a server, and fetch and display data in Interface Builder's Test mode.&nbsp; Thus, not only do you not have to write a line of code to create a working database application, you never have to leave Interface Builder to see your application work.</font>

<p><font face="Times">This capability has its limits--sophisticated applications won't be completely served by the functionality provided by Interface Builder.&nbsp; But any application can benefit by the extent to which the Database Kit and Interface Builder work together.</font>

<p><br><br><br>

<p><font face="Helvetica" size="+1"><b>Installing the Database Kit Palette</b></font>

<p><font face="Times">Database Kit interface objects are provided to Interface Builder through the Database Kit palette, <b>/NextDeveloper/Palettes/DatabaseKit.palette</b>.&nbsp; Because of its location (in the <b>Palettes</b> directory), the Database Kit palette is automatically loaded into Interface Builder, but it isn't installed in Interface Builder's Palettes Tool window.&nbsp; To install the palette, you double-click the palette's icon in the Palettes display of Interface Builder's Preferences panel.&nbsp; Figure 37 shows the Database Kit palette in the Preferences panel.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=107></td>

<td><img src="F4.gif" width=395 height=309></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Helvetica"><b>Figure 37</b></font><font face="Times">.&nbsp; The Palettes Display in Interface Builder's Preferences Panel</font>

<p><br><br>

<p><font face="Times">The installed Database Kit palette takes its place in the Palettes window, as shown in Figure 38.</font>

<p><br><br>

<p><img src="F6.gif" width=274 height=276>

<p><font face="Helvetica"><b>Figure 38</b></font><font face="Times">.&nbsp; The Database Kit Palette in the Palettes Window</font>

<p><br><br><br>

<p><font face="Helvetica"><b>Palette Objects</b></font>

<p><font face="Times">There are three objects in the Database Kit palette:&nbsp; DBTableView, DBImageView, and DBModule.&nbsp; Briefly, these objects perform the following functions within your interface:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">DBTableView objects are used to display two-dimensional tables of data.</font></td></tr>

<tr valign=top>

<td width=105 height=12></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">DBImageViews display images (one image at a time).</font></td></tr>

<tr valign=top>

<td width=105 height=12></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">DBModules configure data-storing objects by reading database model files, and define action methods that fetch and save data.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">The images that represent these objects are shown in Figure 39.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=107></td>

<td><img src="F33.gif" width=367 height=166></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Helvetica"><b>Figure 39</b></font><font face="Times">.&nbsp; Database Kit Palette Objects</font>

<p><br><br><br>

<p><font face="Helvetica" size="+1"><b>Designing an Interface</b></font>

<p><font face="Times">The following sections describe how to use the Database Kit palette objects, as well as the standard control objects, to create a user interface for a database application.</font>

<p><br><br><br>

<p><font face="Helvetica"><b>Incorporating a DBModule</b></font>

<p><font face="Times">One of the first things you must do when designing a user interface is incorporate a DBModule object.&nbsp; You do this by dragging a DBModule object from the Database Kit palette and dropping it in the File window.</font>

<p><font face="Times">When you incorporate a DBModule, the object shows up in the Objects display in the File Window.&nbsp; The first DBModule is given the name &quot;DBModule&quot;; subsequent objects are named &quot;DBModule<i>N</i>&quot;.&nbsp; An incorporated DBModule object is shown in Figure 40; for clarity, the object's name has been changed to &quot;MyModule&quot;.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=107></td>

<td><img src="F8.gif" width=356 height=267></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Helvetica"><b>Figure 40</b></font><font face="Times">.&nbsp; A DBModule in the Objects Browser</font>

<p><br><br><br>

<p><font face="Helvetica"><b>The Model Browser</b></font>

<p><font face="Times">A DBModule's initial role is to gain access to the database model browser.&nbsp;&nbsp; This browser, shown in Figure 41, appears when you double-click a DBModule icon in the Objects display.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=107></td>

<td><img src="F9.gif" width=346 height=279></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Helvetica"><b>Figure 41</b></font><font face="Times">.&nbsp; The Model Browser</font>

<p><br><br>

<p><font face="Times">Each DBModule object has its own model browser; the name of the DBModule that owns a particular model browser is shown in the browser window's title bar.&nbsp; The DBModule icon and name are also shown in the browser's shelf; this shelf describes a model path (as defined in Chapter 2).</font>

<p><font face="Times">The first column in the model browser displays the names of the available models.&nbsp; Specifically, these are the models that you dragged into your project's Other Resources suitcase (as explained earlier) as well as the model files found in the various <b>Databases</b> libraries.</font>

<p><font face="Times">In considering model files, Interface Builder isn't constrained by the archive-only rule.&nbsp; The ASCII model files that you've dragged into your project will be presented for selection in the model browser, even if the models haven't yet been converted to archive format.</font>

<p><br><br>

<p><font face="Helvetica"><b>Selecting a Model</b></font>

<p><font face="Times">When you select a model from the browser's first column, that model's (unhidden) entities are displayed in the browser's second column.&nbsp; Figure 42 demonstrates this using the OracleDemo model as an example.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=107></td>

<td><img src="F10.gif" width=346 height=279></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Helvetica"><b>Figure 42</b></font><font face="Times">.&nbsp; Entities in the OracleDemo Model</font>

<p><br><br>

<p><font face="Times">Note that the model path displays, above the second column, a model icon and the name of the selected model.</font>

<p><br><br>

<p><font face="Helvetica"><b>Selecting an Entity</b></font>

<p><font face="Times">When you select an entity, the browser's third column is filled with that entity's (unhidden) properties, and the model path is supplemented accordingly, as shown in Figure 43 (the browser window has been resized for clarity; this resizing doesn't happen automatically).</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=107></td>

<td><img src="F11.gif" width=503 height=345></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Helvetica"><b>Figure 43</b></font><font face="Times">.&nbsp; Properties in the</font> <font face="Helvetica">Employee</font> <font face="Times">Entity</font>

<p><br><br>

<p><font face="Times">The properties that are listed in the browser are a compilation of the entity's attributes and relationships.&nbsp; Relationships are distinguished by single or double arrowheads; attributes lack this mark.&nbsp; A single arrowhead denotes a to-one relationship; a double arrowhead identifies a to-many relationship.</font>

<p><br><br>

<p><font face="Helvetica"><b>Selecting a Property</b></font>

<p><font face="Times">When you select a relationship in the browser, the relationship name is added to the model path, and the properties of the destination entity are displayed in the column beneath it.&nbsp; If the destination entity contains a relationship, selecting that relationship will add another column to the browser that displays the (nested) destination entity's properties.</font>

<p><font face="Times">This relationship-traversal ends, and the model path is complete, when you select an attribute.&nbsp; A complete model path is shown in Figure 44 (the model browser is limited to four columns of display; the model column has been scrolled out of bounds).&nbsp; Note that the relationship (</font><font face="Helvetica">toDepartment</font><font face="Times">) is represented by an entity icon.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=107></td>

<td><img src="F13.gif" width=620 height=346></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Helvetica"><b>Figure 44</b></font><font face="Times">.&nbsp; A Complete Model Path</font>

<p><br><br><br>

<p><font face="Helvetica"><b>Data Type Icons</b></font>

<p><font face="Times">The data type of the selected attribute is indicated by the icon that's displayed at the end of the model path.&nbsp; The correspondences between icons and data types is given in Figure 45.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=107></td>

<td><img src="F14.ai" width=48 height=48></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Helvetica"><b>Figure 45</b></font><font face="Times">.&nbsp; Attribute Data Type Icons</font>

<p><br><br><br>

<p><font face="Helvetica"><b>Configuring a DBTableView</b></font>

<p><font face="Times">DBTableView provides a two-dimensional table that can be filled with data from a database server.&nbsp; By default, a DBTableView object is oriented such that each (vertical) column presents the data for a particular attribute, and each (horizontal) row gives a single record.&nbsp; Figure 46 shows a DBTableView that's filled with employee data.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=107></td>

<td><img src="F15.gif" width=396 height=350></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Helvetica"><b>Figure 46</b></font><font face="Times">.&nbsp; A DBTableView Filled with Data</font>

<p><br><br>

<p><font face="Times">Configuring a DBTableView is mostly a matter of deciding what data you want it to display and then creating a correspondence, or association, between a column in the DBTableView and an attribute in a model that represents the chosen data.&nbsp; The following steps describe this process, using the employee table shown above as the goal.</font>

<p><br><br>

<p><font face="Helvetica"><b>Step 1:&nbsp; Get a DBTableView</b></font>

<p><font face="Times">The first thing you need to do is drag a DBTableView object from the Database Kit palette and drop it into a window.&nbsp; A freshly incorporated DBTableView has two columns and enough room for about six records.&nbsp; Figure 47 shows a DBTableView that has been resized (enlarged) from the default.&nbsp; Additional columns are added automatically as they're needed.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=107></td>

<td><img src="F2.gif" width=396 height=357></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Helvetica"><b>Figure 47</b></font><font face="Times">.&nbsp; A Freshly Resized DBTableView</font>

<p><br><br>

<p><font face="Helvetica"><b>Step 2:&nbsp; Find an Attribute</b></font>

<p><font face="Times">Now you need to find an attribute that you want to display.&nbsp; To do this you drag out a DBModule, open its model browser, and create a model path to the attribute.&nbsp; Figure 48 shows a model browser with a model path that ends at the</font> <font face="Helvetica">Employee.name </font><font face="Times">attribute.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=107></td>

<td><img src="F16.gif" width=614 height=284></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Helvetica"><b>Figure 48</b></font><font face="Times">.&nbsp; The</font> <font face="Helvetica">Employee.name</font> <font face="Times">Attribute in a Model Browser</font>

<p><br><br>

<p><font face="Helvetica"><b>Step 3:&nbsp; Drag the Attribute into the DBTableView</b></font>

<p><font face="Times">To associate an attribute in a model browser with a column in a DBTableView, you drag the attribute's icon into the DBTableView and drop it on a column.&nbsp; Figure 49 shows the DBTableView before and after the</font> <font face="Helvetica">Employee.name</font> <font face="Times">attribute is dropped into a column.&nbsp; Notice that the attribute's name is automatically used as the column's title.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=107></td>

<td><img src="F18.gif" width=539 height=446></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Helvetica"><b>Figure 49</b></font><font face="Times">.&nbsp; Before and After Dropping the</font> <font face="Helvetica">Employee.name</font> <font face="Times">Attribute</font>

<p><br><br>

<p><font face="Helvetica"><b>Step 4:&nbsp; Get More Attributes</b></font>

<p><font face="Times">To finish configuring the DBTableView, you simply repeat steps 2 and 3, selecting and dropping attributes until you're satisfied. However, once you've formed that first association--in other words, after you drop an attribute into an interface object--the DBModule restricts your attribute choices by &quot;locking&quot; the model browser on the entity of that first attribute.&nbsp; Figure 50 shows the model browser for MyModule after it's been locked.</font>

<p><br><br>

<p><img src="F21.gif" width=551 height=284>

<p><font face="Helvetica"><b>Figure 50</b></font><font face="Times">.&nbsp; A &quot;Locked&quot; Model Browser</font>

<p><br><br>

<p><font face="Times">In a locked model browser the model and entity selections can't be changed, as indicated by the disabled items in the model and entity columns.&nbsp; The model paths to all subsequent attribute selections must start with the locked entity--this is called the DBModule's</font><br>
<font face="Times"><i>root entity.</i>&nbsp; Thus, all model paths that are created through MyModule must start with &quot;Employee&quot;.</font>

<p><font face="Times">Figure 51 shows the fully-attributed employee table.&nbsp; All five attributes are direct properties of the root entity,</font> <font face="Helvetica">Employee</font><font face="Times">.&nbsp; The columns' widths have been resized to fit the expected data.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=107></td>

<td><img src="F19.gif" width=396 height=357></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Helvetica"><b>Figure 51</b></font><font face="Times">.&nbsp; The Fully-Configured Employee Table</font>

<p><br><br><br>

<p><font face="Helvetica"><b>Fetching Data</b></font>

<p><font face="Times">Configuring a DBTableView primes it for displaying data, but it say nothing of how the data is gotten from the server.&nbsp; For this you need to add a control object that, when prompted, will send a data-fetching message to the DBModule.</font>

<p><font face="Times">In Figure 52, a button, titled &quot;Fetch&quot;, has been added to the window.&nbsp; The button is connected to the DBModule through the usual methodology for connecting a control:&nbsp; You Control-drag from the control object to the DBModule, and then select an action method in the Connections Inspector.&nbsp; As shown in the figure, the DBModule method that causes data to be fetched is called <b>fetchAllRecords:</b>.</font>

<p><font face="Helvetica"><b>Note:</b></font>&nbsp; <font face="Times">DBModule's action methods are described in the section &quot;Controlling a DBModule,&quot; later in this chapter.&nbsp; The data-fetching method that's used here is provided simply to complete the current example.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=107></td>

<td><img src="F20.gif" width=527 height=393></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Helvetica"><b>Figure 52</b></font><font face="Times">.&nbsp; Connecting a Button to the DBModule</font>

<p><br><br>

<p><font face="Times">When the Fetch button is clicked, the appropriate data will be fetched and displayed in the DBTableView.</font>

<p><br><br><br>

<p><font face="Helvetica"><b>Testing the Interface</b></font>

<p><font face="Times">Now comes the amazing part.&nbsp; When you test the interface (through the Test Interface menu command), actual data is fetched from the server and displayed in the DBTableView.&nbsp; This action means that a connection to the server must be formed.&nbsp; If the adaptor that represents the server requires login information, it will display its login panel the first time the connection is attempted.&nbsp; Subsequent transactions with the same server should then proceed without the login panel's intercession.</font>

<p><font face="Times">The table shown in Figure 46, earlier in this chapter, shows the DBTableView filled with data that was fetched in Interface Builder's test mode.</font>

<p><br><br><br>

<p><font face="Helvetica" size="+1"><b>Joining Tables in a DBTableView</b></font>

<p><font face="Times">The example above showed a DBTableView that displayed data for attributes from a single entity.&nbsp; By traversing to-one relationships, you can associate attributes from any number of entities with columns in the same DBTableView.&nbsp; In other words, a DBTableView can show the result of a join (as the term is defined in Chapter 2).</font>

<p><font face="Times">Returning to the example, the</font> <font face="Helvetica">Employee</font> <font face="Times">entity contains the to-one relationships</font> <font face="Helvetica">toDepartment</font> <font face="Times">and</font> <font face="Helvetica">toManager</font><font face="Times">.&nbsp; The </font><font face="Helvetica">toManager</font> <font face="Times">relationship is reflexive--the destination is the</font> <font face="Helvetica">Employee</font> <font face="Times">entity--so the</font> <font face="Helvetica">toDepartment</font> <font face="Times">relationship is also a property of</font> <font face="Helvetica">Employee.toManager</font><font face="Times">.&nbsp;&nbsp; The Entity-Relationship model for this (excluding unnecessary information) is shown in Figure 53.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=107></td>

<td><img src="F22.gif" width=246 height=85></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Helvetica"><b>Figure 53</b></font><font face="Times">.&nbsp; Model for a Join</font>

<p><br><br>

<p><font face="Times">Because the relationships shown here are to-one, the records that are obtained through them can be joined and then displayed in the same DBTableView.&nbsp; To do this, you use DBModule's model browser to find the attributes you want, and then associate these attributes with columns in the DBTableView through the drag-and-drop technique&nbsp; previously described.</font>

<p><font face="Times">In Figure 54, each column in the DBTableView displays data that's obtained through a different path; the associations between attributes and columns are indicated.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=107></td>

<td><img src="F23.gif" width=459 height=424></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Helvetica"><b>Figure 54</b></font><font face="Times">.&nbsp; Joined Records</font>

<p><br><br>

<p><font face="Times">Obviously, the column titles have been modified (otherwise, they would all be called &quot;name&quot;).&nbsp; To select the text in a column's title, you triple-click on it.&nbsp; Having selected the text, you can then edit it.</font>

<p><br><br><br>

<p><font face="Helvetica"><b>Joins and Read-Only Data</b></font>

<p><font face="Times">The data that's fetched through a join is always read-only.&nbsp; In the table shown above, only the &quot;name&quot; column holds data that can be edited.</font>

<p><br><br><br>

<p><font face="Helvetica" size="+1"><b>Creating a Master-Detail Interface</b></font>

<p><font face="Times">A master-detail presentation is a way of realizing a to-many relationship.&nbsp; In this technique, the master table holds records for the source of the relationship; the detail table contains records for the destination.&nbsp; As individual records in the master table are selected, the contents of the detail table changes to show the records that correspond to the selection in the master.</font>

<p><br><br><br>

<p><font face="Helvetica"><b>A Simple Example</b></font>

<p><font face="Times">Referring to MyModule's model browser, we see that the</font> <font face="Helvetica">Employee</font> <font face="Times">entity contains the to-many relationship</font> <font face="Helvetica">toCustomers</font><font face="Times">, as shown in Figure 55.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=107></td>

<td><img src="F24.gif" width=616 height=279></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Helvetica"><b>Figure 55</b></font><font face="Times">.&nbsp; A To-Many Relationship in the Model Browser</font>

<p><br><br>

<p><font face="Times">This relationship means that a single employee may be responsible for any number of customers.&nbsp; To realize this relationship, you need two DBTableViews:&nbsp; Employee information is displayed in one table (the master) and customer information in the other (the detail).</font>

<p><font face="Times">To create the associations, you simply drag attributes from the</font> <font face="Helvetica">Employee</font> <font face="Times">entity into the columns of the master DBTableView, and drag attributes from the destination of the</font>&nbsp; <font face="Helvetica">Employee.toCustomers</font> <font face="Times">relationship into the columns of the detail.&nbsp; Either or both of the DBTableViews can present the result of a join.</font>

<p><font face="Times">Figure 56 shows an appropriately configured master-detail interface.&nbsp; Notice that the deptName column in the Employees table is associated with an attribute that's obtained through a join (in other words, through the to-one relationship </font><font face="Helvetica">Employee.toDepartment</font><font face="Times">).</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=107></td>

<td><img src="F25.gif" width=591 height=343></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Helvetica"><b>Figure 56</b></font><font face="Times">.&nbsp; Master-Detail Tables</font>

<p><br><br>

<p><font face="Times">When the Fetch button is clicked, the two tables are filled with data.&nbsp; As the user selects records in the Employees table, the appropriate customer records are displayed in the Customers table.&nbsp; Figure 57 and Figure 58 show the master-detail interface in action.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=107></td>

<td><img src="F26.gif" width=569 height=234></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Helvetica"><b>Figure 57</b></font><font face="Times">.&nbsp; Master-Detail in Action; Part 1</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=107></td>

<td><img src="F27.gif" width=569 height=234></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Helvetica"><b>Figure 58</b></font><font face="Times">.&nbsp; Master-Detail in Action; Part 2</font>

<p><br><br><br>

<p><font face="Helvetica"><b>Nested Master-Detail Tables</b></font>

<p><font face="Times">Master-detail tables can be nested such that a single DBTableView acts as the detail table in one relationship and the master in another.&nbsp; To create this type of interface, you simply drag out another DBTableView and add the appropriate attributes--in other words, you configure the second master-detail pair just as you configured the first.</font>

<p><font face="Times">Looking at the example, the destination of the</font> <font face="Helvetica">Employees.toCustomers</font> <font face="Times">relationship contains a to-many relationship named </font><font face="Helvetica">toOrders</font><font face="Times">.&nbsp; Put naturally, the relationship means that each customer can have more than one order at a time.</font>

<p><font face="Times">By associating attributes from the destination of the</font> <font face="Helvetica">Employees.toCustomers.toOrders</font> <font face="Times">relationship with the columns of a third DBTableView, you create a nested master-detail interface.&nbsp; Just as the selection in the Employees table determines the contents of the Customers table, the selection in the Customers table determines the contents of the Orders table.&nbsp; The interface, filled with data, is shown in Figure 59.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=107></td>

<td><img src="F28.gif" width=606 height=367></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Helvetica"><b>Figure 59</b></font><font face="Times">.&nbsp; Nested Master-Detail Tables</font>

<p><br><br><br>

<p><font face="Helvetica" size="+1"><b>Controlling a DBModule</b></font>

<p><font face="Times">As demonstrated in the examples above, a DBModule object can be set as the target of a Control object.&nbsp; The action methods that the DBModule class offers in its role as a target fall into two groups, data control and record control:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Data control methods synchronize the data that's displayed in the interface with the data that's stored in the database server.</font></td></tr>

<tr valign=top>

<td width=105 height=12></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Record control methods act on individual records.&nbsp; For example, there are methods for selecting, adding, and deleting records.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Helvetica"><b>Note:</b></font>&nbsp; <font face="Times">There's yet another action method, <b>takeValueFrom:</b>, that doesn't fit into either of these categories.&nbsp; This is a special method that helps coordinate value synchronization between interface objects and is described in a later section.</font>

<p><font face="Times">The action methods are listed by group and described in sections below.&nbsp; But before you can appreciate how these methods works, you first must understand something of the scope of their activity, as explained in the next section.</font>

<p><br><br><br>

<p><font face="Helvetica"><b>Fetch Groups</b></font>

<p><font face="Times">A DBModule organizes the attributes for which it fetches data into <i>fetch groups</i>, such that all the attributes within a particular fetch group are joined to the same entity.&nbsp; Put another way, the model paths that locate a fetch group's attributes can't traverse to-many relationships.</font>

<p><font face="Times">Referring to the nested master-detail example described above, we see that there must be three fetch groups, one for each table of displayed data.&nbsp; Figure 60 shows the model for the master-detail example with the fetch groups outlined and (arbitrarily) labeled.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=107></td>

<td><img src="F7.gif" width=224 height=259></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Helvetica"><b>Figure 60</b></font><font face="Times">.&nbsp; Fetch Groups for a Master-Detail Interface</font>

<p><br><br>

<p><font face="Times">The fetch group that contains the root entity--&quot;Fetch Group A&quot; in the illustration--is special; it's called the <i>root fetch group</i>. It's special in that the DBModule action methods are directed to it.</font>

<p><font face="Times">The other two fetch groups are called <i>sub-fetch groups</i>.&nbsp; They receive action messages only if the root fetch group forwards them.&nbsp; And the root fetch group only forwards data control messages, not record control messages.&nbsp; The scope of DBModule's action methods can be summarized as shown in the table below:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=124></td>

<td nowrap><font face="Helvetica"><b>Method Group</b></font></td>

<td><font face="Helvetica"><b>Scope</b></font></td></tr>

<tr valign=top>

<td width=124 height=4></td></tr>

<tr valign=top>

<td width=124></td>

<td nowrap><font face="Times">data control</font></td>

<td><font face="Times">root and sub-fetch groups</font></td></tr>

<tr valign=top>

<td width=124></td>

<td nowrap><font face="Times">record control</font></td>

<td><font face="Times">root fetch group only</font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Helvetica"><b>Data Control Methods</b></font>

<p><font face="Times">The data control methods synchronize the data that's displayed in the interface with the data that's stored in the database server:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times"><b>fetchAllRecords:</b> fetches data from the server and displays it in the interface.</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times"><b>saveChanges:</b> writes modified records back to the server.</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times"><b>discardChanges:</b> throws away changes since the previous <b>saveChanges:</b> message.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">Because data control messages are forwarded by the root fetch group, all fetch groups owned by a particular DBModule are affected by them.&nbsp; This was demonstrated in the master-detail examples:&nbsp; The Fetch button fetched data not only for the root fetch group (as displayed in the Employees DBTableView), but also for the other fetch groups (as displayed in the Customers and Orders tables).</font>

<p><br><br><br>

<p><font face="Helvetica"><b>Record Control Methods</b></font>

<p><font face="Times">The record control methods act on individual records in the root fetch group (only):</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times"><b>appendNewRecord:</b> adds a new record to the end of the list of records.</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times"><b>insertNewRecord:</b> adds a new record just after the currently selected record.</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times"><b>deleteRecord:</b> removes the currently selected record.</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times"><b>nextRecord:</b> bumps the current selection cursor to the next record.</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times"><b>previousRecord:</b> moves the selection cursor back a record.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">The record-adding and -deleting methods are useful and necessary.&nbsp; The record-selection methods are less so:&nbsp; If the user is given a DBTableView, the selection can be made directly (by clicking in the table with the mouse), and so the selection methods aren't needed.&nbsp; The record-selection methods are important if you're a using standard interface object, such as TextField.&nbsp; However, it should be noted that completely forgoing DBTableView objects in deference to the standard interface objects is strongly discouraged.</font>

<p><font face="Times">That the record control methods only affect the root fetch group raises an obvious question:&nbsp; How does one create an interface in which records can be added to and deleted from a sub-fetch group?&nbsp; The simple answer is this:&nbsp; You assign a separate DBModule to each fetch group.&nbsp; This technique is described in the following section.</font>

<p><br><br><br>

<p><font face="Helvetica" size="+1"><b>Multiple DBModules</b></font>

<p><font face="Times">Most database applications will need to use more than one DBModule.&nbsp; This need is felt in two cases:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">The DBModule control methods, as described above, only affect the root fetch group.&nbsp; To adequately control a sub-fetch group, you need a DBModule that will &quot;adopt&quot; it as its own root fetch group.&nbsp; An example of this is given below.</font></td></tr>

<tr valign=top>

<td width=105 height=12></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">A single DBModule can't span models:&nbsp; You need (at least) one DBModule for each model that you use.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">The latter case is much less common than the former.&nbsp; It's anticipated that most applications will use a single model.&nbsp; This places the burden of sufficient architectural representation on the model design, but, after all, that's what model building is all about.&nbsp; In any case, the mechanics of creating a multiple-DBModule interface to support multiple models is straightforward: You simply repeat the processes described above.</font>

<p><br><br><br>

<p><font face="Helvetica"><b>Connecting DBModules:&nbsp; A Better Master-Detail</b></font>

<p><font face="Times">Returning to the master-detail examples described in the section &quot;Creating a Master-Detail Interface,&quot; you'll notice that the only control that's added to the interface is a button that fetches data.&nbsp; The action method to which the button is connected, <b>fetchAllRecords:</b>, is a data control method, thus it affects all the fetch groups that belong to the DBModule. If a record control method--<b>appendNewRecord:</b>, for example--is connected to a button in the interface, the action would only affect the table that's displaying root fetch group data; in other words, it would affect the master table, but nothing else.</font>

<p><font face="Times">So how do you add records to a detail table?&nbsp; By creating a second DBModule whose root entity is the basis of the detail table, and connecting this second DBModule to the first.&nbsp; The following sections examine this process, step-by-step.</font>

<p><br><br>

<p><font face="Helvetica"><b>Step 1:&nbsp; Configure the Interface</b></font>

<p><font face="Times">First, we'll create the interface.&nbsp;&nbsp; Figure 61 shows the two DBTableViews, labeled &quot;Master&quot; and &quot;Detail&quot; for clarity, and three buttons, which are also descriptively titled.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=107></td>

<td><img src="F29.gif" width=564 height=203></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Helvetica"><b>Figure 61</b></font><font face="Times">.&nbsp; Master-Detail Interface</font>

<p><br><br>

<p><font face="Helvetica"><b>Step 2:&nbsp; Configure the Master Table</b></font>

<p><font face="Times">Configuring the Master table is done in the expected manner:&nbsp; A DBModule object is instantiated, a model and root entity are selected, and attributes from the root entity (or through to-one relationships) are dropped into Master's columns.</font>

<p><font face="Times">Figure 62 shows a Model browser (for a DBModule named &quot;MasterModel&quot;) and the associations between attributes and columns.&nbsp; In it, we see that MasterModel's root entity is</font> <font face="Helvetica">Employee</font> <font face="Times">(from the &quot;OracleDemo&quot; model), and the Master table displays data for the</font> <font face="Helvetica">Employee.name</font> <font face="Times">and</font> <font face="Helvetica">Employee.toDepartment.deptNo</font> <font face="Times">attributes.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=107></td>

<td><img src="F30.gif" width=565 height=515></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Helvetica"><b>Figure 62</b></font><font face="Times">.&nbsp; Master Table Configuration</font>

<p><br><br>

<p><font face="Helvetica"><b>Step 3:&nbsp; Associate the Master DBModule with the Detail DBModule</b></font>

<p><font face="Times">Next, you drag out a second DBModule (it's named &quot;DetailModel&quot; in the illustration below) and associate it with the first DBModule.&nbsp; To form this association, you drag a relationship icon out of the MasterModel model browser and drop it onto the DetailModel's object icon, as shown in Figure 63 and Figure 64.</font>

<p><br><br>

<p><img src="F31.gif" width=673 height=414>

<p><font face="Helvetica"><b>Figure 63</b></font><font face="Times">.&nbsp; Drag a Relationship From the Master Model Browser...</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=107></td>

<td><img src="F32.gif" width=673 height=414></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Helvetica"><b>Figure 64</b></font><font face="Times">.&nbsp; ...and Drop It into the DetailModel Icon</font>

<p><br><br>

<p><font face="Times">Associating two DBModules in this manner implicitly sets the target DBModule's root entity to be the destination entity of the selected relationship.&nbsp; Thus, in the example, DetailModel's root entity is set to</font> <font face="Helvetica">Customer</font><font face="Times">.</font>

<p><br><br>

<p><font face="Helvetica"><b>Step 4:&nbsp; Configure the Detail Table</b></font>

<p><font face="Times">Now you can select attributes from DetailModel's model browser and drop them into the Detail table.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=34></td>

<td nowrap><font face="Helvetica"><b>Warning:</b></font></td>

<td><font face="Times">You should note that even though you implicitly declared the root entity for the DetailModel by dragging the</font> <font face="Helvetica">toCustomers </font><font face="Times">relationship into the object's icon, the assignment isn't reflected in DetailModel's Model browser--the</font> <font face="Helvetica">Customer</font> <font face="Times">entity isn't &quot;locked&quot; until you actually select an attribute from the entity and drop it in an interface object.</font></td></tr>

<tr valign=top>

<td width=34 height=25></td></tr>

<tr valign=top>

<td width=34></td>

<td nowrap></td>

<td><font face="Helvetica"><b>Step 5:&nbsp; Connect the Controls</b></font></td></tr>

<tr valign=top>

<td width=34 height=13></td></tr>

<tr valign=top>

<td width=34></td>

<td nowrap></td>

<td><font face="Times">By connecting the three buttons to the appropriate action methods you complete the interface:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">The Fetch Everything button is connected to MasterModel's <b>fetchAllRecords:</b> method.</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Add Master Record is connected to MasterModel's <b>appendRecord:</b>.</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Add Detail Record is connected to DetailModel's <b>appendRecord:</b>.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">When you click the Fetch Everything button, records for both tables are fetched.&nbsp; The two record-adding buttons work only for their respective tables.</font>

<p><br><br><br>

<p><font face="Helvetica" size="+1"><b>Using a DBImageView</b></font>

<p><font face="Times">Connecting an attribute to a DBImageView object is much like the process described above:&nbsp; You find an attribute in the model browser, drag it out, and drop it over the DBImageView object in your interface.&nbsp; However, the <i>only</i> attributes that a DBImageView accepts are those that represent NXImage objects.&nbsp; The icon for NXImage objects, as displayed in the model browser, is shown below:</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=107></td>

<td><img src="F12.gif" width=47 height=47></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Helvetica"><b>Figure 65</b></font><font face="Times">.&nbsp; The NXImage Icon</font>

<p><br><br><br>

<p><font face="Helvetica" size="+1"><b>Using the Standard Interface Objects</b></font>

<p><font face="Times">In addition to the objects defined in its palette, the Database Kit knows how to display data in most of the standard interface objects, objects such as TextField and NXBrowser.&nbsp; The following sections described the considerations that the standard objects add to a database application interface.</font>

<p><br><br><br>

<p><font face="Helvetica"><b>Incorporating a Standard Object</b></font>

<p><font face="Times">The process through which a standard object is connected to a DBModule is the same as with the palette objects:&nbsp; You open a model browser, drag out an attribute, and drop it in the interface object.&nbsp; Figure 66 shows the</font> <font face="Helvetica">Employee.name</font> <font face="Times">attribute being dragged into a Form object.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=107></td>

<td><img src="F34.gif" width=493 height=397></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Helvetica"><b>Figure 66</b></font><font face="Times">.&nbsp; Dragging into a Form Object</font>

<p><br><br>

<p><font face="Times">Although you can create an entire interface with the standard objects, this practice is strongly discouraged.&nbsp; In general, the standard objects should be used in conjunction with a DBTableView, where the DBTableView provides a browser on the data, and the standard objects display values for the current selection.&nbsp; Figure 67 gives an example of a DBTableView and a Form object that work together.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=107></td>

<td><img src="F35.gif" width=198 height=259></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Helvetica"><b>Figure 67</b></font><font face="Times">.&nbsp; A DBTableView and a Form</font>

<p><br><br>

<p><font face="Times">The attributes that are associated with the columns in the DBTableView and the cells in the Form object are from the same fetch group (they're all attributes of the</font> <font face="Helvetica">Employee</font> <font face="Times">entity).&nbsp; As the user selects records in the DBTableView, the data for that record is displayed in the Form's cells.</font>

<p><font face="Times">How does the Form know what to display?&nbsp; In other words, how does it know when the selected record changes?&nbsp; It just does; the act of creating the associations between attributes from the same fetch group and interface objects is enough to &quot;link&quot; the objects so they all display the appropriate data.</font>

<p><br><br><br>

<p><font face="Helvetica"><b>Getting Data Out of a Standard Object</b></font>

<p><font face="Times">Let's modify the previous example a bit:&nbsp; The DBTableView, as shown in Figure 68 is extended to display all four attributes. Now, the two interface objects will share the</font> <font face="Helvetica">commission</font> <font face="Times">and</font> <font face="Helvetica">salary</font> <font face="Times">attributes.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=107></td>

<td><img src="F36.gif" width=291 height=259></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Helvetica"><b>Figure 68</b></font><font face="Times">.&nbsp; A DBTableView and a Form; Part 2</font>

<p><br><br>

<p><font face="Times">Assume that the DBTableView is designated as read-only, while the values in the Form can be changed.&nbsp; In other words, this interface lets the user change the commission and salary values for a selected employee record.</font>

<p><font face="Times">After a fetch, the data in the DBTableView and in the Form is in synch; the <b>commission</b> and <b>salary</b> columns in the DBTableView show the same respective values as in the Form.&nbsp; To maintain this synchronization when the user alters a Form value, we'll want the new data to be &quot;sent back&quot; to the DBTableView.&nbsp; This resynchronization isn't automatic, however:&nbsp; To link the data in a standard interface object back to a DBTableView, the standard object must send a <b>takeValueFrom:</b> message to the DBModule.&nbsp; The connection for the example is illustrated in Figure 69.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=107></td>

<td><img src="F17.gif" width=645 height=442></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Helvetica"><b>Figure 69</b></font><font face="Times">.&nbsp; The <b>takeValueFrom:</b> Connection</font>

<p><br><br>

<p><font face="Times">Thus connected, the user can enter a new value in the Form and, after the object accepts the value, the DBTableView will display the new data.&nbsp; Figure 70 shows the interface just after the user has entered a new salary value for ALLEN, and just after the value is validated (after the user presses the return or tab key).</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=107></td>

<td><img src="F38.gif" width=295 height=259></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Helvetica"><b>Figure 70</b></font><font face="Times">.&nbsp; Entering and Confirming a New Value</font>

<p><br><br>

<p><font face="Helvetica"><b>Scope</b></font>

<p><font face="Times">When the DBModule receives the <b>takeValueFrom:</b> method, it figures out which attribute the sender is associated with, looks for other objects that are also associated with that attribute, and sends the located objects messages that cause them to update their values.&nbsp; Thus, there's never any confusion over which object gets updated--the correspondence is determined, by the DBModule, through identical attribute associations.</font>

<p><font face="Times">However, as defined earlier, two attributes are identical only if their model paths are the same, including the model and DBModule portions of the path.&nbsp; This means that the scope of a <b>takeValueFrom:</b> message is restricted to DBModule boundaries.</font>

<p><br><br>

<p><font face="Helvetica"><b>Controls</b></font>

<p><font face="Times">It was taken for granted, in the example above, that the Form object could be connected to the DBModule and so invoke the <b>takeValueFrom:</b> method.&nbsp; Of course, this is possible only because Form is a subclass of Control--only Controls can invoke action methods.&nbsp; You should find that most of the standard interface objects that &quot;fit&quot; with your database application interface are Controls; if you use an object that isn't a Control, then you might be able to display data with it, but you won't be able to resynchronize its values with those displayed.</font></td></tr>

</table>



<p>

</body>
</html>
