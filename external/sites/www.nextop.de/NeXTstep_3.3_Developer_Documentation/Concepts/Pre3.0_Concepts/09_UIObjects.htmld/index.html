<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<!-- Created with LatinByrd III -->
<!-- File: /Apps/NextDev/Concepts/Pre3.0_Concepts/09_UIObjects.rtfd -->
<!-- Date: Sun Jun 28 19:38:01 1998 -->
<head>
<title>09_UIObjects</title>
</head>

<body bgcolor="#FFFFFF" text="#000000" link="#0000FF" alink="#FF00FF" vlink="#FF0000">

<basefont size=3>

<p><font face="Times" size="-1">Release 3.3 Copyright</font> <font size="-1">&copy;</font><font face="Times" size="-1">1995 by NeXT Computer, Inc.&nbsp; All Rights Reserved.</font>

<p><br><br><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=36></td>

<td nowrap><font face="Helvetica" size="+3"><b>9</b></font></td>

<td><font face="Times" size="+3"><i>User-Interface Objects</i></font></td></tr>

</table>

<p><br><br><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times"><b>This information, although fundamentally correct, has not been updated for release 3.0.&nbsp; For up-to-date information on the Text and Box classes, see the documentation in:</b></font>

<p><img src="../../Images/sp.gif" width=19 height=1><font face="Times"><b>/NextLibrary/Documentation/NextDev/GeneralRef/02_ApplicationKit/Classes</b></font><br>
<font face="Times">_____________________________________________</font>

<p><br><br><br>

<p><font face="Times">The Application Kit consists mainly of class definitions for objects that respond to events or draw on the screen. Chapter 6, &quot;Program Structure,&quot; and Chapter 7, &quot;Program Dynamics,&quot; showed how these objects work together to ground your application in the NeXT window system and give it a unified program structure.&nbsp; Chapter 8, &quot;Interface Builder,&quot; showed how to build a program from these objects graphically, writing only minimal amounts of Objective-C code.</font>

<p><font face="Times">This chapter discusses each of these objects in more detail, from the standpoint of the Application Kit, not Interface Builder.&nbsp; This information will be useful if you want to gain a full understanding of how these objects work, if you plan to define a subclass of any of them to change default behavior, or if you simply want to know the range of possibilities allowed by their kit definitions.</font>

<p><font face="Times">All user-interface objects are Responders, and most are also Views of one sort or another.&nbsp; They fall roughly into five categories:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">The Application object that oversees the entire program.&nbsp; You'd generally customize this object to meet the needs of your program by defining an Application subclass.</font></td></tr>

<tr valign=top>

<td width=105 height=10></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Control objects, Views that implement the target-action paradigm and give users a way to control the program's activity.</font></td></tr>

<tr valign=top>

<td width=105 height=10></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Window objects that manage the windows provided by the Window Server and the Views that are displayed within them.</font></td></tr>

<tr valign=top>

<td width=105 height=10></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">The Text object, which gives programs a way to display text to users and users a way to enter, edit, and select text.</font></td></tr>

<tr valign=top>

<td width=105 height=10></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Views that are generally used in conjunction with other Views, either to provide scrolling and zooming support, or to provide a background and frame to a companion View.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">For the most part, these are objects that you can use &quot;off the shelf.&quot;&nbsp; You get an object that's ready to use just by creating and initializing an instance of a Kit class; you don't have to define your own subclass.</font></td></tr>

</table>

<p><br><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+2"><b>The Text Class</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">The Text class is a subclass of View designed for the display and manipulation of text.&nbsp; An object of the Text class can:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Display text in various fonts.</font></td></tr>

<tr valign=top>

<td width=105 height=10></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Control the format of lines and paragraphs.</font></td></tr>

<tr valign=top>

<td width=105 height=10></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Wrap lines within the boundaries you set.</font></td></tr>

<tr valign=top>

<td width=105 height=10></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Specify displayed text as either read-only or editable.</font></td></tr>

<tr valign=top>

<td width=105 height=10></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Let the user cut, copy, and paste text between windows in the same or different applications.</font></td></tr>

<tr valign=top>

<td width=105 height=10></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Write text to, or retrieve it from, the disk.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">A Text object can be used to implement notepads, static text displays, and electronic forms, to name a few possibilities.</font>

<p><font face="Times">Many applications will include a Text object only indirectly, through the use of a TextField or Form object.&nbsp; TextField and Form objects provide a simplified interface to the Text object.&nbsp; They initialize the Text object for you and convert its contents to the format you request:&nbsp; an integer, floating-point, or string value.&nbsp; Since it belongs to a subclass of Control, a TextField or Form object also lets you set an action message and a target.&nbsp; Furthermore, all TextField and Form objects in the same window share a single Text object, thus reducing the memory demands of your application.</font>

<p><font face="Times">TextField and Form give you access to a small but frequently used subset of the methods that the Text class implements.&nbsp; If the text-handling features provided by these Controls don't meet your needs, use a Text object directly. Because the Text class has a rich selection of features, you'll rarely need to create a Text subclass of your own.</font>

<p><br><br><br>

<p><font face="Helvetica" size="+1"><b>Operation</b></font>

<p><font face="Times">This section gives a general overview of how a Text object works.&nbsp; Keep in mind that through its many methods, a Text object's standard behavior can be altered in fundamental ways.</font>

<p><font face="Times">A Text object is a View specifically designed for text display and editing.&nbsp; It draws in a flipped coordinate system; that is, the origin is located at the bounds rectangle's upper left corner.&nbsp; x-axis values increase from left to right and y-axis values increase from top to bottom.&nbsp; Thus, x values increase for each new character on a line, and y values increase for each new line.&nbsp; See Chapter 6 for general information on View coordinate systems.</font>

<p><font face="Times">Being a View, a Text object renders on the screen only the drawing that lies within its frame rectangle.&nbsp; However, the drawing of characters is confined to a generally smaller area, the <i>body rectangle</i>.&nbsp; This rectangle is inset from the edges of the frame rectangle by the width of the Text object's margins, as shown in Figure 9-1.&nbsp; Between the body rectangle and the frame rectangle, a Text object draws only its background color.&nbsp; Within the body rectangle, characters are drawn in horizontal lines that stretch from the left to the right margin.&nbsp; The height of each line is calculated to accommodate the tallest character in the line.</font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><img src="F0.gif" width=452 height=317></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica"><b>Figure 9-1</b></font><font face="Times">.&nbsp; Text Layout</font>

<p><br><br>

<p><font face="Times">A Text object views its contents as a string of characters.&nbsp; Individual characters are identified by their <i>character position</i>, their numerical rank in the string starting from 0.&nbsp; For example, if in your application you need to select a group of characters programmatically, you must specify their starting and ending positions.</font>

<p><font face="Times">As a Text object draws a line of text, it continually recalculates the accumulated width of all the characters drawn so far on that line.&nbsp; This calculation takes into account the width of each character in the line (given its font) as well as the width of any tabs or paragraph indentations.&nbsp; If the total width exceeds that available between the left and right margins, a portion of the text is wrapped onto the next line.&nbsp; Lines of text are generally wrapped on a word basis.</font>

<p><font face="Times">By default, the text a Text object displays can be edited by the user.&nbsp; However, there are two mechanisms you can use to protect the text from alteration.&nbsp; One lets you specify that the text is read-only, and the other lets another object within your program decide dynamically when the text can be edited and when it can't.&nbsp; This object is the Text object's delegate.</font>

<p><font face="Times">Besides determining whether the text can be edited, a Text object's delegate can control whether the Text object can resize its frame rectangle in response to the addition or deletion of text and whether it can accept or resign the status of first responder.&nbsp; After allowing any of these changes, the delegate is notified of the Text object's new state.</font>

<p><font face="Times">If its text is editable and the Text object becomes its window's first responder, it receives key events.&nbsp; As key events arrive in the Text object, a <i>character filter function</i> examines each character to determine the appropriate action.&nbsp; It passes some characters into the text and interprets others as a signal that the user is finished entering text.&nbsp; By default, Tab and Return characters are accepted into the text, although you can easily configure a Text object to interpret them as a signal to end the editing session.</font>

<p><font face="Times">You can also specify that incoming text, whether from the keyboard, the pasteboard, or a file, is passed to a <i>text filter function</i>.&nbsp; This filter is similar to the character filter but more versatile since it's passed more information about the state of the text, the insertion point, and the Text object.&nbsp; By using this added information, a text filter can implement auto-indentation or other automatic formatting features.</font>

<p><font face="Times">The sections that follow describe these concepts in more detail.</font>

<p><br><br><br>

<p><font face="Helvetica" size="+1"><b>Creating a Text Object</b></font>

<p><font face="Times">You create a Text object by sending a <b>newFrame:text:alignment:</b> message to the Text class:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">myText =[Text newFrame:&amp;aRect text:&#34;Brevity is the soul of wit.&#34;</font><br>
<img src="../../Images/sp.gif" width=236 height=1><font face="Courier" size="-1">alignment:NX_LEFTALIGNED];</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">The Text class responds by creating a Text object.&nbsp; The object's frame rectangle, text, and text alignment are set by the method's three arguments:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=124></td>

<td nowrap><font face="Helvetica"><b>Argument</b></font></td>

<td><font face="Helvetica"><b>Permitted Value</b></font></td></tr>

<tr valign=top>

<td width=124></td>

<td nowrap><font face="Times">frame</font></td>

<td><font face="Times">A pointer to an NXRect structure.&nbsp; This structure specifies the frame's size and the location of its lower left corner within the coordinate system of the Text object's superview.</font></td></tr>

<tr valign=top>

<td width=124 height=10></td></tr>

<tr valign=top>

<td width=124></td>

<td nowrap><font face="Times">text</font></td>

<td><font face="Times">A pointer to a null-terminated array of characters.&nbsp; These characters appear when the Text object is displayed.</font></td></tr>

<tr valign=top>

<td width=124 height=10></td></tr>

<tr valign=top>

<td width=124></td>

<td nowrap><font face="Times">alignment</font></td>

<td><font face="Times">A constant specifying the alignment of the text.&nbsp; Text can be aligned with the left or right margin or each line can be centered between the left and right margins.&nbsp; The choices are:</font></td></tr>

<tr valign=top>

<td width=124 height=34></td></tr>

<tr valign=top>

<td width=124></td>

<td nowrap></td>

<td><font face="Times">NX_LEFTALIGNED</font></td></tr>

<tr valign=top>

<td width=124 height=17></td></tr>

<tr valign=top>

<td width=124></td>

<td nowrap></td>

<td><font face="Times">NX_RIGHTALIGNED</font></td></tr>

<tr valign=top>

<td width=124 height=17></td></tr>

<tr valign=top>

<td width=124></td>

<td nowrap></td>

<td><font face="Times">NX_CENTERED</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">You can also create Text objects by sending <b>new</b> or <b>newFrame:</b> messages:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">myText1 = [Text new];</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">myText2 = [Text newFrame:&amp;aRect];</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">The <b>new</b> method sends a message to the Text class to apply the <b>newFrame:text:alignment:</b> method.&nbsp; The arguments it sends are a frame rectangle of 0, a null character pointer, and left text alignment.&nbsp; You could then send <b>sizeTo::</b> and <b>setText:</b> messages to the Text object that's created to set its size and text.&nbsp; (These instance methods are discussed in more detail in the following sections.)</font>

<p><font face="Times">The <b>newFrame:</b> method is similar to the <b>new</b> method except that it lets you specify the size and location of the Text object's frame rectangle.</font>

<p><font face="Times">The Text object you create will use the default system font.&nbsp; By sending the appropriate message to the Text class, you can specify a different default:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">[Text setDefaultFont:anObject];</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">myText = [Text newFrame:&amp;aRect];</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">If you use the <b>setDefaultFont:</b> method, be sure that the y-axis of the specified font has the same orientation as that of the Text object.&nbsp; Since the Text object flips the orientation of its y-axis, the font must also have a flipped y-axis to prevent characters from being drawn upside-down:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">[Text setDefaultFont: [Font newFont:&#34;Times-Roman&#34; size:12.0 style:0</font><br>
<img src="../../Images/sp.gif" width=292 height=1><font face="Courier" size="-1">matrix:NX_FLIPPEDMATRIX]];</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">myText = [Text newFrame:&amp;aRect];</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">If you use NULL as the argument to <b>setDefaultFont:</b>, the Text object will use the default system font, as defined by the defaults system.</font>

<p><br><br><br>

<p><font face="Helvetica" size="+1"><b>The Text</b></font>

<p><font face="Times">A Text object provides methods that let you control the form and content of the text.&nbsp; Other methods let you specify whether the user can add, alter, or delete a Text object's text.&nbsp; This section discusses how you can specify what text a Text object displays; the section &quot;Text Editing&quot; discusses the subjects of read-only and editable text.</font>

<p><br><br>

<p><font face="Helvetica" size="+1"><b>Setting the Text</b></font>

<p><font face="Times">The text the Text object displays can be set in a number of ways.&nbsp; It can be:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Set at the time the object is created</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Set by a message from another object in the application</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Read into the Text object from a file</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Entered by the user</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">The previous section, &quot;Creating a Text Object,&quot; gives an example of setting a Text object's text at the time the object is created.&nbsp; After a Text object has been created, another object in the application can reset the text by sending a <b>setText:</b> message:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">[myText setText:&#34;O, for a horse with wings!&#34;];</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">The argument is a pointer to the array of characters that will appear in the Text object.&nbsp; Any text the Text object previously contained will be replaced by this string.&nbsp; To append text to the contents of a Text object, you have to manipulate the selection, as described in the section &quot;The Selection&quot; below.</font>

<p><font face="Times">You can also set the Text object's text by applying the <b>readText:</b> or <b>readRichText:</b> method.&nbsp; These methods set the text to the contents of the stream you specify.&nbsp; The stream can represent a Mach port, a portion of memory, or, as in this example, a file.</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">NXStream&nbsp; *input;</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">char&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *theFile = &#34;Sonnets&#34;;</font>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">input = NXMapFile(theFile, NX_READONLY);</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">[textOutlet readText:input];</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">NXCloseMemory(input, NX_FREEBUFFER);</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">return self;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">As before, the Text object's previous text is replaced by the new text.</font>

<p><font face="Times"><b>readText:</b> interprets the data in the stream as plain ASCII text.&nbsp; The text is displayed using the Text object's default font and layout characteristics.</font>

<p><font face="Times">A similar method, <b>readRichText:</b>, is designed to read text encoded in Rich Text Format</font><font size="-2"><sup>&reg;</sup></font><font face="Times">, or RTF, a format for storing text and graphics.&nbsp; (For more information on RTF, see the <i>Rich Text Format Specification</i> by Microsoft Corporation.) The Text object uses the font and layout information embedded in the RTF file as a guideline for displaying the text.&nbsp; If a Text object doesn't support a specific RTF formatting instruction, it simply ignores it; no error occurs.&nbsp; See the &quot;Rich Text Format Support&quot; section below for a table of supported RTF control words.</font>

<p><font face="Times">Finally, the user can set the text in the Text object.&nbsp; See &quot;Text Editing&quot; below for more information.</font>

<p><br><br>

<p><font face="Helvetica" size="+1"><b>Examining the Text</b></font>

<p><font face="Times">Your application can get a copy of all or part of the Text object's text by sending a <b>getSubstring:start:length: </b>message.&nbsp; This method takes three arguments:&nbsp; a pointer to a character array, the starting position of the substring, and the total number of characters to copy into the array.&nbsp; Substring positions are relative to the first character of the text, which is taken to be at position 0.</font>

<p><font face="Times">If you want to copy the Text object's entire text, pick a value for <b>length</b> that equals or exceeds the actual text length. No error results if <b>start</b> plus <b>length</b> specifies a character position beyond the end of the text.&nbsp; For example, to copy the entire contents of <b>myText</b>, first use the <b>textLength</b> method to determine the text's length.&nbsp; Then, send a <b>getSubstring:start:length:</b> message with that value:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">char&nbsp; *textBuffer;</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">int&nbsp;&nbsp;&nbsp; textLength;</font>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">textBuffer = malloc([text textLength]+1);</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">[text getSubstring:textBuffer start:0 length:[text textLength]];</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">If the string you request encompasses the entire text, the Text object appends a null terminator ('\0') to the string.&nbsp; As the example illustrates, you should allow for the null terminator when you allocate storage for the string.&nbsp; If you only want a portion of the entire text, you'll have to add the null terminator yourself.&nbsp; This code fragment copies a null-terminated string containing the first 100 characters of <b>myText</b>:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">char&nbsp; textBuffer[101];</font>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">[myText getSubstring:textBuffer start:0 length:100];</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">textBuffer[100] = '\0';</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times"><b>getSubstring:start:length:</b> returns an integer indicating the actual number of characters copied.&nbsp; The total doesn't include the null terminator that <b>getSubstring:start:length:</b> adds if the requested string includes the entire text.&nbsp; A returned value of</font> <img src="../../Images/c2D.gif" width=8 height=4><font face="Times">1 indicates that the starting position is beyond the end of the text.</font>

<p><br><br>

<p><font face="Helvetica" size="+1"><b>Writing the Text to a File</b></font>

<p><font face="Times">A Text object can write its text out in either ASCII or RTF format.&nbsp; ASCII format retains only minimal information about the original text.&nbsp; It records the text's characters but no information about fonts, sizes, paragraph indentation, or tab settings.&nbsp; In contrast, Rich Text Format encodes enough information to ensure that the text could be restored to its original specifications.&nbsp; The Text class currently supports only a subset of the formatting commands defined in the RTF specification.&nbsp; See the &quot;Rich Text Format Support&quot; section below for a table of supported RTF control words.</font>

<p><font face="Helvetica"><b>Note:</b></font>&nbsp; <font face="Times">A Text object writes to a stream rather than to a file.&nbsp; (See the &quot;Application Kit Conventions&quot; section of Chapter 6 for information on streams.)&nbsp; The examples that follow assume you want to store the data from the stream into a file.</font>

<p><font face="Times">To write an ASCII version of a Text object's text to a file, use the <b>writeText:</b> method:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fd;</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">NXStream&nbsp; *stream;</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">char&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *theFile = &#34;Sonnets&#34;;</font>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">fd = open(theFile, O_CREAT | O_WRONLY | O_TRUNC, 0666);</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">stream = NXOpenFile(fd, NX_WRITEONLY);</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">[myText writeText:stream];</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">NXFlush(stream);</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">NXClose(stream);</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">close(fd);</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">To write only a portion of the text, use <b>getSubstring:start:length:</b> to get a copy of the text and then <b>NXWrite()</b> to write the string to the stream:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fd;</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">NXStream&nbsp; *stream;</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">char&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *theFile = &#34;Snippet&#34;;</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">char&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; textBuffer[11];</font>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">fd = open(theFile, O_CREAT | O_WRONLY | O_TRUNC, 0666);</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">stream = NXOpenFile(fd, NX_WRITEONLY);</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">[textOutlet getSubstring:textBuffer start:0 length:10];</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">textBuffer[10] = '\0';</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">NXWrite(stream, textBuffer, 10);</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">NXFlush(stream);</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">NXClose(stream);</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">close(fd);</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">return self;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">See &quot;The Selection&quot; below for information on writing only the selected text to the disk.</font>

<p><br><br>

<p><font face="Helvetica" size="+1"><b>Text Layout</b></font>

<p><font face="Times">The format of a Text object's displayed text depends on a number of factors, including:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">The size of the Text object's frame rectangle</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">The dimensions of the four margins</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">The alignment of the text</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">The vertical placement of the characters within the line</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">The style of each paragraph</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica"><b>Frame Rectangle</b></font>

<p><font face="Times">As described in &quot;Creating a Text Object&quot; above, you can set the size and location of the frame rectangle when you create a new Text object.&nbsp; A Text object can also dynamically change the size of its frame rectangle in response to the addition or deletion of text.&nbsp; The simplest way to control resizing is with the <b>setVertResizable:</b> and <b>setHorizResizable:</b> methods.&nbsp; (You can also let the Text object's delegate control resizing; see &quot;The Delegate&quot; below.)&nbsp; These methods take a boolean value that determines the dimension, width or height, that the rectangle can alter.</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">[myText setVertResizable:YES];</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">[myText setHorizResizable:NO];</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">The <b>isVertResizable</b> and <b>isHorizResizable</b> methods report the resizing status of a Text object.</font>

<p><font face="Times">Assuming the Text object can be resized, the <b>setMaxSize:</b> and <b>setMinSize:</b> methods set limits to the extent of the change:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">NXSize maxSize = {100.0, 10000.0};</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">NXSize minSize = {100.0, 20.0};</font>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">[myText setMaxSize:&amp;maxSize];</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">[myText setMinSize:&amp;minSize];</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">This example allows a Text object's frame rectangle to grow to the specified maximum height as text is added or to shrink to the specified minimum size as text is deleted.&nbsp; Use the <b>getMaxSize:</b> and <b>getMinSize:</b> method to learn the current settings of these size limits.</font>

<p><font face="Times">If a Text object is resizable, sending a <b>sizeTo::</b> message will resize it within the constraints set by the four methods introduced above.&nbsp; Note that <b>sizeTo::</b> doesn't recalculate the placement of text within the newly resized frame rectangle.&nbsp; For this reason, you must send a <b>calcLine</b> message immediately after resizing a Text object.</font>

<p><font face="Times">A <b>sizeToFit</b> message resizes a Text object so that all of the text it contains is displayed.&nbsp; Again, this resizing is subject to the limits set by the four methods above.&nbsp; Use <b>calcLine</b> to rewrap the text after sending a <b>sizeToFit</b> message.</font>

<p><br><br>

<p><font face="Helvetica"><b>Margins</b></font>

<p><font face="Times">Text layout is also determined by the width of a Text object's margins.&nbsp; The margins determine the amount the body rectangle is inset from the sides of a Text object's frame rectangle.&nbsp; By default, the body rectangle's height is the same as that of the frame rectangle, but its width is 4.0 units (in the Text object's current coordinate system) narrower than the width of the frame rectangle.&nbsp; The body rectangle is centered between the left and right edges of the frame rectangle.</font>

<p><font face="Times">The <b>getMarginLeft:right:top:bottom:</b> method reports the current settings of the four margins.&nbsp; To alter these values, send a <b>setMarginLeft:right:top:bottom:</b> message.&nbsp; With this method, you can reset all four values at once.&nbsp; You might use both methods if you wanted to reset only one margin.&nbsp; For example, to reset the top margin to 6.0 while leaving the other margins at their current settings, you could send these messages:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">NXCoord&nbsp; lMgn, rMgn, tMgn, bMgn;</font>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">[myText getMarginLeft:&amp;lMgn right:&amp;rMgn top:&amp;tMgn bottom:&amp;bMgn];</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">[myText setMarginLeft:lMgn right:rMgn top:6.0 bottom:bMgn];</font>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica"><b>Alignment</b></font>

<p><font face="Times">Text alignment also affects the layout.&nbsp; By default, text is aligned with the left margin, which causes a block of text to have a &quot;ragged right&quot; edge.&nbsp; After a Text object is created, its text alignment can be queried by sending an <b>alignment </b>message and can be reset by sending a <b>setAlignment:</b> message.</font>

<p><font face="Times">The <b>setAlignment:</b> method uses the same constants (NX_LEFTALIGNED, NX_RIGHTALIGNED, and NX_CENTERED) as the <b>newFrame:text:alignment:</b> class method described in &quot;Creating a Text Object&quot; above.&nbsp; As the names of the constants suggest, text can be aligned to the left or right margin or centered between the left and right margins.</font>

<p><font face="Times">Sending a <b>setAlignment:</b> message doesn't redraw the text; you must redisplay the text to exhibit the change.&nbsp; For example:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">if ([myText alignment] != NX_CENTERED) {</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">[myText setAlignment:NX_CENTERED];</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">[myText display];</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">}</font>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica"><b>Line and Character Layout</b></font>

<p><font face="Times">Methods defined in the Text class let you adjust the vertical placement of characters within a line as well as the height of the line itself, giving you the ability to display single-spaced or double-spaced text, or any other spacing you choose. The default values for line height and character placement depend on the Text object's font, but are designed to give single-spaced text for the font that's currently in use.</font>

<p><font face="Times">In the context of the Text class, a line is a rectangular area that extends from the left to the right edge of the Text object's body rectangle and that contains a single row of characters.&nbsp; Each line within a paragraph shares a side with the preceding and the following line; thus setting the line spacing for a Text object is, in fact, a matter of setting the height of the lines.</font>

<p><font face="Times">Within a line, a Text object positions a character according to two measurements.&nbsp; It sums the widths of the preceding characters to determine the x-coordinate, and it sets the y-coordinate a certain distance above the bottom of the line's rectangular drawing area.&nbsp; Figure 9-2 illustrates character placement in a line of text.</font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><img src="F1.gif" width=366 height=169></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica"><b>Figure 9-2</b></font><font face="Times">.&nbsp; Line and Character Metrics</font>

<p><br><br>

<p><font face="Times">Characters within a font are horizontally aligned relative to a reference line called the <i>baseline.</i>&nbsp; You can think of characters such as &quot;x&quot; and &quot;h&quot; as standing on the baseline.&nbsp; For lowercase letters, the vertical extent of a letter is divided into three parts:&nbsp; the ascender, the descender, and a middle section.&nbsp; The middle section extends from the baseline to the top of an &quot;x&quot; character, a height known as the <i>x-height</i>.&nbsp; The portion of a character that extends above the x-height is called the <i>ascender</i>; the portion below is called the <i>descender</i>.&nbsp; The distance from the baseline to the bottom of the line's drawing area is called the <i>descent line</i>.</font>

<p><font face="Times">The Text class's <b>setLineHeight:</b> and <b>lineHeight</b> methods set and report a Text object's line height.&nbsp; To display double-spaced lines of text, you would reset the Text object's line height.&nbsp; Assuming the Text object's text is currently single-spaced, you could specify double-spaced text by sending these messages:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">[myText setLineHeight:2.0 * [myText lineHeight]];</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">To adjust the vertical placement of characters within a line, you can change the descent line.&nbsp; The Text object's <b>descentLine</b> and <b>setDescentLine:</b> report and set the descent line.&nbsp; For example, to double the current value of the descent line:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">[myText setDescentLine:2.0 * [myText descentLine]];</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">Although you might specify a line height or descent line value that would cause a character to extend outside of a line's rectangular drawing area, a Text object will override these values so that even the largest character on the line is fully visible.</font>

<p><br><br>

<p><font face="Helvetica" size="+1"><b>Word and Character Wrapping</b></font>

<p><font face="Times">A Text object continues to draw characters on a single line until adding another character would cause the total width of the characters to exceed the space between the line's right and left margins.&nbsp; What happens next depends on the previous characters on the line and the current state of the Text object:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">The new character, and the word it's part of, can appear on the next line:&nbsp; The text is <i>word-wrapped</i>.</font></td></tr>

<tr valign=top>

<td width=105 height=10></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">The new character alone can appear on the next line:&nbsp; The text is <i>character-wrapped</i>.</font></td></tr>

<tr valign=top>

<td width=105 height=10></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">The new character can be added to the Text object's text but not be drawn within the frame rectangle:&nbsp; The drawing of the new character, and any that follow it on the same line, is clipped by the Text object's body rectangle.</font></td></tr>

<tr valign=top>

<td width=105 height=10></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">The width of the Text object's frame rectangle can grow to accommodate the new character.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">A Text object's default behavior is to word-wrap lines of text.&nbsp; If adding text to a line would push some character on the line outside the body rectangle, the Text object takes the word this character is part of and redraws the entire word on the next line.&nbsp; Unlike a UNIX text editor such as Emacs, a Text object wraps the text without adding a new line character ('\n') at the end of each line.&nbsp; Wrapping affects only the display of the text, not its contents.&nbsp; Consequently, if you change the width of a Text object's body rectangle, the text it contains will be rewrapped to the new line length.</font>

<p><font face="Times">To determine word boundaries, a Text object refers to a <i>break table</i>.&nbsp; Although it's unlikely you'll ever need to change the standard break table, the Text class provides the <b>setBreakTable:</b> and <b>breakTable</b> methods to give you that option. See &quot;Text Tables and Filter Functions&quot; below for more information on the break table.</font>

<p><font face="Times">If the Text object can't find a word boundary on the current line (that is, a single &quot;word&quot; spans the body rectangle's width), it wraps new characters onto the next line.&nbsp; The <b>setCharWrap:</b> and <b>charWrap</b> methods let you control how a Text object treats such long words:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">if([myText charWrap] == YES)</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">[myText setCharWrap:NO];</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">After receiving a <b>setCharWrap:</b>NO message, a Text object's word wrap feature is still enabled, but the display of long words is clipped to the edge of the body rectangle.&nbsp; Although the clipped characters aren't visible, they're still part of the Text object's text.&nbsp; By deleting characters that precede them on the line, or by entering Return in the midst of the long word, the user can bring the clipped characters into view.</font>

<p><font face="Times">You can disable both word-wrapping and character-wrapping by sending a <b>setNoWrap</b> message:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">[myText setNoWrap];</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">After a Text object receives a <b>setNoWrap</b> message, a user can begin a new line only by entering Return.&nbsp; A Text object allows no more than 16,384 (or 2</font><font face="Times" size="-2">14</font><font face="Times">) characters on a single line.</font>

<p><font face="Times">If the Text object is resizable, it can grow to accommodate text that would exceed the width of the body rectangle.&nbsp; If the enlarged frame rectangle still falls within its superview's frame rectangle, the new text will be visible.&nbsp; See the &quot;Frame Rectangle&quot; section above and &quot;The Delegate,&quot; below, for more information.</font>

<p><br><br><br>

<p><font face="Helvetica" size="+1"><b>The Selection</b></font>

<p><font face="Times">The selection is the portion of the text that an action, such as a command, will affect.&nbsp; The selection can have 0 width (an <i>empty selection</i>), in which case it's indicated by a blinking vertical bar called the <i>caret</i>, or it can contain one or more characters.&nbsp; If the selection spans one or more characters, it's indicated by highlighting.&nbsp; A Text object automatically chooses the proper marking depending on the length of the selection.</font>

<p><font face="Times">Highlighting is only an attribute of the selection; it shouldn't be confused with the selection itself.&nbsp; By setting the selection's gray value to be equal to that of the background (see &quot;Drawing and the Text Class&quot; below), you can easily create a selection that doesn't display a visible highlight.</font>

<p><font face="Times">By default, a Text object's text is selectable.&nbsp; The <b>isSelectable</b> method reports whether the text is selectable, and the <b>setSelectable:</b> method lets you alter this status:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">if ([myText isSelectable] == YES)</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">[myText setSelectable:NO];</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">Only selectable text is editable; however, selectability doesn't necessarily imply editability.&nbsp; You can have selectable, read-only text.&nbsp; For example, you may want the user to select some text, say the answer to a multiple-choice question, but not be able to alter that text.&nbsp; The &quot;Text Editing&quot; section that follows describes how to protect text from alteration.</font>

<p><font face="Times">The Text class provides methods that affect a selection's length, character contents, font, gray value, and location in a scrolling view.&nbsp; A selection's font and gray value are discussed later under &quot;The Font&quot; and &quot;Drawing and the Text Class&quot;; the other concepts are introduced in the next two sections.</font>

<p><br><br>

<p><font face="Helvetica" size="+1"><b>Setting the Selection</b></font>

<p><font face="Times">The selection can be set by the user or it can be set programmatically.&nbsp; In most cases, the selection is set by the user's actions with the mouse, by clicking, dragging, or a combination of the two.&nbsp; See Chapter 2, &quot;The NeXT User Interface,&quot; for a general discussion of the semantics of mouse actions.&nbsp; The rest of this section discusses how to manage the selection programmatically.</font>

<p><font face="Times">The visibility of the caret, which marks the empty selection, is generally determined by the Application Kit itself rather than by the code you write.&nbsp; When a Text object becomes the first responder, it sends itself a <b>showCaret</b> message to start the timed entry that blinks the caret.&nbsp; Conversely, before a Text object stops being the first responder, it sends itself a <b>hideCaret</b> message to erase the caret from the text and to remove the timed entry.&nbsp; You'll rarely need to send these messages in your own code.</font>

<p><font face="Times">The position and extent of the selection can be set programmatically using the <b>setSel::</b> method.&nbsp; This method takes two integer arguments corresponding to the first and last character positions of the selection.&nbsp; If the two arguments are identical, <b>setSel::</b> has the effect of setting the position of the caret.</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">[myText setSel:0:0];</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">In this case, the caret moves to the start of the text.&nbsp; Note that the selection is measured from the left edge of the character at the specified position.&nbsp; Character position 0 is the position of the first character of the text; sending a <b>setSel:</b>0 <b>:</b>0 message moves the caret immediately to the left of the first character.</font>

<p><font face="Times">To select the first ten characters of the text, send this message:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">[myText setSel:0 :10];</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">Since the selection is measured from the left edge of the character position, this message selects the characters at character position 0 through 9.</font>

<p><font face="Times">The Text class provides the <b>selectText:</b>, <b>selectAll:</b>, and <b>selectError</b> methods for selecting the entire text. <b>selectText:</b> and <b>selectAll:</b> are synonyms.&nbsp; They attempt to make the text object the first responder and then, if successful, select the entire text.&nbsp; The <b>selectError</b> method is similar to these other two except that it doesn't attempt to alter the Text object's responder status before selecting the text.&nbsp; These methods are used primarily in support of the Text class's delegate/notification system, as described in &quot;The Delegate&quot; below.</font>

<p><br><br>

<p><font face="Helvetica" size="+1"><b>Querying the Selection</b></font>

<p><font face="Times">The <b>getSel::</b> method returns the starting and ending positions of the current selection, along with other information. Instead of taking <b>int</b> arguments like <b>setSel::</b>, <b>getSel::</b> takes pointers to <b>NXSelPt</b> structures.&nbsp; An <b>NXSelPt</b> structure has these fields:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">typedef struct _NXSelPt {</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cp;&nbsp;&nbsp;&nbsp; /* the character position */</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; line;&nbsp; /* line offset */</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">NXCoord&nbsp; x;&nbsp;&nbsp;&nbsp;&nbsp; /* x coordinate of character position */</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">NXCoord&nbsp; y;&nbsp;&nbsp;&nbsp;&nbsp; /* y coordinate of character position */</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; c1st; /* character position of first character in line */</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">NXCoord&nbsp; ht;&nbsp;&nbsp;&nbsp; /* line height */</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">} NXSelPt;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">The first field, <b>cp</b>, gives the character position of one end of the selection.&nbsp; The value of <b>line</b>, interpreted in light of information that a Text object keeps in an internal table of line breaks (see &quot;The Break Table&quot; in &quot;Text Tables and Filter Functions&quot; below), identifies the line of text containing this character position.&nbsp; The next two fields give the x and y location of the top corner of this end of the selection.&nbsp; <b>c1st</b> identifies the character position of the first character of the line containing <b>cp</b>.&nbsp; The last field, <b>ht</b>, gives the height of the line containing <b>cp</b>.&nbsp; Two <b>NXSelPt</b> structures give a Text object the information it needs to identify and highlight the selected characters.</font>

<p><font face="Times">Using the character position information from the <b>NXSelPt</b> structure, you could copy the selected text to another buffer:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">NXSelPt&nbsp; selStart, selEnd;</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">char&nbsp;&nbsp;&nbsp;&nbsp; buf[100];</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; selLength;</font>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">[myText getSel:&amp;selStart :&amp;selEnd];</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">selLength = selEnd.cp - selStart.cp;</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">[myText getSubstring:buf start:selStart.cp length:selLength];</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">buf[selLength+1] = '\0';</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">The <b>replaceSel:</b> method lets you alter the contents of the selection.&nbsp; With this method, for example, your application could replace a selected misspelled word with the correct spelling.&nbsp; You can also use <b>replaceSel:</b> to append text to the current contents of a Text object:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; length;</font>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">length = [myText textLength];</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">[myText setSel:length :length];</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">[myText replaceSel:&#34;\n\nYours truly,\n&#34;];</font>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica" size="+1"><b>Text Editing</b></font>

<p><font face="Times">The Text class provides two ways to control the editability of a Text object's text; the approach you take will depend on your needs.&nbsp; To set the editing status for the duration of the program's execution, use the <b>setEditable:</b> method.&nbsp; To allow editing under some circumstances but not others, let the Text object's delegate determine if and when the text is editable.</font>

<p><font face="Times">Note that these two systems can't be used at the same time.&nbsp; Sending a <b>setEditable:</b> message disables the delegate/notification system.</font>

<p><br><br>

<p><font face="Helvetica" size="+1"><b>Setting Editability</b></font>

<p><font face="Times">The <b>setEditable:</b> method lets you specify the editability of the text, and the <b>isEditable</b> method reports the text's current editing status:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">if([myText isEditable] == YES);</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">[myText setEditable:NO];</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">The following sections describe how a delegate can control the editability of the text.</font>

<p><br><br>

<p><font face="Helvetica" size="+1"><b>The Delegate</b></font>

<p><font face="Times">A Text object can send notification messages to a delegate in response to user actions.&nbsp; The delegate's response determines the Text object's behavior, such as whether it will allow the user to edit its text.</font>

<p><font face="Times">You set and query a Text object's delegate just as you would a Window's:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">[myText setDelegate:anObject];</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">anObject = [myText delegate];</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">A Text object sends predefined messages to its delegate depending on the user's specific input.&nbsp; These messages are described in the next section.</font>

<p><font face="Times">When you set the delegate, the Text object queries it to discover which of the predefined messages it responds to. Thereafter, the Text object only sends those messages that the delegate can accommodate.&nbsp; As noted below, a Text object reverts to its default behavior if its delegate doesn't respond to a particular message, or if there is no delegate object.</font>

<p><font face="Times">If, in your application, more than one Text object reports to the same delegate, you'll need a way to identify which text object sent the notification message.&nbsp; See &quot;The Tag&quot; below for such an identification system.</font>

<p><br><br>

<p><font face="Helvetica" size="+1"><b>Notification Messages</b></font>

<p><font face="Times">The notification messages a Text object sends to its delegate can be divided into two categories:&nbsp; those that are sent before a change is made and those that are sent after.&nbsp; Messages in the first group advise the delegate of an impending change, giving the delegate the chance to allow or prevent the change.&nbsp; Messages in the second group simply report that a change has been made.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=124></td>

<td nowrap><font face="Helvetica"><b>Before Change</b></font></td>

<td><font face="Helvetica"><b>After Change</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=131></td>

<td nowrap><font face="Times">textWillChange:</font></td>

<td><font face="Times">textDidChange:</font><br>
<font face="Times">text:isEmpty:</font></td></tr>

<tr valign=top>

<td width=131></td>

<td nowrap><font face="Times">textWillEnd:</font></td>

<td><font face="Times">textDidEnd:endChar:</font></td></tr>

<tr valign=top>

<td width=131></td>

<td nowrap><font face="Times">textWillResize:</font></td>

<td><font face="Times">textDidResize:oldBounds:invalid:</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica"><b>The textWillChange:, textDidChange:, and text:isEmpty: Messages</b></font>

<p><font face="Times">The delegate receives a <b>textWillChange:</b> message the first time the user attempts to change the text after a Text object has become the first responder.&nbsp; Only one <b>textWillChange:</b> message, the one accompanying the first attempted change, is sent during the time the Text object retains first responder status.&nbsp; The delegate, depending on the value returned by its <b>textWillChange:</b> method, either allows or prevents the change.</font>

<p><font face="Times">If the delegate's <b>textWillChange:</b> method returns NO, the change is allowed; if it returns YES, the change is prevented.&nbsp; You can think of a NO return value as indicating that the delegate has &quot;no objection&quot; to changes in the Text object.</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">- (BOOL) textWillChange:(id)textObject</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">{</font><br>
<img src="../../Images/sp.gif" width=180 height=1><font face="Courier" size="-1">return(NO);</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">}</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">If the delegate doesn't implement the <b>textWillChange:</b> method, or if the Text object has no delegate, the change is allowed by default.</font>

<p><font face="Times">If the delegate's response to the <b>textWillChange:</b> message allows the change, the delegate immediately receives a <b>textDidChange:</b> message.&nbsp; Thereafter, each time the user changes the text either by using the keyboard or the pasteboard, the delegate receives a <b>text:isEmpty:</b> message.&nbsp; This message passes the Text object's <b>id</b> and a boolean value indicating whether the Text object contains any text after the change.&nbsp; One example of the use of this information is the Save panel.&nbsp; The OK button is enabled or disabled depending on whether there's text in the text field provided for the file name.</font>

<p><font face="Times">When a user is entering characters from the keyboard, the Text object attempts to send a <b>text:isEmpty:</b> message for each character.&nbsp; A fast typist might outrun this system momentarily, but it's unlikely such a typist could enter more than two or three characters before the Text object sends a message.&nbsp; When a user cuts text from or pastes text into a Text object from the pasteboard, the Text object sends a single <b>text:isEmpty:</b> message to alert the delegate of the change.</font>

<p><br><br>

<p><font face="Helvetica"><b>The textWillEnd: and textDidEnd:endChar: Messages</b></font>

<p><font face="Times">Before a Text object ceases to be the first responder, it sends a <b>textWillEnd:</b> message to its delegate.&nbsp; The delegate can either allow the change or prevent it, depending on the return value of its <b>textWillEnd:</b> method.</font>

<p><font face="Times">If the delegate objects to the change, its <b>textWillEnd:</b> method returns YES; otherwise, it returns NO.&nbsp; If the delegate objects, the Text object remains the Window's first responder and selects the entire text (see &quot;The Selection&quot; below).</font>

<p><font face="Times">The <b>textWillEnd:</b> message gives the delegate a chance to validate the Text object's text before letting the user select some other object:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">- (BOOL) textWillEnd:(id)textObject</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">{</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">char&nbsp; *modelBuffer = &#34;The accepted answer.&#34;;</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">char&nbsp; *textBuffer;</font>

<p><img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">/* get entire text */</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">textBuffer = malloc([text textLength]+1);</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">[myText getSubstring:textBuffer start:0</font><br>
<img src="../../Images/sp.gif" width=180 height=1><font face="Courier" size="-1">length:[myText textLength]+1];</font>

<p><img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">/* compare the text to the model */</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">if (!strcmp(textBuffer, modelBuffer))</font><br>
<img src="../../Images/sp.gif" width=180 height=1><font face="Courier" size="-1">/* they're the same */</font><br>
<img src="../../Images/sp.gif" width=180 height=1><font face="Courier" size="-1">return(NO);</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">else</font><br>
<img src="../../Images/sp.gif" width=180 height=1><font face="Courier" size="-1">/* they're different */</font><br>
<img src="../../Images/sp.gif" width=180 height=1><font face="Courier" size="-1">return(YES);</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">}</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">If the delegate doesn't implement the <b>textWillEnd:</b> method, or if the Text object has no delegate, the change is allowed by default.</font>

<p><font face="Times">After a Text object ceases to be the first responder, it sends a <b>textDidEnd:endChar:</b> message to its delegate.&nbsp; The two arguments passed with this message are the Text object's <b>id</b> and the character that caused the Text object to stop being the first responder.&nbsp; The delegate can use this information to decide which other object should become the first responder.&nbsp; For example, if the character was Tab, the delegate would typically change the first responder to the next Text object in the window.</font>

<p><font face="Times">The Text object's character filter determines which characters the Text object interprets as a command to cease being the first responder.&nbsp; See &quot;Character Filter Functions&quot; below for more information.</font>

<p><br><br>

<p><font face="Helvetica"><b>The textWillResize: and textDidResize:oldBounds:invalid: Messages</b></font>

<p><font face="Times">The Text object's bounds rectangle can change size to accommodate a change in the amount of text.&nbsp; The bounds rectangle can either grow to hold an increased amount of text or shrink if some of the text is deleted.&nbsp; In either case, before the change can take place, the Text object sends a <b>textWillResize:</b> message to its delegate, passing its <b>id</b> as the message's argument.</font>

<p><font face="Times">As with the <b>textWillChange:</b> and <b>textWillEnd:</b> methods, the delegate's <b>textWillResize:</b> method can prevent the bounds rectangle from changing size by returning YES.&nbsp; If, on the other hand, the delegate permits the Text object's bounds to change size, it can specify to what degree and in which directions the change can occur:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">- (BOOL) textWillResize:(id)textObject</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">{</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">NXSize maxSize = {100.0, 10000.0};</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">NXSize minSize = {100.0, 100.0};</font>

<p><img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">[myText setMaxSize:&amp;maxSize];</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">[myText setMinSize:&amp;minSize];</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">return NO;</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">}</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">This <b>textWillResize:</b> method lets the Text object's bounds rectangle grow to 10000.0 units in the Text object's coordinate system in the vertical (or y) direction.&nbsp; No growth is allowed in the horizontal (or x) direction.&nbsp; It's not permitted to change size in either direction unless the Text object has been configured to be resizable as described in &quot;Frame Rectangle&quot; above.</font>

<p><font face="Times">If the delegate doesn't implement this method, or if the Text object has no delegate, the change is allowed by default.</font>

<p><font face="Times">The Text object sends a <b>textDidResize:oldBounds:invalid:</b> message to its delegate after the bounds rectangle's size has been changed.&nbsp; The Text object passes its <b>id</b> as the first argument and its old bounds rectangle as the second argument.&nbsp; The third argument is the area of the Text object's superview that should be redrawn if the Text object's new bounds rectangle is smaller than its old bounds rectangle.</font>

<p><br><br>

<p><font face="Helvetica" size="+1"><b>The Tag</b></font>

<p><font face="Times">You can assign a tag, an arbitrary integer, to a Text object as a means of identifying it to its delegate:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">[myText1 setTag:1];</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">[myText2 setTag:2];</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">A tag gives the delegate a way to determine which Text object, among several, has sent a particular notification message:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">- (BOOL) textWillChange:(id)textObject</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">{</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">if([textObject getTag] == 1)</font><br>
<img src="../../Images/sp.gif" width=180 height=1><font face="Courier" size="-1">/* prevent the change */</font><br>
<img src="../../Images/sp.gif" width=180 height=1><font face="Courier" size="-1">return(YES);</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">else if([textObject getTag] == 2)</font><br>
<img src="../../Images/sp.gif" width=180 height=1><font face="Courier" size="-1">/* allow the change */</font><br>
<img src="../../Images/sp.gif" width=180 height=1><font face="Courier" size="-1">return(NO);</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">}</font>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica" size="+1"><b>Smart Cut and Paste</b></font>

<p><font face="Times">A Text object attempts to respect word spacing conventions when the user cuts words from or pastes them into the text. For example, consider this sentence:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=124></td>

<td><font face="Times">&quot;I see no objection to stoutness, in moderation.&quot;</font><br>
<img src="../../Images/sp.gif" width=19 height=1><font face="Times">--W.S. Gilbert 1836-1911</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">If the user double-clicks the word &quot;no&quot; and then cuts it, the word and space character to its left disappear.&nbsp; This leaves only one space between the words that had flanked &quot;no&quot;.&nbsp; Furthermore, if the user double-clicks the word &quot;moderation&quot; and then cuts it, the period is brought up tight to the word &quot;in&quot;.&nbsp; Similarly, a word pasted into a line of text adds a space character when needed.&nbsp; For example, pasting the word &quot;strong&quot; between the words &quot;no objection&quot; results in &quot;no strong objection&quot;.&nbsp; It doesn't matter if the insertion point is to the left or right of the intervening space, standard word spacing is preserved.&nbsp; Pasting a word between an existing word and its following punctuation likewise leaves no unwanted spaces.&nbsp; Note that a Text object only uses &quot;smart&quot; cut and paste on word selections.&nbsp; The user must double-click, double-click and then Shift-click to extend the word selection, or double-click and drag to select a series of words to invoke this feature of the Text class.</font>

<p><font face="Times">See &quot;The Smart Cut and Paste Tables&quot; below for details on how this feature is implemented.</font>

<p><br><br>

<p><font face="Helvetica" size="+1"><b>Cut, Copy, Paste, and Delete</b></font>

<p><font face="Times">The Cut, Copy, Paste, and Delete commands of a standard application's Edit menu send, respectively, <b>cut:</b>, <b>copy:</b>, <b>paste:</b>, and <b>delete:</b> messages to the first responder.&nbsp; If you create an application using Interface Builder, these messages are already assigned to the appropriate menu item.&nbsp; A Text object is typically a Window's first responder and so must interpret these messages as editing commands.</font>

<p><font face="Times">Note, however, that not all Text objects may become first responder.&nbsp; To become first responder, a Text object must be selectable and, if it has a delegate, the delegate must allow the change of status.&nbsp; If a Text object doesn't meet these criteria, these editing commands will have no effect on it.</font>

<p><font face="Times">The simplest of these four editing methods is <b>delete:</b>.&nbsp; Assuming the current selection includes one or more characters, a <b>delete:</b> message removes the selected text from the Text object.&nbsp; The Text object rewraps and redisplays the remaining text and replaces the extended selection with the caret.&nbsp; If there is a delegate, and it implements the method, the Text object sends it a <b>text:isEmpty:</b> message.&nbsp; A <b>delete:</b> message affects only the text:&nbsp; No text is placed on the pasteboard.</font>

<p><font face="Times"><b>copy:</b> is the complement of <b>delete:</b>.&nbsp; A <b>copy:</b> message affects only the contents of the pasteboard, leaving the text unaltered.&nbsp; Again assuming a selection of positive length, a <b>copy:</b> message opens the pasteboard and writes the selected text to it.&nbsp; The Text object puts three types of data relating to the selection on the pasteboard:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">The text</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Format information</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Selection-type information</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">The text is simply an ASCII string of a specified length.&nbsp; Format information consists of the font characteristics and paragraph styles included in the copied text.&nbsp; The selection type records whether the text was the result of word selection.&nbsp; A Text object that receives this text can use the selection-type information to determine correct word spacing for the inserted text.&nbsp; Since a <b>copy:</b> message doesn't alter the text, no notification message is sent to the Text object's delegate.</font>

<p><font face="Times">The <b>cut:</b> method combines the functions of the <b>copy:</b> and <b>delete:</b> methods.&nbsp; In fact, when a Text object receives a <b>cut: </b>message, it sends itself a <b>copy:</b> message to copy the selected text to the pasteboard and then sends itself a <b>delete: </b>message to remove the selected text.</font>

<p><font face="Times">Assuming a Text object contains editable text, a <b>paste:</b> message causes it to read the contents of the pasteboard and insert the text.&nbsp; If the current selection is marked by a caret, the text is inserted at that point.&nbsp; If the current selection includes one or more characters, the inserted text replaces these characters.&nbsp; In either case, the Text object places the new insertion point after the inserted text.</font>

<p><font face="Times">Before inserting the pasteboard's contents into the text, a Text object checks whether this text was the result of word selection.&nbsp; If so, the Text object refers to its smart cut and paste tables to determine whether a space character should be added to one or both ends of the string to maintain proper word spacing around the inserted text.</font>

<p><font face="Times">The pasteboard can also contain formatting information for the text it contains.&nbsp; Depending on the Text object's state, it can either preserve the inserted text's previous format or ignore it and make the new text conform to the Text object's prevailing format.&nbsp; By default, a Text object ignores the formatting information from the pasteboard.&nbsp; The <b>setMonoFont:</b> method, as described in &quot;The Text's Font&quot; below, controls how a Text object handles formatting information from the pasteboard.</font>

<p><font face="Times">If the Text object's delegate implements the corresponding method, it receives a <b>text:isEmpty</b> message when text is pasted into the Text object.</font>

<p><br><br><br>

<p><font face="Helvetica" size="+1"><b>The Font</b></font>

<p><font face="Times">The Text class defines methods for setting the name, size, and style of the font for the entire text or any portion of it.&nbsp; A Text object alters the characteristics of a font by sending messages to a Font object.&nbsp; Although you can set a Text object's Font object directly, it's generally easier to use Text methods that let you set the individual font characteristics.&nbsp; The two sections below introduce the methods that affect a Text object's fonts.</font>

<p><font face="Times">A Text object actually receives two fonts for each font it requests.&nbsp; These two fonts are identical except for character width information:&nbsp; One font is designed for screen use and the other for the printer.&nbsp; In determining line breaks for some text, a Text object makes two calculations, one using screen widths and the other using printer widths.&nbsp; The Text object compares the results of these calculation and then breaks each line based on the result of the calculation that leaves the least text on a line.&nbsp; In this way, when comparing printed output to text on the screen, line breaks are consistent although precise line lengths may differ.</font>

<p><br><br>

<p><font face="Helvetica" size="+1"><b>The Text's Font</b></font>

<p><font face="Times">You can set the default font for a Text object using <b>setDefaultFont:</b>, as discussed in &quot;Creating a Text Object&quot; above. Once a Text object is created, use the <b>setFont:</b> method to set the font of the entire text.&nbsp; This method takes a Font <b>id</b> as its sole argument:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">[myText setFont: [Font newFont:&#34;Helvetica&#34; size:12.0 style:0</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">matrix:NX_FLIPPEDMATRIX]];</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">Notice that because a Text object draws in a flipped coordinate system, the matrix of the font it uses must match this orientation.</font>

<p><font face="Times">Since altering the font may change the number of characters that fit on a line, after receiving a <b>setFont:</b> message, the Text object recalculates the line layout and redraws the text.</font>

<p><font face="Times">When text is cut or copied to the pasteboard, it retains its font characteristics.&nbsp; When this text is pasted into another Text object, the pasted text can be displayed with its original font characteristics or it can assume those of the destination Text object.&nbsp; For many uses, it's more convenient to have the Text object use a single font.&nbsp; For example, a programmer writing a data-analysis application generally wouldn't want the added complexity of multiple font characteristics.</font>

<p><font face="Times">A <b>setMonoFont:</b>YES message makes a text object ignore the font information that accompanies pasted text.&nbsp; This is the default state of a Text object.&nbsp; The pasted text is displayed using the font characteristics of the first character of the existing text.&nbsp; The <b>isMonoFont</b> method reports whether a Text object will ignore the font information of pasted text.</font>

<p><font face="Times">Methods that change the font of selected text or read in text containing multiple fonts shouldn't be used with a Text object that is configured to contain only a single font.&nbsp; A text object configured in this way can display multiple fonts; however, each time text is cut or copied and then pasted, font information will be lost.</font>

<p><br><br>

<p><font face="Helvetica" size="+1"><b>The Selection's Font</b></font>

<p><font face="Times">The Text class defines a set of methods that let you alter the selection's font:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=131></td>

<td><font face="Times">setSelFont:</font><br>
<font face="Times">setSelFont:paraStyle:</font><br>
<font face="Times">setSelFontFamily:</font><br>
<font face="Times">setSelFontSize:</font><br>
<font face="Times">setSelFontStyle:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times"><b>setSelFont:</b> takes a Font object as an argument, allowing you to set several font characteristics simultaneously.&nbsp; The related method, <b>setSelFont:paraStyle:</b>, lets you additionally set the paragraph style of the selected text.</font>

<p><font face="Times">The next three methods each affect only one characteristic of the selection's font.&nbsp; <b>setSelFontFamily:</b> takes a single argument specifying a font name, such as Helvetica or Times-Roman.&nbsp; <b>setSelFontSize:</b> and <b>setSelFontStyle:</b> set the size and style of the selection's font.</font>

<p><font face="Times">As with <b>setFont:</b>, after a Text object resets the selection's font in response to any of the above messages, it recalculates the line breaks and redraws the text.</font>

<p><br><br><br>

<p><font face="Helvetica" size="+1"><b>Drawing and the Text Class</b></font>

<p><font face="Times">A Text object, by default, is a transparent View:&nbsp; Sending it a <b>display</b> message doesn't cause it to paint every pixel within its frame rectangle.&nbsp; (View transparency is discussed under &quot;The Display Methods&quot; in Chapter 7.)&nbsp; If a Text object's text is set in some way other than the keyboard (for example, by using a method such as <b>readText:</b> or <b>setText:</b>), the Text object draws only the characters on each line of text, not the pixels surrounding them.&nbsp; This allows you to draw text over another View without affecting more of that View than is necessary to display the characters.</font>

<p><font face="Times">However, when a Text object is receiving input from the keyboard, it always redraws the complete line--characters and background--that the new characters fall on.&nbsp; If, after the user is through entering text, you want to restore the background, send the Text object a <b>displayFromOpaqueAncestor:::</b> message.</font>

<p><font face="Times">To force a Text object to repaint all the area within its frame rectangle whenever it receives a message to display itself, send it a <b>setOpaque:</b> message:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">[myText setOpaque:YES];</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">A Text object, by default, draws black characters on a white background and marks the selection with by a light-gray highlight.&nbsp; You can change the gray value of the background, text, or selection by sending the appropriate messages.</font>

<p><font face="Times">The gray values of the background, text, and selection can be set to any value from 0.0 (represented by the constant NX_BLACK) to 1.0 (represented by the constant NX_WHITE) as the gray value argument of these methods. However, since only NX_WHITE, NX_LTGRAY, NX_DKGRAY, and NX_BLACK produce pure values on the NeXT computer's screen, these values result in the most legible text displays.</font>

<p><font face="Times">To invert the gray values of the standard text display, you would send these messages:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">[myText setBackgroundGray:NX_BLACK];</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">[myText setTextGray:NX_WHITE];</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">[myText setSelGray:NX_DKGRAY];</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">The <b>backgroundGray</b>, <b>textGray</b>, and <b>selGray</b> methods return the current values for these three parameters.</font>

<p><font face="Times">The caret is always black, so setting the background gray value to black will obscure the caret.</font>

<p><br><br><br>

<p><font face="Helvetica" size="+1"><b>Text Tables and Filter Functions</b></font>

<p><font face="Times">Much of a Text object's functionality is determined by the data it finds in certain tables and by the paradigms embodied in certain functions.&nbsp; The Text class provides methods that set these tables and functions, allowing you to change a Text object's behavior in fundamental ways without altering its class interface.&nbsp; This section introduces some of these tables and functions.</font>

<p><br><br>

<p><font face="Helvetica" size="+1"><b>The Smart Cut and Paste Tables</b></font>

<p><font face="Times">As described in &quot;Smart Cut and Paste&quot; above, a Text object tries to maintain, during cut and paste operations, the proper relationship between words and their surrounding text.&nbsp; It does this by consulting the two tables that are referred to by its <b>preSelSmartTable</b> and the <b>postSelSmartTable</b> instance variables.&nbsp; The Text class provides the <b>setPreSelSmartTable:</b> and <b>preSelSmartTable</b> methods to set and return the former table and a matching pair of methods to manage the latter table.&nbsp; These smart cut and paste tables define which characters a Text object should consider equivalent to a space.</font>

<p><font face="Times">For smart cut and paste to work, the selection must be the result of word selection.&nbsp; When you select a word or group of words and then cut the selection, the Text object removes the selection and the space to its left (if any).&nbsp; However, only the text is stored on the pasteboard; the space character is ignored.&nbsp; The Text object also records on the pasteboard that the cut text resulted from a smart cut operation.</font>

<p><font face="Times">When you paste the pasteboard's contents into the text, the Text object first checks to determine whether the pasteboard contains text that is the result of a smart cut or copy operation.&nbsp; If it does, the Text object looks at the characters that border the right and left sides of the insertion point or selection to be replaced.&nbsp; If the character on the left is in its smart left paste table, it pastes the word in without adding or subtracting anything on that side.&nbsp; If the character isn't in the left table, the Text object adds a space on that side when it pastes the word.&nbsp; It uses the same process on the right.</font>

<p><font face="Times">Here are the tables that the Text object uses by default:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">unsigned char&nbsp; NXSmartLeft[] = {' ', NX_EMSPACE, NX_ENSPACE,</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">NX_THINSPACE, NX_FIGSPACE, '\n', '(', '\t', '[', '\320 ', '\&#34;',</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">'\'', '\0'};</font>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">unsigned char&nbsp; NXSmartRight[] = {' ', NX_EMSPACE, NX_ENSPACE,</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">NX_THINSPACE, NX_FIGSPACE, '\n', ')', '\t', ']', '.', ',', ';',</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">':', '?', '\'', '!', '\&#34;', '\0'};</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">So, for example, pasting a word immediately to the right of a Tab character won't cause a Text object to add a space character on that side.&nbsp; Similarly, pasting a word immediately to the left of a colon doesn't cause a Text object to add a space between the word and the colon.</font>

<p><font face="Times">If you are going to use a Text object as an editor for C language programs, for example, you might prefer both tables to look like this:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">unsigned char&nbsp; smartForC[] = {' ', '\200', '\201', '\202', '\203',</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">'\n', '\t', '!', '\&#34;', '#', '$', '%', '&amp;', ''', '(', ')', '*',</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">'+', ',', '-', '.', '/', ':', ';', '&lt;', '=', '&gt;', '?', '@', '[',</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">'\', ']', '^', '_', ''', '{', '|', '}', '~', '\320'}</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">To set this table for both the preSelSmartTable and the postSelSmartTable, you'd send these messages:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">[text setPreSelSmartTable:smartForC];</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">[text setPostSelSmartTable:smartForC];</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">This table illustrates the different effects of the default tables in comparison to the C language table:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=307></td>

<td nowrap><font face="Helvetica"><b>Before Cut</b></font></td>

<td><font face="Helvetica"><b>After Cut</b></font></td></tr>

<tr valign=top>

<td width=307></td>

<td nowrap><font face="Helvetica"><b>After Paste</b></font></td>

<td></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=131></td>

<td nowrap><font face="Times"><b>Default</b></font></td>

<td nowrap><font face="Times">!word!</font></td>

<td nowrap><font face="Times">!!</font></td>

<td><font face="Times">! word!</font></td></tr>

<tr valign=top>

<td width=131></td>

<td nowrap><font face="Times"><b>C Table</b></font></td>

<td nowrap><font face="Times">!word!</font></td>

<td nowrap><font face="Times">!!</font></td>

<td><font face="Times">!word!</font></td></tr>

<tr valign=top>

<td width=131 height=20></td></tr>

<tr valign=top>

<td width=131></td>

<td nowrap><font face="Times"><b>Default</b></font></td>

<td nowrap><font face="Times">(word(</font></td>

<td nowrap><font face="Times">((</font></td>

<td><font face="Times">(word (</font></td></tr>

<tr valign=top>

<td width=131></td>

<td nowrap><font face="Times"><b>C Table</b></font></td>

<td nowrap><font face="Times">(word(</font></td>

<td nowrap><font face="Times">((</font></td>

<td><font face="Times">(word(</font></td></tr>

<tr valign=top>

<td width=131 height=20></td></tr>

<tr valign=top>

<td width=131></td>

<td nowrap><font face="Times"><b>Default</b></font></td>

<td nowrap><font face="Times">*word*</font></td>

<td nowrap><font face="Times">**</font></td>

<td><font face="Times">* word *</font></td></tr>

<tr valign=top>

<td width=131></td>

<td nowrap><font face="Times"><b>C Table</b></font></td>

<td nowrap><font face="Times">*word*</font></td>

<td nowrap><font face="Times">**</font></td>

<td><font face="Times">*word*</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica" size="+1"><b>The Click Table</b></font>

<p><font face="Times">A <i>click table</i> is a table a Text object consults to determine word boundaries for word selection.&nbsp; It's used whenever the user double-clicks a word, Shift-clicks to extend a word selection, or double-clicks and then drags to select a series of words.&nbsp; The default click table is designed to be used with standard English text.&nbsp; The <b>setClickTable:</b> and <b>clickTable </b>methods give you control of your Text object's click table.</font>

<p><br><br>

<p><font face="Helvetica" size="+1"><b>The Break Table</b></font>

<p><font face="Times">A <i>break table</i> is a table that a Text object uses to determine word boundaries for line breaks.&nbsp; It's similar to the click table, but has a different view of word boundaries.&nbsp; For example, if you insert enough text in the middle of a sentence to push the last word of the sentence onto the next line, the standard break table ensures that both the word and the final punctuation wrap to the next line.&nbsp; In contrast, if you double-click the last word of the sentence, the standard click table ensures that only the word, and not the final punctuation, is selected.</font>

<p><font face="Times">The <b>setBreakTable:</b> and <b>breakTable</b> methods give you access to the break table, although most programmers will rarely need a break table other than the default one.</font>

<p><br><br>

<p><font face="Helvetica" size="+1"><b>Filter Functions</b></font>

<p><font face="Times">A text object supports two types of input filters:&nbsp; a character filter and a text filter.&nbsp; Character filters remap one character code to another when necessary.&nbsp; Text filters allow for more extensive manipulation of the character or characters to be added to the text.</font>

<p><font face="Times">When the user enters a character from the keyboard, a Text object calls a character filter function to examine the entry. It can also optionally call a text filter function if one is installed.&nbsp; Neither type of filter examines characters that are read into the text from a file or from the pasteboard.</font>

<p><font face="Times">Depending on the current character filter function and the value of the entered character, the Text object adds the character to the list of those to be displayed, interprets the character as a command, or ignores the character.</font>

<p><font face="Times">Unlike a character filter, which only receives the individual character that's entered, a text filter additionally receives information about the state of the Text object.&nbsp; Based on this information, the text filter can change a number of variables including the content of the entered or existing text and the location of insertion point.</font>

<p><br><br>

<p><font face="Helvetica"><b>Character Filter Functions</b></font>

<p><font face="Times">The Text class provides two character filters, <b>NXFieldFilter()</b> and <b>NXEditorFilter()</b>, and you can write your own if necessary.&nbsp; <b>NXFieldFilter()</b> can be used to implement electronic forms.&nbsp; When the user presses Return, Tab, or Shift-Tab, <b>NXFieldFilter()</b> causes the Text object to cease being the first responder, letting some other object assume that role.&nbsp; <b>NXEditorFilter()</b> is designed to accept a wider variety of characters.&nbsp; It lets the user enter Tab and Return characters directly into the text.</font>

<p><font face="Times">By default, the Text object uses <b>NXFieldFilter()</b> as its character filter.&nbsp; You can change its filter by sending a <b>setCharFilter</b> message:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">[myText setCharFilter:NXEditorFilter];</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">Character filter functions operate by reassigning the codes of certain characters before sending the code on to the Text object.&nbsp; <b>NXFieldFilter()</b> and <b>NXEditorFilter()</b> reassign most codes less than 0x20 (the ASCII space character) to 0x00.&nbsp; Since a Text object ignores input having a value of 0x00, most control characters are excluded from the text.</font>

<p><font face="Times">Codes generated by Return, Tab, and Shift-Tab (back tab) are given special treatment.&nbsp; Depending on the filter, these codes can be sent unaltered to the Text Object or they can be first remapped to the corresponding constant, as defined in <b>Text.h</b>:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=131></td>

<td><font face="Times">NX_RETURN</font><br>
<font face="Times">NX_TAB</font><br>
<font face="Times">NX_BACKTAB</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">When a Text object receives a character code having one of these defined values, it attempts to end its status as first responder.&nbsp; If it has a delegate, the Text object sends the delegate a <b>textWillEnd:</b> message, and assuming the delegate allows the change, the Text object then sends a <b>textDidEnd:endChar:</b> message.&nbsp; This latter message includes a value that the delegate can check against these constants to determine which key caused the Text object to lose first-responder status:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">- textDidEnd:sender endChar:(unsigned short)whyEnd</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">{</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">switch (whyEnd) {</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">case NX_RETURN:</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">/* send a message based on contents of the Text object */</font><br>
<img src="../../Images/sp.gif" width=180 height=1><font face="Courier" size="-1">break;</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">case NX_TAB:</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">/* make the next text object the first responder */</font><br>
<img src="../../Images/sp.gif" width=180 height=1><font face="Courier" size="-1">break;</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">case NX_BACKTAB:</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">/* make the previous text object the first responder */</font><br>
<img src="../../Images/sp.gif" width=180 height=1><font face="Courier" size="-1">break;</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">}</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">}</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">The Matrix class uses code similar to this to let the user tab among the various fields.</font>

<p><font face="Times"><b>NXFieldFilter()</b> is the default character filter function for the Text class.&nbsp; The listing below details how <b>NXFieldFilter()</b> remaps the codes generated by Delete, Return, and Tab.</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">NXFieldFilter(unsigned short theChar, int flags)</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">{</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">if (flags &amp; NX_COMMANDMASK)</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">{</font><br>
<img src="../../Images/sp.gif" width=180 height=1><font face="Courier" size="-1">theChar = 0;</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">} else {</font><br>
<img src="../../Images/sp.gif" width=180 height=1><font face="Courier" size="-1">if (theChar == NX_DELETE)</font><br>
<img src="../../Images/sp.gif" width=208 height=1><font face="Courier" size="-1">theChar = NX_BACKSPACE;</font><br>
<img src="../../Images/sp.gif" width=180 height=1><font face="Courier" size="-1">else if (theChar == NX_CR) {</font><br>
<img src="../../Images/sp.gif" width=208 height=1><font face="Courier" size="-1">theChar = (flags &amp; NX_SHIFTMASK) ? '\n' : NX_RETURN;</font><br>
<img src="../../Images/sp.gif" width=180 height=1><font face="Courier" size="-1">} else if (theChar == '\t') {</font><br>
<img src="../../Images/sp.gif" width=208 height=1><font face="Courier" size="-1">theChar = (flags &amp; NX_SHIFTMASK) ? NX_BACKTAB : NX_TAB;</font><br>
<img src="../../Images/sp.gif" width=180 height=1><font face="Courier" size="-1">} else if ((theChar &lt; ' ') &amp;&amp; (theChar != '\n') &amp;&amp;</font><br>
<img src="../../Images/sp.gif" width=264 height=1><font face="Courier" size="-1">(theChar != NX_BACKSPACE))</font><br>
<img src="../../Images/sp.gif" width=208 height=1><font face="Courier" size="-1">theChar = 0;</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">}</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">return (theChar);</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">}</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">Notice that the codes generated by Return and Tab aren't remapped if Shift is down when the key is pressed.&nbsp; This allows the user to enter these characters even if <b>NXFieldFilter()</b> is in use.</font>

<p><font face="Times">The Text class also provides <b>NXEditorFilter()</b>, a character filter function for more general text editing:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">NXEditorFilter(unsigned short theChar, int flags)</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">{</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">if (flags &amp; NX_COMMANDMASK)</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">{</font><br>
<img src="../../Images/sp.gif" width=180 height=1><font face="Courier" size="-1">theChar = 0;</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">} else {</font><br>
<img src="../../Images/sp.gif" width=180 height=1><font face="Courier" size="-1">if (theChar == NX_DELETE)</font><br>
<img src="../../Images/sp.gif" width=208 height=1><font face="Courier" size="-1">theChar = NX_BACKSPACE;</font><br>
<img src="../../Images/sp.gif" width=180 height=1><font face="Courier" size="-1">else if (theChar == NX_CR) {</font><br>
<img src="../../Images/sp.gif" width=208 height=1><font face="Courier" size="-1">theChar = '\n';</font><br>
<img src="../../Images/sp.gif" width=180 height=1><font face="Courier" size="-1">} else if (theChar == '\t') {</font><br>
<img src="../../Images/sp.gif" width=208 height=1><font face="Courier" size="-1">;</font><br>
<img src="../../Images/sp.gif" width=180 height=1><font face="Courier" size="-1">} else if ((theChar &lt; ' ') &amp;&amp; (theChar != '\n') &amp;&amp;</font><br>
<img src="../../Images/sp.gif" width=264 height=1><font face="Courier" size="-1">(theChar != NX_BACKSPACE))</font><br>
<img src="../../Images/sp.gif" width=208 height=1><font face="Courier" size="-1">theChar = 0;</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">}</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">return (theChar);</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">}</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">Notice that <b>NXEditorFilter()</b> passes the codes generated by Return and Tab through to the Text object.&nbsp; Shift has no effect on how these codes are handled.</font>

<p><font face="Times">You might want to write your own character filter function.&nbsp; For example, <b>Text.h</b> defines four other constants that cause a Text object to attempt to resign first responder status:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=131></td>

<td><font face="Times">NX_LEFT</font><br>
<font face="Times">NX_RIGHT</font><br>
<font face="Times">NX_UP</font><br>
<font face="Times">NX_DOWN</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">By writing a character filter function that remaps certain Control sequences to these constants (such as Control-H, or 0x08, to NX_UP), you could provide alternate movement commands.&nbsp; Alternatively, with the help of the Text object's delegate, the new character filter could call a help system whenever the user entered such a Control sequence.</font>

<p><br><br>

<p><font face="Helvetica"><b>Text Filter Functions</b></font>

<p><font face="Times">The Text class provides for a text filter function although, by default, a text object doesn't use one.&nbsp; To install a text filter function, send a <b>setTextFilter:</b> message:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">[myText setTextFilter:FilterText];</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">The <b>textFilter</b> method returns the current text filter.</font>

<p><font face="Times">Once a text filter function is installed, it's called whenever text is entered from the keyboard.&nbsp; The filter receives four arguments:&nbsp; the <b>id</b> of the caller, a pointer to the character being entered, a pointer to the length of the text to be inserted, and the character position of the insertion.&nbsp; The filter can alter the inserted text, or the Text object's preexisting text, in any way.&nbsp; Whatever the alteration, the text filter must inform the Text object of new text to be inserted and the length of the inserted matter.</font>

<p><font face="Times">For example, the following simple text filter examines incoming characters for the occurrence of the &quot;&amp;&quot; character.&nbsp; If it finds one, it then checks the character immediately preceding the current character position.&nbsp; If the preceding character is a space, it replaces the &quot;&amp;&quot; with the word &quot;and&quot;.&nbsp; Note that if it makes such a substitution, it returns the length of the substitute string in the address referred to by <b>inputLength</b>:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">char&nbsp; sample[3];</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">char&nbsp; model[] =&#34; &amp;&#34;;</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">char&nbsp; substitute[] =&#34;and&#34;;</font>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">char *FilterText(id textObj, char *inputText, int *inputLength,</font><br>
<img src="../../Images/sp.gif" width=264 height=1><font face="Courier" size="-1">int position)</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">{</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">if (position &gt; 0) {</font><br>
<img src="../../Images/sp.gif" width=180 height=1><font face="Courier" size="-1">/* get character that precedes this one */</font><br>
<img src="../../Images/sp.gif" width=180 height=1><font face="Courier" size="-1">[textObj getSubstring:sample start:position-1 length:1];</font>

<p><img src="../../Images/sp.gif" width=180 height=1><font face="Courier" size="-1">/* add this character and null terminator */</font><br>
<img src="../../Images/sp.gif" width=180 height=1><font face="Courier" size="-1">sample[1] = *inputText;</font><br>
<img src="../../Images/sp.gif" width=180 height=1><font face="Courier" size="-1">sample[2] = '';</font>

<p><img src="../../Images/sp.gif" width=180 height=1><font face="Courier" size="-1">/* compare sample with model */</font><br>
<img src="../../Images/sp.gif" width=180 height=1><font face="Courier" size="-1">if (!strcmp(sample, model)) {</font><br>
<img src="../../Images/sp.gif" width=208 height=1><font face="Courier" size="-1">/* make substitution if they are equal */</font><br>
<img src="../../Images/sp.gif" width=208 height=1><font face="Courier" size="-1">*inputLength = 3;</font><br>
<img src="../../Images/sp.gif" width=208 height=1><font face="Courier" size="-1">return(substitute);</font><br>
<img src="../../Images/sp.gif" width=180 height=1><font face="Courier" size="-1">}</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">}</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">/* otherwise, simply return original character */</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">return (inputText);</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">}</font>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica" size="+1"><b>A Text Object in a Scrolling View</b></font>

<p><font face="Times">To accommodate large blocks of text, a Text object is commonly made a subview of a ScrollView.&nbsp; In this way, the user can scroll into view portions of the text that lie beyond the ScrollView's frame.&nbsp; A Text object must, however, be properly configured before it will cooperate with the ScrollView.</font>

<p><font face="Times">This example program creates a ScrollView within a Window and installs a Text object as the ScrollView's document view:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">#import &lt;appkit/appkit.h&gt;</font>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">main(int argc, char *argv)</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">{</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">id theWindow, theScrollView, myText;</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">NXRect aRect, contentRect;</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">NXSize aSize;</font>

<p><img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">NXApp = [Application new];&nbsp;&nbsp;&nbsp; /* create Application object */</font>

<p><img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">NXSetRect(&amp;aRect, 100.0, 350.0, 300.0, 300.0);</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">theWindow = [Window newContent:&amp;aRect&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* create Window */</font><br>
<img src="../../Images/sp.gif" width=264 height=1><font face="Courier" size="-1">style:NX_TITLEDSTYLE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* object */</font><br>
<img src="../../Images/sp.gif" width=264 height=1><font face="Courier" size="-1">backing:NX_BUFFERED</font><br>
<img src="../../Images/sp.gif" width=264 height=1><font face="Courier" size="-1">buttonMask:NX_ALLBUTTONS</font><br>
<img src="../../Images/sp.gif" width=264 height=1><font face="Courier" size="-1">defer:NO];</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">[theWindow setBackgroundGray:NX_WHITE];</font>

<p><img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">theScrollView = [ScrollView newFrame:&amp;aRect]; /* create */</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">[theScrollView setVertScrollerRequired:YES];&nbsp; /* a */</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">[theScrollView setHorizScrollerRequired:NO];&nbsp; /*ScrollView*/</font>

<p><img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">[theWindow setContentView:theScrollView];</font>

<p><img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">contentRect = aRect;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* find size of content view */</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">[ScrollView getContentSize:&amp;(contentRect.size)</font><br>
<img src="../../Images/sp.gif" width=208 height=1><font face="Courier" size="-1">forFrameSize:&amp;(aRect.size)</font><br>
<img src="../../Images/sp.gif" width=208 height=1><font face="Courier" size="-1">horizScroller:NO</font><br>
<img src="../../Images/sp.gif" width=208 height=1><font face="Courier" size="-1">vertScroller:YES</font><br>
<img src="../../Images/sp.gif" width=208 height=1><font face="Courier" size="-1">borderType:NX_NOBORDER];</font>

<p><img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">myText = [Text newFrame:&amp;contentRect&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* create a Text */</font><br>
<img src="../../Images/sp.gif" width=264 height=1><font face="Courier" size="-1">text:NULL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* object */</font><br>
<img src="../../Images/sp.gif" width=264 height=1><font face="Courier" size="-1">alignment:NX_LEFTALIGNED];</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">[myText notifyAncestorWhenFrameChanged:YES]; /*configure*/</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">[myText setVertResizable:YES];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* it to work with */</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">[myText setHorizResizable:NO];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* the ScrollView */</font>

<p><img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">aSize.width = 0.0;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* let the Text object get no smaller */</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">aSize.height = contentRect.size.height;&nbsp;&nbsp;&nbsp;&nbsp; /* than height of */</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">[myText setMinSize:&amp;aSize];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* ScrollView's content view */</font>

<p><img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">aSize.width = contentRect.size.width;&nbsp;&nbsp; /* let the Text */</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">aSize.height = 1000000.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* object's height grow */</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">[myText setMaxSize:&amp;aSize];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* to large value */</font>

<p><img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">[theScrollView setDocView:myText];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* make myText the doc.*/</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">[[myText superview] setAutoresizeSubviews:YES];&nbsp;&nbsp; /* view */</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">[[myText superview] setAutosizing:NX_HEIGHTSIZABLE |</font><br>
<img src="../../Images/sp.gif" width=180 height=1><font face="Courier" size="-1">NX_WIDTHSIZABLE];&nbsp;&nbsp; /* notify Text object if Window resized */</font>

<p><img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">[theWindow display];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* display the window in */</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">[theWindow orderFront:nil];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* front of other windows; */</font><br>
<img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">[theWindow makeKeyWindow];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* make it the key window */</font>

<p><img src="../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">[NXApp run];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* start the Application */</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">}</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">In this example, a Text object is made the document view of a ScrollView.&nbsp; The ScrollView only allows scrolling in the vertical direction, so the Text object is also constrained to grow only vertically.&nbsp; The Text object's frame is sized to fit within the scrolling portion of the ScrollView.&nbsp; When a user adds enough text to the Text object to cause its frame to grow, the <b>notifyAncestorWhenFrameChanged:</b> message ensures that the ScrollView is notified of the change.&nbsp; The ScrollView automatically scrolls the new line of text into view and then displays a knob to allow the user to access other portions of the document view.&nbsp; The knob will disappear if the user deletes enough text to shrink the Text object to its original, and minimum, size.</font>

<p><br><br><br>

<p><font face="Helvetica" size="+1"><b>Reusing a Text Object</b></font>

<p><font face="Times">As an efficiency, a single Text object can be reused:&nbsp; It can be made to draw in various Views or various locations within one View.&nbsp; In fact, you can make use of a Window's field editor, the Text object that the Application Kit uses to draw text within standard Kit objects.&nbsp; Using one Text object rather than several saves both startup time and memory.</font>

<p><br><br><br>

<p><font face="Helvetica" size="+1"><b>Archiving a Text Object</b></font>

<p><font face="Times">The <b>write:</b> method writes the Text object's instance variables out to the archive stream.&nbsp; It doesn't, however, maintain the values of the following instance variables if you've reassigned their values to functions or tables not provided by the Text class:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=131></td>

<td><font face="Times">charFilterFunc</font><br>
<font face="Times">scanFunc</font><br>
<font face="Times">drawFunc</font><br>
<font face="Times">charCategoryTable</font><br>
<font face="Times">preSelSmartTable</font><br>
<font face="Times">postSelSmartTable</font><br>
<font face="Times">breakTable</font><br>
<font face="Times">clickTable</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">The <b>read:</b> method reads the Text object's instance variables into memory from the archive stream.&nbsp; Once the Text object is reestablished in memory, you may want to reset some of the values of the instance variables above.</font>

<p><font face="Times">One way to do this is to send the appropriate messages to the Text object from another object's awake method.&nbsp; <b>awake </b>messages are only sent after the Text object and all the objects it refers to have been read in, ensuring that the Text object is ready to receive the initializing messages.&nbsp; In the same way, you can send a <b>setSel::</b> message to reestablish the selection.</font>

<p><br><br><br>

<p><font face="Helvetica" size="+1"><b>Rich Text Format Support</b></font>

<p><font face="Times">A Text object can encode and decode a subset of the formatting commands defined in RTF; the following table summarizes that support.&nbsp; For example, a Text object can read and properly display the characters associated with a <b>\b </b>control word, making those characters have a bold attribute.&nbsp; It can also embed this control word along with the affected characters when it writes the file to the disk.&nbsp; For other control words, such as <b>\margl</b><i>n,</i> a Text object will display the associated characters properly but won't write the control word when it writes the characters to a file. When reading text from a file, a Text object ignores any RTF control word that's not listed in the following table.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=124></td>

<td nowrap><font face="Helvetica"><b>Control Word</b></font></td>

<td><font face="Helvetica"><b>Read/Write</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=131></td>

<td nowrap><font face="Times"><b>\ansi</b></font></td>

<td><font face="Times">yes/yes</font></td></tr>

<tr valign=top>

<td width=131></td>

<td nowrap><font face="Times"><b>\paperw</b><i>n</i></font></td>

<td><font face="Times">yes/yes</font></td></tr>

<tr valign=top>

<td width=131></td>

<td nowrap><font face="Times"><b>\margl</b><i>n</i></font></td>

<td><font face="Times">yes/yes</font></td></tr>

<tr valign=top>

<td width=131></td>

<td nowrap><font face="Times"><b>\margr</b><i>n</i></font></td>

<td><font face="Times">yes/yes</font></td></tr>

<tr valign=top>

<td width=131></td>

<td nowrap><font face="Times"><b>\pard</b></font></td>

<td><font face="Times">yes/no</font></td></tr>

<tr valign=top>

<td width=131></td>

<td nowrap><font face="Times"><b>\s</b><i>n</i></font></td>

<td><font face="Times">yes/no</font></td></tr>

<tr valign=top>

<td width=131></td>

<td nowrap><font face="Times"><b>\ql</b></font></td>

<td><font face="Times">yes/yes</font></td></tr>

<tr valign=top>

<td width=131></td>

<td nowrap><font face="Times"><b>\qr</b></font></td>

<td><font face="Times">yes/yes</font></td></tr>

<tr valign=top>

<td width=131></td>

<td nowrap><font face="Times"><b>\qc</b></font></td>

<td><font face="Times">yes/yes</font></td></tr>

<tr valign=top>

<td width=131></td>

<td nowrap><font face="Times"><b>\fi</b><i>n</i></font></td>

<td><font face="Times">yes/yes</font></td></tr>

<tr valign=top>

<td width=131></td>

<td nowrap><font face="Times"><b>\li</b><i>n</i></font></td>

<td><font face="Times">yes/yes</font></td></tr>

<tr valign=top>

<td width=131></td>

<td nowrap><font face="Times"><b>\b</b></font></td>

<td><font face="Times">yes/yes</font></td></tr>

<tr valign=top>

<td width=131></td>

<td nowrap><font face="Times"><b>\i</b></font></td>

<td><font face="Times">yes/yes</font></td></tr>

<tr valign=top>

<td width=131></td>

<td nowrap><font face="Times"><b>\f</b><i>n</i></font></td>

<td><font face="Times">yes/yes</font></td></tr>

<tr valign=top>

<td width=131></td>

<td nowrap><font face="Times"><b>\fs</b><i>n</i></font></td>

<td><font face="Times">yes/yes</font></td></tr>

<tr valign=top>

<td width=131></td>

<td nowrap><font face="Times"><b>\up</b><i>n</i></font></td>

<td><font face="Times">yes/yes</font></td></tr>

<tr valign=top>

<td width=131></td>

<td nowrap><font face="Times"><b>\dn</b><i>n</i></font></td>

<td><font face="Times">yes/yes</font></td></tr>

<tr valign=top>

<td width=131></td>

<td nowrap><font face="Times"><b>\par</b></font></td>

<td><font face="Times">yes/yes</font></td></tr>

<tr valign=top>

<td width=131></td>

<td nowrap><font face="Times"><b>\tab</b></font></td>

<td><font face="Times">yes/yes</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">The Text class doesn't write the <b>\pard</b> control word; instead, it manipulates groupings to restore paragraph default values when needed.&nbsp; In addition, the Text class interprets the <b>\sect</b>, <b>\page</b>, and <b>\line</b> control words as Return characters.&nbsp; The Text class recognizes all installed fonts.&nbsp; See <i>Rich Text Format Specification</i> by Microsoft Corporation for more information about RTF.</font></td></tr>

</table>

<p><br><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=5></td>

<td><font face="Helvetica" size="+2"><b>The Box Class</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">A Box is a View that visually groups other Views.&nbsp; As shown in Figure 9-3, a typical Box displays a border and a title. Box objects are often used to group choices that a user can make in a panel.&nbsp; For example, in a Find panel, one Box may surround buttons that set the scope of the search; another may enclose the switches that specify whether the case of letters should be ignored and whether the text to be found should be treated as a regular expression.</font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><img src="F5.gif" width=183 height=92></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica"><b>Figure 9-3</b></font><font face="Times">.&nbsp; A Typical Box</font>

<p><br><br>

<p><font face="Times">A Box's border encloses its contents.&nbsp; After changing the Box's contents, you can resize the Box to fit.&nbsp; You can also change how the Box looks by modifying its border type and the title's position and font.&nbsp; The following two sections discuss how to accomplish these tasks.&nbsp; However, you may want to use Interface Builder to create and set the initial characteristics of a Box, since that's easy to do.&nbsp; Your application code could then use the methods discussed in the following sections to modify the Box dynamically at appropriate moments in your program.</font>

<p><br><br><br>

<p><font face="Helvetica" size="+1"><b>Creating and Modifying a Box Object</b></font>

<p><font face="Times">The <b>newFrame:</b> class method returns a new instance of the Box class with the location, height, and width specified by its argument:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">NXRect myRect;</font>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">NXSetRect (&amp;myRect, 200.0, 200.0, 500.0, 500.0);</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">myBox = [Box newFrame:&amp;myRect];</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">Since you'll probably be adding to the Box's initially empty contents and then resizing the Box, its original size isn't critical.&nbsp; It's easy to make the Box larger or smaller as needed to encompass its contents.&nbsp; The &quot;Resizing the Box&quot; section below explains how to do this.</font>

<p><font face="Times">A Box object defines a set of rectangles that determine how component parts are laid out.&nbsp; These rectangles are shown in Figure 9-4.</font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><img src="F4.gif" width=332 height=124></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica"><b>Figure 9-4</b></font><font face="Times">.&nbsp; The Layout Rectangles of a Box</font>

<p><br><br>

<p><font face="Times">The external boundary of the Box is defined by its frame rectangle.&nbsp; Within this boundary lies the border rectangle; its location is determined by the location and size of the title rectangle, the rectangle that encloses the title.&nbsp; If you choose to display the title above the top edge of the border, for example, you will cause the border rectangle to shrink.&nbsp; The innermost, or content, rectangle encompasses the contents of the Box.&nbsp; You can set the value of the offsets, which determine the amount of horizontal and vertical space between the content rectangle and the border rectangle.</font>

<p><br><br>

<p><font face="Helvetica" size="+1"><b>The Border</b></font>

<p><font face="Times">A Box's border can be marked with a line, a bezel, a groove, or nothing at all.&nbsp; Figure 9-5 shows these border types and the corresponding constants you can use to set the type.</font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><img src="F3.gif" width=215 height=148></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica"><b>Figure 9-5</b></font><font face="Times">.&nbsp; Border Types</font>

<p><br><br>

<p><font face="Times">By default, a Box has a grooved border.&nbsp; To change this, you send a <b>setBorderType:</b> message to the Box, with one of the four constants as its argument.&nbsp; For example, to set the border type to a bezel:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">[myBox setBorderType:NX_BEZEL];</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">You can also query the Box about its border type, with the <b>borderType</b> method:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">int&nbsp; myBorderType;</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">myBorderType = [myBox borderType];</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">Since the border is drawn inside the Box, it will slightly reduce the space available for the content rectangle.&nbsp; A borderless Box doesn't affect the content rectangle, but lines, bezels, and grooves reduce both the width and the height of the content rectangle by 2.0, 4.0, and 6.0, respectively.&nbsp; In addition to setting the border type, the <b>setBorderType: </b>method recalculates the size of the content rectangle based on the width of the new border.</font>

<p><br><br>

<p><font face="Helvetica" size="+1"><b>The Title</b></font>

<p><font face="Times">You can have a Box with no title or one with a title positioned above, below, or intersected by the border at either the top or the bottom of the Box.&nbsp; Figure 9-6 shows the possible title positions and the corresponding constants you can use to set the position.&nbsp; The default position is NX_ATTOP.</font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><img src="F2.gif" width=332 height=226></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica"><b>Figure 9-6</b></font><font face="Times">.&nbsp; Title Positions</font>

<p><br><br>

<p><font face="Times">You set the title position by specifying one of the seven constants with the <b>setTitlePosition:</b> method.&nbsp; The following example sets the position to be above the top of the border:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">[myBox setTitlePosition:NX_ABOVETOP];</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">The <b>setTitlePosition:</b> method adjusts the rectangles of the Box so that they're positioned correctly relative to the title.</font>

<p><font face="Times">A Box's default title is &quot;Title&quot;.&nbsp; To change this, you send the Box a <b>setTitle:</b> message and specify the text you want displayed as the title:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">const char&nbsp; *myTitle =&#34;Find Options&#34;;</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">[myBox setTitle:myTitle];</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">In addition to changing the text, the <b>setTitle:</b> method recalculates the size of the title rectangle.&nbsp; If the title is longer than the width of the Box, the title rectangle's width is reduced to the size of the Box and the text is clipped.&nbsp; <b>setTitle: </b>also provides a small cushion of space on the top and bottom of the title so that it doesn't actually touch the Box's border.</font>

<p><font face="Times">By default, the title will be displayed using 12-point Helvetica.&nbsp; However, you can use the <b>setFont:</b> method to specify a new font, as shown below.&nbsp; (You could also use the defaults mechanism to change the system font, but this may affect more than the title of your Box; see &quot;The Defaults System&quot; in Chapter 10, &quot;Support Objects and Functions.&quot;)</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">[myBox setFont:aNewFontObj];</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">The <b>setFont:</b> method recalculates the Box's rectangles.&nbsp; If you increased the font size significantly, for example, the title rectangle would increase; the content rectangle and possibly the border rectangle (if the title is outside of or intersected by the border) would decrease to accommodate the larger title rectangle.</font>

<p><font face="Times">You can also query a Box about its title, title position, and font:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">id&nbsp;&nbsp;&nbsp;&nbsp; myFontObject;</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">char&nbsp; *myTitle;</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">int&nbsp;&nbsp;&nbsp; myTitlePosition;</font>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">myTitle = [myBox title];</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">myTitlePosition = [myBox titlePosition];</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">myFontObject = [myBox font];</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">The <b>title</b> method returns a pointer to the Box's title.&nbsp; <b>titlePosition</b> returns one of the seven constants that correspond to the title's position, and <b>font</b> returns the <b>id</b> of the font object used to display the title.</font>

<p><br><br>

<p><font face="Helvetica" size="+1"><b>The Offsets</b></font>

<p><font face="Times">The content rectangle of a Box can be horizontally and vertically offset inside the border.&nbsp; This allows you to adjust the space between the contents and the border and to make the horizontal offset different than the vertical offset.&nbsp; As shown above in Figure 9-4, the two vertical offsets (at the top and bottom of the Box) are equal, and the horizontal offsets at each side are equal.&nbsp; When you set the offsets, the size of the Box rather than the content rectangle is changed to accommodate the offsets.</font>

<p><font face="Times">Initially, a Box is created with default offsets of 5.0.&nbsp; To set new offsets, you supply them as arguments to the <b>setOffsets:</b> method, as shown below.&nbsp; (Although you can specify negative offset values, the contents of the Box or the Box itself may be clipped.)</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">[myBox setOffsets:40.0 :0.0];</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">The first argument for the <b>setOffsets</b> method refers to the horizontal offset, and the second refers to the vertical offset. In this example, if the previous offset values were the default 5.0, the horizontal dimension of the Box's frame rectangle will increase by a total of 70.0 and the vertical dimension will decrease by 10.0.&nbsp; After changing the offsets, you'll want to resize the box using the <b>setFrameFromContentFrame</b> method, which is described in more detail in the &quot;Resizing the Box&quot; section below.</font>

<p><font face="Times">You can obtain the current values of a Box's offsets by querying the Box:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">NXSize&nbsp; mySize;</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">[myBox getOffsets:&amp;mySize];</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">The offsets will be placed in <b>mySize</b>, which must be an NXSize structure.</font>

<p><br><br><br>

<p><font face="Helvetica" size="+1"><b>The Contents of the Box</b></font>

<p><font face="Times">As a graphic object, a Box's purpose is to visually group its contents, typically by displaying a border and a categorizing title.&nbsp; As discussed above, you can modify the border and title in several ways.&nbsp; You can also add to the Box's contents and then resize it so that it comfortably encloses them.&nbsp; For example, you may want to use a Matrix of switches that changes the number of Cells it displays.&nbsp; The next two sections discuss how to manage a Box's contents and how to resize the Box.</font>

<p><br><br>

<p><font face="Helvetica" size="+1"><b>Box's View Hierarchy</b></font>

<p><font face="Times">Views are added to the Box's contents by making them subviews.&nbsp; Here <b>newSubview</b> is added to <b>myBox</b>:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">[myBox addSubview:newSubview];</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">This actually makes <b>newSubview</b> a subview of the content view, which corresponds to the Box's content rectangle. The content view groups the Box's contents and makes sure that they're displayed only within the content rectangle. Since the content view is a subview of Box, the frame rectangles of Views added to the Box should reflect their position in the content rectangle, not the Box's frame rectangle.&nbsp; After you've added a subview, you'll probably want to use the <b>sizeToFit</b> method (described below) to adjust the Box's size to accommodate its new subview.</font>

<p><font face="Times">To replace the existing content view, you send a <b>setContentView:</b> message to the Box, giving it the new content view as the argument:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">[myBox setContentView:newContentView];</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">The old content view is returned so that you can either free it or use it in another view hierarchy.&nbsp; Since <b>setContentView:</b> recalculates the size of the Box based on the size of the new content view, you don't need to resize it.</font>

<p><br><br>

<p><font face="Helvetica" size="+1"><b>Resizing the Box</b></font>

<p><font face="Times">If you've added a subview to the Box's contents, you should use the <b>sizeToFit</b> method to adjust the size of the Box. <b>sizeToFit</b> calculates the appropriate size for the content rectangle so that it just encloses all the content view's subviews.&nbsp; It then uses the <b>setFrameFromContentFrame:</b> method to resize the Box to match the new content rectangle.</font>

<p><font face="Times">You can also send the <b>setFrameFromContentFrame:</b> method directly to the Box to specify a new location and size for the content rectangle:</font></td></tr>

</table>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">NXRect myContentRectangle;</font>

<p><img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">NXSetRect (&amp;myContentRectangle, 100.0, 100.0, 300.0, 300.0);</font><br>
<img src="../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">[myBox setFrameFromContentFrame:&amp;myContentRectangle];</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">The Box is resized and relocated so that its content view has the same dimensions as the specified content rectangle, which is in the coordinate system of the Box's superview.</font>

<p><font face="Times">You can also resize the Box from the outside in, using the <b>sizeTo::</b> method.&nbsp; The two arguments specify the new width and height of the Box.&nbsp; The Box's layout rectangles are then recalculated to fit inside this new boundary.&nbsp; If the new size of the Box is too small for its content view (taking into account the offsets), the drawing that the content view displays will be clipped at the Box's boundaries.</font></td></tr>

</table>



<p><br><br><br><br><br><br><br>

</body>
</html>
