<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<!-- Created with LatinByrd III -->
<!-- File: /Apps/NextDev/GeneralRef/04_DatabaseKit/Classes/DBExpression.rtf -->
<!-- Date: Sun Jun 28 20:04:18 1998 -->
<head>
<title>DBExpression</title>
</head>

<body bgcolor="#FFFFFF" text="#000000" link="#0000FF" alink="#FF00FF" vlink="#FF0000">

<basefont size=3>

<p><font face="Times" size="-1">Copyright</font> <font size="-1">&copy;</font><font face="Times" size="-1">1995 by NeXT Computer, Inc.&nbsp; All Rights Reserved.</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Helvetica" size="+2"><b>DBExpression</b></font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Helvetica"><b>Inherits From:</b></font></td>

<td><font face="Times">Object</font></td></tr>

<tr valign=top>

<td width=105 height=12></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Helvetica"><b>Conforms To:</b></font></td>

<td><font face="Times">DBProperties</font><br>
<font face="Times">DBExpressionValues</font></td></tr>

<tr valign=top>

<td width=105 height=12></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Helvetica"><b>Declared In:</b></font></td>

<td><font face="Times">dbkit/DBExpression.h</font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=69></td>

<td><font face="Helvetica" size="+1"><b>Class Description</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">A DBExpression encapusulates a database expression as an object.&nbsp; A database expression specifies a property of data to be returned from an entity in the database.&nbsp; A fetch is governed by a list of DBExpressions, one for each of the properties to be returned (and also by a DBQualifier that specifies which records are to be included.)</font>

<p><font face="Times">The DBExpression class provides methods that let you refer to existing properties, specify the type of data to be returned for a property, and combine existing properties to create a new one.</font>

<p><font face="Times">Every DBExpression is relative to an entity; the entity is specified in the <b>initForEntity:...</b> methods:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">initForEntity:fromDescription:</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">initForEntity:fromName:usingType:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">You can change the entity or description of an existing DBExpression by sending it a&nbsp; <b>setEntity:andDescription:</b> message.</font>

<p><br><br>

<p><font face="Helvetica"><b>Format of a DBExpression's Description</b></font>

<p><font face="Times">The text of a DBExpression is called its <i>description</i>.&nbsp; The description is constructed in much the same way as a <b>printf </b>statement.&nbsp; That is, it consists of a quoted string containing the symbols needed to construct the expression with placeholders for the various values, followed by the names of the objects to be substituted for the placeholders.&nbsp; The following substitution symbols may occur within the quoted string:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=124></td>

<td nowrap><font face="Helvetica"><b>Symbol</b></font></td>

<td><font face="Helvetica"><b>Expected value</b></font></td></tr>

<tr valign=top>

<td width=124 height=4></td></tr>

<tr valign=top>

<td width=124></td>

<td nowrap><font face="Times">%s</font></td>

<td><font face="Times">A constant string (<b>const char *</b>).</font></td></tr>

<tr valign=top>

<td width=124 height=9></td></tr>

<tr valign=top>

<td width=124></td>

<td nowrap><font face="Times">%p</font></td>

<td><font face="Times">A (<b>const char *</b>) that names one of the entity's properties.</font></td></tr>

<tr valign=top>

<td width=124 height=9></td></tr>

<tr valign=top>

<td width=124></td>

<td nowrap><font face="Times">%d</font></td>

<td><font face="Times">An <b>int</b>.</font></td></tr>

<tr valign=top>

<td width=124 height=9></td></tr>

<tr valign=top>

<td width=124></td>

<td nowrap><font face="Times">%f</font></td>

<td><font face="Times">A <b>double</b> or <b>float</b>.</font></td></tr>

<tr valign=top>

<td width=124 height=9></td></tr>

<tr valign=top>

<td width=124></td>

<td nowrap><font face="Times">%@</font></td>

<td><font face="Times">An object that conforms to the DBExpressionValues protocol, or a property object created by the Database Kit. (The former includes DBExpression, allowing you to created a nested expression.)</font></td></tr>

<tr valign=top>

<td width=124 height=9></td></tr>

<tr valign=top>

<td width=124></td>

<td nowrap><font face="Times">%%</font></td>

<td><font face="Times">No value--this passes a single `%' literally.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">The rest of the format string should comprise query-language operators and symbols, the names of properties, and whitespace. For example, suppose you have a <b>boxes</b> entity that has properties named &quot;height&quot;, &quot;width&quot;, and &quot;depth.&quot;&nbsp; To create a DBExpression that calculates the volume of a box, you would do the following:</font></td></tr>

</table>

<p><img src="../../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">id h = [boxes propertyNamed:&#34;height&#34;];</font><br>
<img src="../../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">id w = [boxes propertyNamed:&#34;width&#34;];</font><br>
<img src="../../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">id d = [boxes propertyNamed:&#34;depth&#34;];</font>

<p><img src="../../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">DBExpression *volume = [[DBExpression alloc] initForEntity:boxes</font><br>
<img src="../../../Images/sp.gif" width=292 height=1><font face="Courier" size="-1">fromDescription:&#34;%@ * %@ * %@&#34;, h,w,d];</font>

<p><img src="../../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">/* Setting the name isn't essential, but it's a good idea. */</font><br>
<img src="../../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">[volume setName:&#34;volume&#34;];</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">To evaluate a DBExpression, you send it an <b>expressionValue</b> message.&nbsp; The return is a string in the query language used by the adaptor, representing the expression.</font>

<p><br><br>

<p><font face="Helvetica"><b>Using a DBExpression</b></font>

<p><font face="Times">A DBExpression object adopts the DBProperties protocol, and so can be used in any situation that requires a property.&nbsp; To retrieve data for a DBExpression, before executing a fetch, you add the DBExpression to the list of expressions maintained by the object that you're using to fetch data (a DBRecordList, DBRecordStream, or DBBinder).&nbsp; You can use a DBExpression to get the value for a property from a record by passing it to methods such as DBBinder's <b>valueForProperty:</b> or DBRecordList's <b>getValue:forProperty:.</b></font>

<p><font face="Times">The two most important differences between a DBExpression that you've created and a property that you've retrieved from an entity are these:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">You can't write the value for a self-created DBExpression back to the source.</font></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">You create it, you free it.</font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=69></td>

<td><font face="Helvetica" size="+1"><b>Instance Variables</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">None declared in this class.</font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=69></td>

<td><font face="Helvetica" size="+1"><b>Adopted Protocols</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times">DBExpressionValues</font></td>

<td><img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times">expressionValue</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=306></td>

<td><img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times">isDeferredExpression</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times">DBProperties</font></td>

<td><img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times">name</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=306></td>

<td><img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times">setName:</font><br>
<img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times">entity</font><br>
<img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times">matchesProperty:</font><br>
<img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times">propertyType</font><br>
<img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times">isSingular</font><br>
<img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times">isReadOnly</font><br>
<img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times">isKey</font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=69></td>

<td><font face="Helvetica" size="+1"><b>Method Types</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">Creating and freeing a DBExpression</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=306></td>

<td><img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times">initForEntity:fromDescription:</font><br>
<img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times">initForEntity:fromName:usingType:</font><br>
<img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times">copyFromZone:</font><br>
<img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times">free</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">Setting the entity and description</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=308></td>

<td><img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times">setEntity:andDescription:</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times">Archiving</font></td>

<td><img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times">read:</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=306></td>

<td><img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times">write:</font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=69></td>

<td><font face="Helvetica" size="+1"><b>Instance Methods</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica"><b>copyFromZone:</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=124></td>

<td><img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times"><b>copyFromZone:</b>(NXZone *)<i>zone</i></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">Creates and returns a copy of the receiving DBExpression.&nbsp; The new object is created in the given zone.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica"><b>free</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=124></td>

<td><img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times"><b>free</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">Frees the DBExpression.</font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica"><b>initForEntity:fromDescription:</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=124></td>

<td><img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times"><b>initForEntity:</b>(id &lt;DBEntities&gt;)<i>anEntity</i></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=163></td>

<td><font face="Times"><b>fromDescription:</b>(const unsigned char *)<i>descriptionFormat</i>, ...</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">A designated initializer for the DBExpression class, this initializes a freshly allocated DBExpression by setting its entity to <i>anEntity</i> and setting its description as specified by the other arguments.&nbsp; The description is in the style of a <b>printf</b> statement: <i>descriptionFormat</i> is a quoted string that establishes the format of the description, the following arguments supply the description with values.&nbsp; The arguments are separated by commas.&nbsp; See the class description above for the rules governing the format of the description string.</font>

<p><font face="Times">If the description refers to a single, unmanipulated property, then the DBExpression will be &quot;simple&quot;--the property that the DBExpression represents will be the property referred to in the description.&nbsp; If the description manipulates one or more existing properties, then the object is &quot;derived,&quot; and a new property object is created to describe the manipulation.&nbsp; The data type of a derived DBExpression is a string, and it's given a unique name.</font>

<p><font face="Times">Returns <b>self</b>, or <b>nil</b> if either of the arguments is <b>nil</b>.</font>

<p><font face="Helvetica"><b>See also:</b></font>&nbsp; <img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times"><b>initForEntity:fromName:usingType:</b></font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica"><b>initForEntity:fromName:usingType:</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=124></td>

<td><img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times"><b>initForEntity:</b>(id &lt;DBEntities&gt;)<i>anEntity</i></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=163></td>

<td><font face="Times"><b>fromName:</b>(const char *)<i>aPropertyName</i></font><br>
<font face="Times"><b>usingType:</b>(const char *)<i>aType</i></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">A designated initializer for the DBExpression class, this initializes a freshly allocated DBExpression by setting its entity to <i>anEntity</i>, and creating a property object (owned by the DBExpression) that points to the property named by <i>aPropertyName</i>. The data type of the new property is set to <i>aType</i>, so that data retieved by this expression will be coerced to the indicated type.</font>

<p><font face="Times">Returns <b>self</b>, or <b>nil</b> if <i>anEntity</i> is <b>nil</b> or if the named property doesn't exist in the entity.</font>

<p><font face="Helvetica"><b>See also:</b></font>&nbsp; <img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times"><b>initForEntity:fromDescription:</b></font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica"><b>read:</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=124></td>

<td><img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times"><b>read:</b>(NXTypedStream *)<i>stream</i></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">Reads the DBExpression from the typed stream <i>stream</i>.&nbsp; Returns <b>self</b>.</font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica"><b>setEntity:andDescription:</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=124></td>

<td><img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times"><b>setEntity:</b>(id &lt;DBEntities&gt;)<i>anEntity</i></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=163></td>

<td><font face="Times"><b>andDescription:</b>(const unsigned char *)<i>descriptionFormat</i>, ...</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">Replaces the DBExpression's entity and description with those provided by the arguments.&nbsp; See the class description for more information on the format of the description string.</font>

<p><font face="Helvetica"><b>See also:</b></font>&nbsp; <img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times"><b>initForEntity:fromDescription:</b></font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica"><b>write:</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=124></td>

<td><img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times"><b>write:</b>(NXTypedStream *)<i>stream</i></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">Writes the DBExpression to the typed stream <i>stream</i>.&nbsp; Returns <b>self</b>.</font></td></tr>

</table>



<p><br>

</body>
</html>
