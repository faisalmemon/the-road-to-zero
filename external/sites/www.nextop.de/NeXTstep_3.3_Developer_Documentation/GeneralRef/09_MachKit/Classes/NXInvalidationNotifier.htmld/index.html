<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<!-- Created with LatinByrd III -->
<!-- File: /Apps/NextDev/GeneralRef/09_MachKit/Classes/NXInvalidationNotifier.rtf -->
<!-- Date: Sun Jun 28 20:06:21 1998 -->
<head>
<title>NXInvalidationNotifier</title>
</head>

<body bgcolor="#FFFFFF" text="#000000" link="#0000FF" alink="#FF00FF" vlink="#FF0000">

<basefont size=3>

<p><font face="Times" size="-1">Copyright</font> <font size="-1">&copy;</font><font face="Times" size="-1">1995 by NeXT Computer, Inc.&nbsp; All Rights Reserved.</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Helvetica" size="+2"><b>NXInvalidationNotifier</b></font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Helvetica"><b>Inherits From:</b></font></td>

<td><font face="Times">Object</font></td></tr>

<tr valign=top>

<td width=105 height=12></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Helvetica"><b>Conforms To:</b></font></td>

<td><font face="Times">NXReference</font></td></tr>

<tr valign=top>

<td width=105 height=12></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Helvetica"><b>Declared In:</b></font></td>

<td><font face="Times">machkit/NXInvalidationNotifier.h</font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=69></td>

<td><font face="Helvetica" size="+1"><b>Class Description</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">The NXInvalidationNotifier class is an abstract class that defines reference-counted objects that notify other objects when they become invalid.&nbsp; An NXInvalidationNotifier becomes invalid when no more references to it are held (all references have been given up by sending the object a <b>free</b> message).&nbsp; An NXInvalidationNotifier could also become invalid for other reasons; for example, an NXConnection object (which is a subclass of NXInvalidationNotifier) becomes invalid when its connection is broken.&nbsp; An invalid object usually exists for a short time after becoming invalid so it can clean up, but it shouldn't be treated as though it were fully usable.</font>

<p><font face="Times">Examples of NXInvalidationNotifier subclasses include NXConnection and NXPort.</font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=69></td>

<td><font face="Helvetica" size="+1"><b>Instance Variables</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">unsigned int <b>refcount</b>;</font>

<p><font face="Times">BOOL <b>isValid</b>;</font>

<p><font face="Times">NXLock *<b>listGate</b>;</font>

<p><font face="Times">List *<b>funeralList</b>;</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times">refcount</font></td>

<td><font face="Times">The object's reference count</font></td></tr>

<tr valign=top>

<td width=105 height=7></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times">isValid</font></td>

<td><font face="Times">YES if the object is valid</font></td></tr>

<tr valign=top>

<td width=105 height=7></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times">listGate</font></td>

<td><font face="Times">A lock to protect data structures</font></td></tr>

<tr valign=top>

<td width=105 height=7></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times">funeralList</font></td>

<td><font face="Times">A list of objects to be notified upon invalidation</font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=69></td>

<td><font face="Helvetica" size="+1"><b>Adopted Protocols</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times">NXReference</font></td>

<td><img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times">addReference</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=306></td>

<td><img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times">free</font><br>
<img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times">references</font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=69></td>

<td><font face="Helvetica" size="+1"><b>Method Types</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times">Initializing a new object</font></td>

<td><img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times">init</font></td></tr>

<tr valign=top>

<td width=105 height=7></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times">Really freeing an object</font></td>

<td><img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times">deallocate</font></td></tr>

<tr valign=top>

<td width=105 height=7></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times">Getting and setting validity</font></td>

<td><img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times">invalidate</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=306></td>

<td><img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times">isValid</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times">Registering for notification</font></td>

<td><img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times">registerForInvalidationNotification:</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=306></td>

<td><img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times">unregisterForInvalidationNotification:</font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=69></td>

<td><font face="Helvetica" size="+1"><b>Instance Methods</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica"><b>deallocate</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=124></td>

<td><img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times"><b>deallocate</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">Deallocates the object's storage, freeing the object regardless of its reference count.&nbsp; A subclass of NXInvalidationNotifier should generally invoke this method from within its implementation of <b>free</b> when no more references are held to ensure normal freeing behavior.</font>

<p><font face="Helvetica"><b>See also:</b></font>&nbsp; <img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times"><b>free</b></font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica"><b>free</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=124></td>

<td><img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times"><b>free</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">Decrements the reference count of the object, marking the object invalid, sending invalidation notifications, and returning <b>nil</b> if no more references to the object are held.&nbsp; If references are still held, this method returns <b>self</b>.&nbsp; Unlike the <b>free</b> method for most classes, this method <i>never</i> deallocates the object's storage.&nbsp; (In other words, it never actually frees the object.)&nbsp; This means that the object still exists to receive messages after it becomes invalid due to freeing, which can be useful for objects that need to do some final housekeeping when no more references are held.&nbsp; Generally a subclass of NXInvalidationNotifier should implement a version of <b>free</b> that deallocates itself when no more references are held, with the result that <b>free</b> will properly deallocate the object as expected at the appropriate time.&nbsp; For example:</font></td></tr>

</table>

<p><img src="../../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">- free</font><br>
<img src="../../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">{</font><br>
<img src="../../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">id ret = [super free];</font><br>
<img src="../../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">if (ret) return self;</font><br>
<img src="../../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">// No more references held, do the required cleanup</font><br>
<img src="../../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">return [super deallocate];</font><br>
<img src="../../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">}</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Helvetica"><b>See also:</b></font>&nbsp; <img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times"><b>deallocate</b>,</font> <img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times"><b>invalidate</b></font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica"><b>init</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=124></td>

<td><img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times"><b>init</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">Initializes the receiver, a newly allocated NXInvalidationNotifier instance.&nbsp; Returns <b>self</b>.</font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica"><b>invalidate</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=124></td>

<td><img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times"><b>invalidate</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">Marks the object as invalid, which means that though the object exists, it's not completely functional and might not exist for long.&nbsp; Once an object becomes invalid, there is no way provided to make the object valid again, and it would be difficult to implement in a subclass in a thread-safe manner.&nbsp; This method sends a <b>senderIsInvalid:</b> message to every object that registered for invalidation notification, frees the <b>funeralList</b> (but not the objects in it), and returns <b>self</b>.</font>

<p><font face="Helvetica"><b>See also:</b></font>&nbsp; <img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times"><b>registerForInvalidationNotification:</b></font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica"><b>isValid</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=124></td>

<td><img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times">(BOOL)<b>isValid</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">Returns YES if the object is valid.&nbsp; Generally, invalid objects should be sent only messages that allow other objects to clean up and eliminate their use of the object.</font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica"><b>registerForInvalidationNotification:</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=124></td>

<td><img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times"><b>registerForInvalidationNotification:</b>(id &lt;NXSenderIsInvalid&gt;)<i>anObject</i></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">Registers <i>anObject</i> so that it will receive a <b>senderIsInvalid:</b> message when the receiver becomes invalid.&nbsp; An object might become invalid because it is about to be freed, because a Distributed Objects connection is broken, or for some other application-specific reason.&nbsp; Returns <b>self</b>.</font>

<p><font face="Helvetica"><b>See also:</b></font>&nbsp; <img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times"><b>invalidate</b>,</font> <img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times"><b>unregisterForInvalidationNotification:</b></font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica"><b>unregisterForInvalidationNotification:</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=124></td>

<td><img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times"><b>unregisterForInvalidationNotification:</b>(id &lt;NXSenderIsInvalid&gt;)<i>anObject</i></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">Removes <i>anObject</i> from the list of objects that are notified when the receiver becomes invalid; thus <i>anObject</i> won't be notified. Returns <b>self</b>.</font>

<p><font face="Helvetica"><b>See also:</b></font>&nbsp; <img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times"><b>registerForInvalidationNotification:</b></font></td></tr>

</table>



<p><br>

</body>
</html>
