<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<!-- Created with LatinByrd III -->
<!-- File: /Apps/NextDev/GeneralRef/16_Sound/Classes/NXPlayStream.rtf -->
<!-- Date: Sun Jun 28 20:06:51 1998 -->
<head>
<title>NXPlayStream</title>
</head>

<body bgcolor="#FFFFFF" text="#000000" link="#0000FF" alink="#FF00FF" vlink="#FF0000">

<basefont size=3>

<p><font face="Times" size="-1">Copyright</font> <font size="-1">&copy;</font><font face="Times" size="-1">1995 by NeXT Computer, Inc.&nbsp; All Rights Reserved.</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Helvetica" size="+2"><b>NXPlayStream</b></font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times">Inherits From:</font></td>

<td><font face="Times">NXSoundStream : Object</font></td></tr>

<tr valign=top>

<td width=105 height=12></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times">Declared In:</font></td>

<td><font face="Times">soundkit/NXPlayStream.h</font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=69></td>

<td><font face="Helvetica" size="+1"><b>Class Description</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">The NXPlayStream class defines methods that initiate and control sound playback.&nbsp; To play sounds with an NXPlayStream object, you must first connect it to an NXSoundOut object and then activate it; these tasks are done through the <b>initOnDevice: </b>and <b>activate</b> methods (as described in NXSoundStream).</font>

<p><font face="Times">Once it's connected and activated, an NXPlayStream will accept and play buffers of sound data.&nbsp; You supply it with these buffers through the <b>playBuffer:size:tag:</b> method.&nbsp; The enqueuing of buffers must be timely and constant--a gap in playback occurs if the underlying sound device isn't supplied with buffers quickly enough (it &quot;underruns&quot;).&nbsp; You can prevent this sort of underrun by using larger buffers; if you're playing a determinate amount of existing data, there's no loss in enqueuing the entire sound in one large buffer.&nbsp; Of course, this isn't possible if you're creating or controlling sound data dynamically; in particular, if you've set the size or number of DMA transfer buffers to yield a better response time (through messages to the NXSoundOut object), then the size of the buffers that you feed to the NXPlayStream should be no greater than DMA buffer size times the DMA buffer count.&nbsp; In any case, you should note that you don't have to wait for a stream buffer to play before enqueuing the next one.</font>

<p><font face="Times">The sound data in the buffers that you enqueue with an NXPlayStream can be one or two channels of 16-bit linear sound samples at either the 44.1 kHz or 22.05 kHz sampling rate.&nbsp; Sounds in other formats and sampling rates must be converted before they can be played through an NXPlayStream.</font>

<p><font face="Times">One of the features of an NXPlayStream is that it allows stream-independent amplitude scaling.&nbsp; Amplitude-scaling, or <i>gain</i>, is a (stereo) factor that's applied linearly to the left and right channels to increase or decrease the amplitude of a stream before it's mixed with the other coincident playback streams.&nbsp; The <b>setGainLeft:right:</b> method sets the left- and right-channel gain factors.</font>

<p><br><br>

<p><font face="Helvetica"><b>Error Codes</b></font>

<p><font face="Times">Many of the methods described here access underlying sound devices.&nbsp; Such methods return error codes that declare success or describe failure.&nbsp; A catalog of these error codes can be found in the section &quot;Types and Constants&quot; under the heading &quot;NXSoundDeviceError.&quot;</font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=69></td>

<td><font face="Helvetica" size="+1"><b>Instance Variables</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">None declared in this class.</font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=69></td>

<td><font face="Helvetica" size="+1"><b>Method Types</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times">Initializing an NXPlayStream</font></td>

<td><img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times">initOnDevice:</font></td></tr>

<tr valign=top>

<td width=105 height=7></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times">Activating and playing</font></td>

<td><img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times">activate</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=306></td>

<td><img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times">playBuffer:size:tag:</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times">Gain and peak detection</font></td>

<td><img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times">setGainLeft:right:</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=306></td>

<td><img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times">getGainLeft:right:</font><br>
<img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times">getPeakLeft:right:</font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=69></td>

<td><font face="Helvetica" size="+1"><b>Instance Methods</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica"><b>activate</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=124></td>

<td><img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times">(NXSoundDeviceError)<b>activate</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">Activates the NXPlayStream so it can be used to play sounds.&nbsp; This augments the superclass implementation by setting playback-specific attributes.&nbsp; Returns an error code.</font>

<p><font face="Times">See also:</font>&nbsp; <img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times"><b>activate</b> (NXSoundStream)</font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica"><b>getGainLeft:right:</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=124></td>

<td><img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times"><b>getGainLeft:</b>(float *)<i>leftScale</i> <b>right:</b>(float *)<i>rightScale</i></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">Returns, by reference in the arguments, the general scaling factors that are applied to the left and right channels of this NXPlayStream.&nbsp; By default, the gain in both channels is 1.0 (the sound is unmodified).&nbsp; Returns <b>self</b>.</font>

<p><font face="Times">See also:</font>&nbsp; <img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times"><b>setGainLeft:right:</b></font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica"><b>getPeakLeft:right:</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=124></td>

<td><img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times">(NXSoundDeviceError)<b>getPeakLeft:</b>(float *)<i>leftAmp</i> <b>right:</b>(float *)<i>rightAmp</i></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">Returns, by reference in the arguments, the most recently detected peak amplitudes for this NXPlayStream.&nbsp; The peak values are normalized to fall within (0.0, 1.0), where 0.0 is no amplitude and 1.0 is maximum amplitude.&nbsp; You typically set up a timed entry to invoke this method while sound is playing.</font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica"><b>initOnDevice:</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=124></td>

<td><img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times"><b>initOnDevice:</b><i>anObject</i></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">The designated initializer for NXPlayStream, this method invokes the superclass version of <b>initOnDevice:</b> and then sets the the gain in both channels to 1.0.</font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica"><b>playBuffer:size:tag:</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=124></td>

<td><img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times">(NXSoundDeviceError)<b>playBuffer:</b>(void *)<i>data</i></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=163></td>

<td><font face="Times"><b>size:</b>(unsigned int)<i>bytes</i></font><br>
<font face="Times"><b>tag:</b>(int)<i>aTag</i></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">Enqueues a buffer for playback. The arguments are as follows:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=124></td>

<td nowrap><font face="Helvetica"><b>Argument</b></font></td>

<td><font face="Helvetica"><b>Value</b></font></td></tr>

<tr valign=top>

<td width=124 height=4></td></tr>

<tr valign=top>

<td width=124></td>

<td nowrap><font face="Times"><i>data</i></font></td>

<td><font face="Times">A pointer to the buffer that you're enqueuing.</font></td></tr>

<tr valign=top>

<td width=124 height=9></td></tr>

<tr valign=top>

<td width=124></td>

<td nowrap><font face="Times"><i>bytes</i></font></td>

<td><font face="Times">The size of the buffer, in bytes</font></td></tr>

<tr valign=top>

<td width=124 height=9></td></tr>

<tr valign=top>

<td width=124></td>

<td nowrap><font face="Times"><i>aTag</i></font></td>

<td><font face="Times">A non-negative integer that's used to identify the buffer in</font><br>
<font face="Times">subsequent delegate messags.</font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica"><b>setGainLeft:right:</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=124></td>

<td><img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times">(NXSoundDeviceError)<b>setGainLeft:</b>(float)<i>leftAmp</i> <b>right:</b>(float)<i>rightAmp</i></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">Set the NXPlayStream's general gain.&nbsp; These gains are multiplied by the individual buffer gains (as set through <b>playBuffer:size:tag:</b>) to get the final amplitude gain for a particular buffer on this NXPlayStream.</font>

<p><font face="Times">See also:</font>&nbsp; <img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times"><b>getGainLeft:right:</b></font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=69></td>

<td><font face="Helvetica" size="+1"><b>Methods Implemented by the Delegate</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica"><b>soundStreamDidUnderrun:</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=124></td>

<td><img src="../../../Images/c2D.gif" width=8 height=4> <font face="Times"><b>soundStreamDidUnderrun:</b><i>sender</i></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">Invoked when the sound driver &quot;underruns,&quot; or can't transfer data to the sound hardware quickly enough.&nbsp; Underrun occurs if you're playing too many sounds at the same time, if the DMA transfer buffers are too small or too few, or if the overall system load is too high.&nbsp; It results in a gap in playback.</font></td></tr>

</table>



<p><br>

</body>
</html>
