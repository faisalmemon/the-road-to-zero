<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<!-- Created with LatinByrd III -->
<!-- File: /Apps/NextDev/OperatingSystem/Part3_DriverKit/Reference/Classes/IOTokenRing.rtf -->
<!-- Date: Sun Jun 28 20:11:42 1998 -->
<head>
<title>IOTokenRing</title>
</head>

<body bgcolor="#FFFFFF" text="#000000" link="#0000FF" alink="#FF00FF" vlink="#FF0000">

<basefont size=3>

<p><font face="Times" size="-1">Copyright</font> <font size="-1">&copy;</font><font face="Times" size="-1">1995 by NeXT Computer, Inc.&nbsp; All Rights Reserved.</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Helvetica" size="+2"><b>IOTokenRing</b></font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Helvetica"><b>Inherits From:</b></font></td>

<td><font face="Times">IODirectDevice : IODevice : Object</font></td></tr>

<tr valign=top>

<td width=105 height=12></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Helvetica"><b>Conforms To:</b></font></td>

<td><font face="Times">IONetworkDeviceMethods</font></td></tr>

<tr valign=top>

<td width=105 height=12></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Helvetica"><b>Declared In:</b></font></td>

<td><font face="Times">driverkit/IOTokenRing.h</font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=69></td>

<td><font face="Helvetica" size="+1"><b>Class Description</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">IOTokenRing is an abstract class for controlling Token Ring devices. It provides a framework for sending and receiving packets (also known as <i>frames</i>), handling interrupts, and setting and detecting timeouts. It also provides an IONetwork instance that connects the driver with the kernel networking subsystem, as well as an I/O thread from which most of the IOTokenRing instance methods are invoked. To write a Token Ring driver, you create a subclass of IOTokenRing.</font>

<p><br><br>

<p><font face="Helvetica"><b>Implementing a Subclass</b></font>

<p><font face="Times">Your subclass of IOTokenRing must do the following:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Implement <b>probe:</b> and <b>initFromDeviceDescription:</b>. These let your driver create instances of itself. The implementation of <b>probe:</b> should allocate an instance, if necessary, and invoke <b>initFromDeviceDescription:</b>. See the IODevice specification for more information on implementing <b>probe:</b>.</font></td></tr>

<tr valign=top>

<td width=105 height=9></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Implement <b>resetAndEnable:</b>, and <b>interruptOccurred</b>. (<b>interruptOccurred</b> is documented in the IODirectDevice specification.)</font></td></tr>

<tr valign=top>

<td width=105 height=9></td></tr>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times"><img src="../../../../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Implement either <b>transmit:</b> or <b>outputPacket:address:</b>.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Helvetica"><b>IONetwork Method Usage</b></font>

<p><font face="Times">When your driver invokes IONetwork's method <b>handleInputPacket:extra:</b> to hand off a packet to the kernel, it needs to pass a valid pointer to a tokenHeader_t <b>struct</b> as the <b>extra:</b> argument. Passing 0 for this argument (as ethernet drivers do) won't suffice.</font>

<p><br><br>

<p><font face="Helvetica"><b>IONetworkDeviceMethods Protocol Implementation</b></font>

<p><br><br>

<p><font face="Times">In IOEthernet's implementation, finishInitialization invokes resetAndEnable:YES if [self isRunning] == YES.</font>

<p><br><br>

<p><font face="Helvetica"><b>Recommended Reading</b></font>

<p><font face="Times">Besides the documentation for your hardware, see the references in the &quot;Network Drivers&quot; section of &quot;Suggested Reading&quot; in the Appendix to help you write a Token Ring driver.</font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=69></td>

<td><font face="Helvetica" size="+1"><b>Instance Variables</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">None declared in this class.</font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=69></td>

<td><font face="Helvetica" size="+1"><b>Adopted Protocols</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times">IONetworkDeviceMethods</font></td>

<td><img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times">allocateNetbuf</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=306></td>

<td><img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times">finishInitialization</font><br>
<img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times">outputPacket:address:</font><br>
<img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times">performCommand:data:</font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=69></td>

<td><font face="Helvetica" size="+1"><b>Method Types</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">Creating and destroying IOTokenRing instances</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=306></td>

<td><img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times">free</font><br>
<img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times">initFromDeviceDescription:</font><br>
<img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times">attachToNetworkWithAddress:</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td nowrap><font face="Times">Transmitting packets</font></td>

<td><img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times">transmit:</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">Setting and handling hardware timeouts</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=306></td>

<td><img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times">setRelativeTimeout:</font><br>
<img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times">relativeTimeout</font><br>
<img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times">clearTimeout</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">Setting and getting the state of the hardware</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=306></td>

<td><img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times">setRunning:</font><br>
<img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times">isRunning</font><br>
<img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times">resetAndEnable:</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">Setting and getting maximum sizes</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=306></td>

<td><img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times">setMaxInfoFieldSize:</font><br>
<img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times">maxInfoFieldSize</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Times">Getting other configuration information</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=306></td>

<td><img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times">earlyTokenEnabled</font><br>
<img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times">nodeAddress</font><br>
<img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times">ringSpeed</font><br>
<img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times">shouldAutoRecover</font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=69></td>

<td><font face="Helvetica" size="+1"><b>Instance Methods</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica"><b>attachToNetworkWithAddress:</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=124></td>

<td><img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times">(IONetwork *)<b>attachToNetworkWithAddress:</b>(token_addr_t)<i>address</i></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">Invokes <b>registerDevice</b>, sets the node address to <i>address</i>, creates an IONetwork instance, and attaches to the network subsystem by sending the IONetwork an <b>initForNetworkDevice:...</b> message. Besides starting up the IP protocol stack for the device, this method also starts up an 802.2-compliant Null SAP interface. Finally, this method logs a message stating the node address. Returns the IONetwork instance just created.</font>

<p><font face="Times">To determine the value to specify for <i>address</i>, first invoke <b>nodeAddress</b>. If <b>nodeAddress</b> returns a nonzero value, use that value. Otherwise, use the hardware's burnt-in address.</font>

<p><font face="Times">You invoke this method at the end of your implementation of <b>initFromDeviceDescription:</b>. You must invoke <b>resetAndEnable:NO</b> before invoking this method, as described under <b>initFromDeviceDescription:</b>, later in this specification.</font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica"><b>clearTimeout</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=124></td>

<td><img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times">(void)<b>clearTimeout</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">If a transmission timeout is scheduled, unschedules the timeout. This method is normally invoked from a subclass's implementation of <b>interruptOccurred</b>.</font>

<p><font face="Helvetica"><b>See also:</b></font>&nbsp; <img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times"><b>setRelativeTimeout:</b>,</font> <img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times"><b>relativeTimeout</b></font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica"><b>earlyTokenEnabled</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=124></td>

<td><img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times">(BOOL)<b>earlyTokenEnabled</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">Returns YES if Early Token Release (ETR) is supported by the station; otherwise, returns NO. Stations that support ETR can co-exist with non-ETR stations in the ring. The value returned by this method is set by <b>initFromDeviceDescription:</b>.</font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica"><b>free</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=124></td>

<td><img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times"><b>free</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">Frees the IOTokenRing instance and its resources and returns <b>nil</b>.</font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica"><b>initFromDeviceDescription:</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=124></td>

<td><img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times"><b>initFromDeviceDescription:</b>(IODeviceDescription *)<i>devDesc</i></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">Invokes the superclass implementation, starts an I/O thread (using <b>startIOThread</b>), and sets the device name, kind, and unit.</font>

<p><font face="Times">Next, it examines the device configuration table for such parameters as ring speed and early token enablement. It then sets the maximum packet size, based on the ring speed. If the ring speed is 4 megabits per second, the maximum info field size is MAC_INFO_4MB. If the ring speed is 16, the maximum info field size is MAC_INFO_16MB. (The maximum packet size is the maximum info field size plus MAC_HDR_MAX.) These constants are defined in the header file <b>bsd/net/tokendefs.h</b>.</font>

<p><font face="Times">Subclasses of IOTokenRing should implement this method so that it invokes the superclass version of <b>initFromDeviceDescription:</b>, makes sure the configuration is correct, invokes <b>setMaxInfoFieldSize:</b>, does any other device-specific software and hardware initialization, and invokes <b>attachToNetworkWithAddress:</b>.</font>

<p><font face="Times">This method should free the instance and return <b>nil</b> on failure; otherwise, it should return <b>self</b>. A rough example of implementing this method is below.</font></td></tr>

</table>

<p><img src="../../../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">- initFromDeviceDescription:(IODeviceDescription *)devDesc</font><br>
<img src="../../../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">{</font><br>
<img src="../../../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">if([super initFromDeviceDescription:devDesc] == nil)</font><br>
<img src="../../../../Images/sp.gif" width=180 height=1><font face="Courier" size="-1">return nil;</font>

<p><img src="../../../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1"><i>/* Perform any 1-time hardware initialization. */</i></font>

<p><img src="../../../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">/* Finish initializing the hardware. */</font><br>
<img src="../../../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">[self resetAndEnable:NO];</font>

<p><img src="../../../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1"><i>/* Do any additional software initialization; set the max info</i></font><br>
<img src="../../../../Images/sp.gif" width=159 height=1><font face="Courier" size="-1"><i>* field size; get the node address (as described in the</i></font><br>
<img src="../../../../Images/sp.gif" width=159 height=1><font face="Courier" size="-1"><i>* documentation of attachToNetworkWithAddress: */</i></font>

<p><img src="../../../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">IOLog(&#34;%s: Token-Ring at port=%x irq=%d dma=%d speed=%d\n&#34;,</font><br>
<img src="../../../../Images/sp.gif" width=180 height=1><font face="Courier" size="-1">[self name], base, myIrq, myDmaChan, [self ringSpeed]);</font>

<p><img src="../../../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">network = [super attachToNetworkWithAddress:myNodeAddress];</font><br>
<img src="../../../../Images/sp.gif" width=152 height=1><font face="Courier" size="-1">return self;</font><br>
<img src="../../../../Images/sp.gif" width=124 height=1><font face="Courier" size="-1">}</font>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica"><b>isRunning</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=124></td>

<td><img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times">(BOOL)<b>isRunning</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">Returns YES if the hardware is currently inserted in the ring; otherwise, returns NO.</font>

<p><font face="Helvetica"><b>See also:</b></font>&nbsp; <img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times">s<b>etRunning:</b></font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica"><b>maxInfoFieldSize</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=124></td>

<td><img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times">(unsigned int)<b>maxInfoFieldSize</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">Returns the maximum size of the info field. This value is used by <b>allocateNetbuf</b>. It's also used as the maximum transfer unit specified to the network subsystem.</font>

<p><font face="Helvetica"><b>See also:</b></font>&nbsp; <img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times"><b>setMaxInfoFieldSize:</b></font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica"><b>nodeAddress</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=124></td>

<td><img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times">(token_addr_t)<b>nodeAddress</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">Returns the node address for this station. Currently, only burnt-in addresses are supported. In the future, however, IOTokenRing will be able to initialize the node address from the device configuration table. The value returned by this method is set by <b>attachToNetworkWithAddress:</b>.</font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica"><b>relativeTimeout</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=124></td>

<td><img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times">(unsigned int)<b>relativeTimeout</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">Returns the number of milliseconds until a transmission timeout will occur. If no transmission timeout is currently scheduled, this method returns zero.</font>

<p><font face="Helvetica"><b>See also:</b></font>&nbsp; <img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times"><b>clearTimeout</b>,</font> <img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times"><b>setRelativeTimeout:</b></font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica"><b>resetAndEnable:</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=124></td>

<td><img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times">(BOOL)<b>resetAndEnable:</b>(BOOL)<i>enable</i></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">Does nothing and returns YES. Subclasses of IOTokenRing must implement this method so that it resets and initializes the hardware. This method should invoke <b>setRunning:</b> to record the basic state of the device.</font>

<p><font face="Times">If <i>enable</i> is YES and the station is already in the ring, this method should do nothing but invoke <b>setRunning:</b> with a YES argument and return YES. If <i>enable</i> is YES and the station isn't in the ring, interrupts should be enabled and the station inserted in the ring; <b>setRunning:</b> should be used to update the device running status to YES or NO, depending on the success of the insertion. If <i>enable</i> is NO, interrupts should be left disabled, the station should be removed from the ring, and <b>setRunning: </b>should be invoked with a NO argument.</font>

<p><font face="Times">This method should return YES if it encounters no errors (no matter what value <i>enable</i> has); if it encounters errors, it should return NO. For example, the result from <b>resetAndEnable:NO</b> should be YES if the reset is successful.</font>

<p><font face="Times">The only time this method is invoked, with the exception of any invocations from your IOTokenRing subclass implementation, is during initialization. Specifically, <b>resetAndEnable:YES</b> is invoked once in the I/O thread after <b>attachToNetworkWithAddress:</b> is invoked.</font>

<p><font face="Helvetica"><b>See also:</b></font>&nbsp; <img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times"><b>setRunning:</b></font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica"><b>ringSpeed</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=124></td>

<td><img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times">(unsigned int)<b>ringSpeed</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">Returns the speed of the Token Ring, in megabits per second. This value, which is either 4 or 16, is set to the amount specified by the &quot;Ring Speed&quot; key in the device configuration table. If the value is missing or invalid, the ring speed is set to 16.</font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica"><b>setMaxInfoFieldSize:</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=124></td>

<td><img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times">(void)<b>setMaxInfoFieldSize:</b>(unsigned int)<i>size</i></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">Sets the maximum size of the info field. This value is used by <b>allocateNetbuf</b>. It's also used as the maximum transfer unit specified to the network subsystem. Your subclass should invoke this method in its implementation of <b>initFromDeviceDescription:</b>.</font>

<p><font face="Helvetica"><b>See also:</b></font>&nbsp; <img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times"><b>maxInfoFieldSize</b></font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica"><b>setRelativeTimeout:</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=124></td>

<td><img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times">(void)<b>setRelativeTimeout:</b>(unsigned int)<i>timeout</i></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">Schedules a timeout to occur in <i>timeout</i> milliseconds. When <i>timeout</i> milliseconds pass without the timeout being cleared (with <b>clearTimeout</b>), <b>timeoutOccurred</b> is invoked.</font>

<p><font face="Helvetica"><b>See also:</b></font>&nbsp; <img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times"><b>clearTimeout</b>,</font> <img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times"><b>relativeTimeout</b>,</font> <img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times"><b>timeoutOccurred</b> (IODirectDevice)</font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica"><b>setRunning:</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=124></td>

<td><img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times">(void)<b>setRunning:</b>(BOOL)<i>running</i></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">Sets whether the hardware is inserted into the ring. The value of <i>running</i> should be YES to indicate that the hardware is inserted; otherwise, it should be NO. This method is invoked only by methods in IOTokenRing subclasses--not by IOTokenRing's own method implementations. You should invoke this method in your implementation of <b>resetAndEnable:</b>.</font>

<p><font face="Helvetica"><b>See also:</b></font>&nbsp; <img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times"><b>isRunning</b></font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica"><b>shouldAutoRecover</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=124></td>

<td><img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times">(BOOL)<b>shouldAutoRecover</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">Returns YES if the device should try to recover from a failed attempt at inserting itself into the ring or from an unexpected removal from the ring; otherwise, returns NO. IOTokenRing sets this value depending on the value of the &quot;Auto Recovery&quot; key in the device configuration table. This method is provided as a convenience for IOTokenRing subclasses that support automatic recovery.</font></td></tr>

</table>

<p><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=105></td>

<td><font face="Helvetica"><b>transmit:</b></font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=124></td>

<td><img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times">(void)<b>transmit:</b>(netbuf_t)<i>packet</i></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=106></td>

<td><font face="Times">Does nothing except free <i>packet</i>, using the <b>nb_free()</b> function. This method is invoked by the kernel networking subsystem when the hardware should transmit a packet.</font>

<p><font face="Times">Subclasses of IOTokenRing can implement this method or they can reimplement the method that invokes it: <b>outputPacket:address:</b>.&nbsp;&nbsp; To determine the number of bytes of data to be transmitted, use the <b>nb_size()</b> function. To get a pointer to the data, use <b>nb_map()</b>. After getting the information you need from <i>packet</i>, you should free it with <b>nb_free()</b>.</font>

<p><font face="Helvetica"><b>See also:</b></font>&nbsp; <img src="../../../../Images/c2D.gif" width=8 height=4> <font face="Times"><b>outputPacket:address:</b> (IONetworkDeviceMethods protocol)</font></td></tr>

</table>



<p>

</body>
</html>
