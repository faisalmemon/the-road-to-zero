<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<!-- Created with LatinByrd III -->
<!-- File: /Apps/NextDev/ReleaseNotes/AppKit.rtf -->
<!-- Date: Sun Jun 28 20:13:12 1998 -->
<head>
<title>AppKit</title>
</head>

<body bgcolor="#FFFFFF" text="#000000" link="#0000FF" alink="#FF00FF" vlink="#FF0000">

<basefont size=3>

<p><font face="Times" size="-1">Release 3.3&nbsp; Copyright</font> <font size="-1">&copy;</font><font face="Times" size="-1">1995 by NeXT Computer, Inc.&nbsp; All Rights Reserved.</font>

<p><br><br><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td><font face="Times" size="+1">3.3 Release Notes:</font><br>
<font face="Times" size="+1">Application Kit</font>

<p><br><br>

<p><font face="Times">This file contains developer release notes for the 3.3, 3.2, 3.1, and 3.0 releases of the Application Kit.&nbsp; Items specific to or introduced in Release 3.2 are listed first, followed by the 3.1 and 3.0 notes.&nbsp; Some user-visible changes to the application architecture have been moved to <b>/NextLibrary/Documentation/NextAdmin/ReleaseNotes/AppBehavior.rtf</b>.</font></td></tr>

</table>

<p><br><br><br><br>

<p><img src="../Images/sp.gif" width=4 height=1><font face="Times" size="+1"><b>Notes Specific to Release 3.2</b></font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=36></td>

<td><font face="Times"><b>Known Bugs</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td><font face="Times"><b>NXRunAlertPanel</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">In all 3.X releases <b>NXRunAlertPanel</b> incorrectly tries to localize the arguments it receives.&nbsp; If one of these arguments is not found as a key in the localization string table, the system retains a reference to that pointer and uses it as the localized value.&nbsp; This results in the correct display, but if that argument is later freed or modified, the application gets hashtable error messages or crashes.&nbsp; The workaround is to be sure that you call this function with strings that you know will not change.&nbsp; Use either literal strings or make copies of dynamically created strings that may change later.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td><font face="Times"><b>Text Delegate Methods</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">Before the Text object sends the delegate method <b>textWillStartReadingRichText:</b>, it checks to see if its delegate responds to it. Unfortunately, the text object checks to see if the delegate responds to a method named <b>textWillStartReadingRichText:text:runs:</b>; thus, the delegate method, even though it might be implemented, is never invoked. The same bug exists with <b>textWillFinishReadingRichText:</b>.</font>

<p><font face="Times">If you would like to respond to these delegate methods, implement the following stub methods in your delegate:</font>

<p><img src="../Images/sp.gif" width=18 height=1><font face="Times">- <b>textWillFinishReadingRichText:</b><i>obj</i> <b>text:</b>(void *)<i>text</i> <b>runs:</b>(void *)<i>runs</i></font><br>
<img src="../Images/sp.gif" width=18 height=1><font face="Times">- <b>textWillStartReadingRichText:</b><i>obj</i> <b>text:</b>(void *)<i>text</i> <b>runs:</b>(void *)<i>runs</i></font>

<p><font face="Times">These methods will never be invoked; so all they need to do is <b>return self</b>.</font>

<p><font face="Times">This bug exists in the 3.0 and 3.1 releases as well.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td><font face="Times"><b>NXHelpPanel</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">If additional help is located in a directory other than YourProject/English.lproj/Help, and that help is to be loaded with the NXHelpPanel method, &#34;<b>addSupplement:inPath:</b>&#34;, the help directory must not be compressed (i.e. do not invoke the &#34;compresshelp&#34; utility on it).</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td><font face="Times"><b>NXJournaler</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">Earlier versions of the documentation implied that journal recording could be made non-abortable by or'ing in the <b>NX_NONABORTABLEMASK</b> flag when calling the </font><font face="Helvetica"><b>setEventStatus:soundStatus:eventStream:soundfile</b></font> <font face="Times">method.&nbsp; This was incorrect.&nbsp; In earlier versions, if this flag was included journal recording would not work.&nbsp; In the 3.2 version, this flag will simply be ignored if the request is for journal recording.&nbsp; If the request is for journal playback, the flag will be accepted and will work as it has in the past.</font></td></tr>

</table>

<p><br><br><br>

<p><img src="../Images/sp.gif" width=4 height=1><font face="Times" size="+1"><b>Notes Specific to Release 3.1</b></font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=36></td>

<td><font face="Times"><b>New Methods</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td><font face="Times">- <b>ignoreModifierKeysWhileDragging</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">This method has been added to the NXDraggingSource informal protocol.&nbsp; (This protocol is implemented by the object that supplies an image that can be dragged from one window to another, the source object passed as an argument in the <b>dragImage:</b>... message that initiates a dragging session.)&nbsp; If <b>ignoreModifierKeysWhileDragging</b> is implemented to return YES, the modifier keys held down by the user will not cause the cursor to change (to the link or copy cursor, for example), nor will they be used when deciding whether to allow the operation.</font>

<p><font face="Times">An application can use this method when implementing the dragging of private data types (e.g., patterns).&nbsp; The benefit is that the cursor will not switch to the copy or link cursor when the user applies the modifier keys, but the operation can still succeed and the application can apply its own semantics to the use of the modifiers.&nbsp; This method existed undocumented in 3.0, and is invoked under that release as well.</font>

<p><font face="Times">This method should never return YES when the user drags a file (when the data is NXFilenamePboardType), since files can be dragged between applications.&nbsp; The modifier keys have well-defined meanings in the user interface for dragging files.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td><font face="Times">- (BOOL)<b>getMountedRemovableMedia:</b>(char **)<i>mountedMediaPathnames</i></font><br>
<font face="Times">- (BOOL)<b>mountNewRemovableMedia:</b>(char **)<i>newlyMountedPathnames</i></font><br>
<font face="Times">- (void)<b>checkForRemovableMedia</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">These methods have been added to the NXWorkspaceRequestProtocol formal protocol, which is implemented by the object returned by the NXApp's <b>workspace</b> method. When an application is ready to let the user access files that might be on a removable disk (for example, when it puts up a custom Open panel), it can use these methods to get a list of currently mounted removable devices, and mount new devices if necessary.</font>

<p><font face="Times"><b>getMountedRemovableMedia:</b> fills in <i>mountedMediaPathnames</i> with a zero-terminated tab-separated list of full pathnames to all currently mounted removable media.&nbsp; It returns YES if it was successful in filling in <i>mountedMediaPathnames</i> and NO otherwise.</font>

<p><font face="Times">On systems that don't send an interrupt or other notification that a disk has been inserted, an application must invoke either <b>mountNewRemovableMedia:</b> or <b>checkForRemovableMedia</b> before invoking <b>getMountedRemovableMedia:</b>.&nbsp; Both of these methods cause the Workspace Manager to poll the drives to see if a disk is present.&nbsp; If a disk has been inserted but not yet been mounted, these methods will cause the Workspace Manager to mount it.&nbsp; <b>mountNewRemovableMedia:</b> waits until the new disk has been mounted and then fills in&nbsp; <i>newlyMountedPathnames</i> with a zero-terminated tab-separated list of full pathnames to all newly mounted disks.&nbsp; It returns YES if it was successful in filling in <i>newlyMountedPathnames</i>, and NO otherwise.&nbsp; <b>checkForRemovableMedia</b> does not wait until the new disk is mounted; instead, it asks the Workspace Manager to mount the disk asynchronously and returns immediately.</font>

<p><font face="Times">These methods are new in 3.1, and your application will crash if you try to use them on a 3.0 system.&nbsp; Therefore, before you send them you should test whether the object returned by <b>[NXApp workspace]</b> responds to these methods with <b>respondsTo:</b>.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=36></td>

<td><font face="Times"><b>Semantic Changes</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td><font face="Times"><b>Secure Ports</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">In 3.0, a change was made so that, unless the user enabled the Public Window Server preference, the ports of Listener objects were registered securely (i.e., under modified names).&nbsp; This allowed applications launched by the user on the same machine to communicate with each other, but prevented other machines on the network from looking up their ports&nbsp; Because this caused problems for some existing applications that need to rendezvous over the network, the Listener class has been changed in 3.1 to register ports securely only for applications built under Release 3.0 or later. Applications built under Releases 1 or 2 will have their ports registered under the plain port name given the Listener.</font>

<p><font face="Times">Users who wish to force pre-3.0 applications to register their ports securely may set the <b>NXSecureAppListenerPorts</b> default to YES.&nbsp; This default may be set for particular applications or for all applications by specifying &#34;GLOBAL&#34; as the application name.</font>

<p><font face="Times">If a 3.0 application wishes to publish a port under a nonsecure name for intermachine use, it should override the Listener's <b>checkInAs:</b> method and publish the port under an unprotected name using <b>netname_check_in()</b>.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td><font face="Times"><b>NXColors</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">Release 3.1 continues the change in direction for NXColors begun in Release 3.0. Under 2.0, all colors were device dependent, and there were no named colors (such as PANTONE).&nbsp; Under 3.0 and 3.1, NXColors can basically be in one of three flavors:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Device dependent, such as CMYK,</font></td></tr>

<tr valign=top>

<td width=90></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Device independent, such as RGB, HSB, or grayscale, and</font></td></tr>

<tr valign=top>

<td width=90></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Named, such as PANTONE.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">Colors in the last category come with lookup tables to provide the ability to generate the correct color (CMYK, RGB, or whatever) on a given device.</font>

<p><font face="Times">This change means that colors that look the same on a device (such as the screen) might look different on another device (such as the printer).&nbsp; Thus, freely converting an NXColor from one type to another without regard to how the user chose it (from the color panel) might produce undesirable results on certain devices, or cause the application to discard certain aspects of the color (its device dependence or independence, its name, etc).</font>

<p><font face="Times">In line with this change in direction, Release 3.1 makes these specific modification:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">In 3.1, <b>NXEqualColor()</b> will return YES if and only if the two colors will produce the same results on any printer. This means that a color created from CMYK components is not equal to a color created from RGB components, as the former is device dependent and the latter is device independent. Similarly, a PANTONE color is never equal to a color created from CMYK or RGB components.</font></td></tr>

<tr valign=top>

<td width=90 height=17></td></tr>

<tr valign=top>

<td width=90></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Under 3.0, functions such as <b>NXConvertColorToCMYK()</b> and <b>NXYellowComponent()</b> reported the CMYK components of PANTONE colors by simply converting the screen color (specified in RGB) to CMYK. The results were not satisfying to users, as they lacked the K component and the CMY components were meaningless.</font></td></tr>

<tr valign=top>

<td width=90 height=17></td></tr>

<tr valign=top>

<td width=90></td>

<td nowrap></td>

<td><font face="Times">Under 3.1, when an NXColor is asked for its CMYK color components (if it doesn't record them directly), it will first attempt to get or compute them before resorting to the simple-minded conversion between its own color components and the desired ones.&nbsp; This means that if a PANTONE (or other named) color is asked for its CMYK components, the values will be obtained from the DefaultCMYK device table. This feature can be disabled by setting the value of the <b>NXSmartNamedColorConversion</b> default to NO.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">Under 3.1, developers may wish to test their applications with the <b>NXCMYKAdjust </b>default enabled (as described above), and assure that the application behaves reasonably both on the screen and on the printer.&nbsp; This will help verify that the application uses NXColors and the Color panel correctly.&nbsp; Note that when CMYK adjustment is enabled, the algorithms that convert between RGB and CMYK components of a color also change; they return values that match the way the colors appear on the screen.&nbsp; This could be an area of trouble in some applications.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=36></td>

<td><font face="Times"><b>Other Changes</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td><font face="Times"><b>New Utility</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">A new utility called <b>compresshelp</b> has been released in the <b>/usr/bin</b> directory.&nbsp; If you are using the NeXT Help System, and have one or more help directories in your project, this utility can be used to compress the files in those directories into one file called <i>DirectoryName</i><b>.store</b>.&nbsp; In the case of the default Help directory (named &#34;Help&#34;), a file called <b>Help.store</b> will be created.&nbsp; When Help is invoked for your application, the Help system will first look for a <b>Help</b> directory and then for a&nbsp; <b>Help.store</b> file.&nbsp; By default a <b>Help.store</b> file, and not a <b>Help</b> directory will be placed in your *<b>.app</b>.</font>

<p><font face="Times">The <b>.store</b> file created by <b>compresshelp</b> will contain <b>only</b> files found in the <b>Help </b>directory which have a <b>.rtf</b>, <b>.rtfd</b>, <b>.tiff</b>, or <b>.eps</b> extension.&nbsp; <b>compresshelp</b> will warn you about files it has skipped.</font>

<p><font face="Times">By default <b>compresshelp</b> will create a compressed output file named <i>DirectoryName</i><b>.store</b>.&nbsp; However if the &#34;-o OutputFileName&#34; option is specified, the compressed help will be placed in a file named <i>OutputFileName</i><b>.store.</b></font>

<p><font face="Times">Typically you will not need to invoke this utility directly, as it is invoked automatically by the Makefiles supplied by Project Builder for default help directory, named <b>Help</b>.&nbsp; If you have other help directories, and you want them to be compressed, you will have to explicitly invoke this utility in your Makefile.postamble.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td><font face="Times"><b>Trapping Illegal Floating Point Operations</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">A new default named <b>NXTrapIllegalFloatingPointOps</b> has been added to allow catching illegal IEEE floating point operations. These operations include dividing 0 by 0, invalid comparisons to NaN, and converting out-of-range floating point numbers to integral values. Running with this default set to YES enables the trap:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1"><i>appname.app/appname</i> -NXTrapIllegalFloatingPointOps YES</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">If your application performs an illegal operation, a floating exception will be raised and the application will crash, allowing you to debug the problem. Given that the results of most invalid floating point operations are machine-dependent, using this default may help you chase down floating-point related problems encountered while porting between architectures. Don't leave this default enabled except when debugging.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=36></td>

<td><font face="Times"><b>Bug Fixes</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td><font face="Times">The following bugs are among those that have been fixed in the 3.1 version of the Application Kit:</font>

<p><font face="Times"><b>Developer Bugs</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=97></td>

<td nowrap><font face="Helvetica" size="-2">Reference</font></td>

<td><font face="Times">20657</font></td></tr>

<tr valign=top>

<td width=97 height=10></td></tr>

<tr valign=top>

<td width=97></td>

<td nowrap><font face="Helvetica" size="-2">Problem</font></td>

<td><font face="Times">When the user changed the update mode of a data link to &#34;continuous,&#34; an out-of-date link would not immediately update.</font></td></tr>

<tr valign=top>

<td width=97 height=10></td></tr>

<tr valign=top>

<td width=97></td>

<td nowrap><font face="Helvetica" size="-2">Description</font></td>

<td><font face="Times">Users expect &#34;continuous&#34; data links to be &#34;in sync&#34; with the source data.&nbsp; In 3.1,&nbsp; when the update mode is changed to &#34;continuous,&#34; the system immediately checks whether the data is current, and if&nbsp; not, updates it.</font></td></tr>

<tr valign=top>

<td width=97 height=36></td></tr>

<tr valign=top>

<td width=97></td>

<td nowrap><font face="Helvetica" size="-2">Reference</font></td>

<td><font face="Times">29821</font></td></tr>

<tr valign=top>

<td width=97 height=10></td></tr>

<tr valign=top>

<td width=97></td>

<td nowrap><font face="Helvetica" size="-2">Problem</font></td>

<td><font face="Times">Filter services weren't executed with the full path.</font></td></tr>

<tr valign=top>

<td width=97 height=10></td></tr>

<tr valign=top>

<td width=97></td>

<td nowrap><font face="Helvetica" size="-2">Description</font></td>

<td><font face="Times">The Application Kit invoked filter services using only the application name, not the full pathname.&nbsp; Some filter services expected the full path name.&nbsp; In 3.1, the Kit executes all filter services with the full pathname.</font></td></tr>

<tr valign=top>

<td width=97 height=35></td></tr>

<tr valign=top>

<td width=97></td>

<td nowrap><font face="Helvetica" size="-2">Reference</font></td>

<td><font face="Times">29866</font></td></tr>

<tr valign=top>

<td width=97 height=10></td></tr>

<tr valign=top>

<td width=97></td>

<td nowrap><font face="Helvetica" size="-2">Problem</font></td>

<td><font face="Times">Data links with a &#34;continuous&#34; update mode would not update when changes made to the source document were reverted.</font></td></tr>

<tr valign=top>

<td width=97 height=10></td></tr>

<tr valign=top>

<td width=97></td>

<td nowrap><font face="Helvetica" size="-2">Description</font></td>

<td><font face="Times">A &#34;continuous&#34; data link should ask the source document for new data when changes made to the document are undone.&nbsp; In Release 3.1, it does.</font></td></tr>

<tr valign=top>

<td width=97 height=35></td></tr>

<tr valign=top>

<td width=97></td>

<td nowrap><font face="Helvetica" size="-2">Reference</font></td>

<td><font face="Times">30009</font></td></tr>

<tr valign=top>

<td width=97 height=10></td></tr>

<tr valign=top>

<td width=97></td>

<td nowrap><font face="Helvetica" size="-2">Problem</font></td>

<td><font face="Times">The frames that outline linked data in response to the Show Links command were not drawn correctly in scaled coordinates.</font></td></tr>

<tr valign=top>

<td width=97 height=10></td></tr>

<tr valign=top>

<td width=97></td>

<td nowrap><font face="Helvetica" size="-2">Description</font></td>

<td><font face="Times">Corrected in 3.1.</font></td></tr>

<tr valign=top>

<td width=97 height=29></td></tr>

<tr valign=top>

<td width=97></td>

<td nowrap><font face="Helvetica" size="-2">Reference</font></td>

<td><font face="Times">30234</font></td></tr>

<tr valign=top>

<td width=97 height=10></td></tr>

<tr valign=top>

<td width=97></td>

<td nowrap><font face="Helvetica" size="-2">Problem</font></td>

<td><font face="Times"><b>fileOperationCompleted:</b> methods were not being invoked.</font></td></tr>

<tr valign=top>

<td width=97 height=10></td></tr>

<tr valign=top>

<td width=97></td>

<td nowrap><font face="Helvetica" size="-2">Description</font></td>

<td><font face="Times">When requested to perform a file operation, the Workspace Manager might choose to do it asynchronously.&nbsp; If so, the Application object's delegate is supposed to receive a <b>fileOperationCompleted:</b> message notifying it that the operation was accomplished.&nbsp; In 3.0, the message wasn't getting through.</font></td></tr>

<tr valign=top>

<td width=97 height=35></td></tr>

<tr valign=top>

<td width=97></td>

<td nowrap><font face="Helvetica" size="-2">Reference</font></td>

<td><font face="Times">30393</font></td></tr>

<tr valign=top>

<td width=97 height=10></td></tr>

<tr valign=top>

<td width=97></td>

<td nowrap><font face="Helvetica" size="-2">Problem</font></td>

<td><font face="Times">Some NXCachedImageRep objects would generate an error when archived.</font></td></tr>

<tr valign=top>

<td width=97 height=10></td></tr>

<tr valign=top>

<td width=97></td>

<td nowrap><font face="Helvetica" size="-2">Description</font></td>

<td><font face="Times">The <b>NXSizeBitmap()</b> function was incorrectly calculating the size of some images.</font></td></tr>

<tr valign=top>

<td width=97 height=35></td></tr>

<tr valign=top>

<td width=97></td>

<td nowrap><font face="Helvetica" size="-2">Reference</font></td>

<td><font face="Times">30694</font></td></tr>

<tr valign=top>

<td width=97 height=10></td></tr>

<tr valign=top>

<td width=97></td>

<td nowrap><font face="Helvetica" size="-2">Problem</font></td>

<td><font face="Times">The data links mechanism strips the <b>/private</b> prefix on pathnames, sometimes resulting in invalid paths.</font></td></tr>

<tr valign=top>

<td width=97 height=10></td></tr>

<tr valign=top>

<td width=97></td>

<td nowrap><font face="Helvetica" size="-2">Description</font></td>

<td><font face="Times">Removing <b>/private</b> from a pathname sometimes produces a bogus path, typically where the directory is <b>/private/tmp</b>.&nbsp; In 3.1, <b>/private</b> is stripped only where the result is a valid and equivalent path.</font></td></tr>

<tr valign=top>

<td width=97 height=35></td></tr>

<tr valign=top>

<td width=97></td>

<td nowrap><font face="Helvetica" size="-2">Reference</font></td>

<td><font face="Times">30807</font></td></tr>

<tr valign=top>

<td width=97 height=10></td></tr>

<tr valign=top>

<td width=97></td>

<td nowrap><font face="Helvetica" size="-2">Problem</font></td>

<td><font face="Times">It wasn't possible to read images from more than one Display PostScript context.</font></td></tr>

<tr valign=top>

<td width=97 height=10></td></tr>

<tr valign=top>

<td width=97></td>

<td nowrap><font face="Helvetica" size="-2">Description</font></td>

<td><font face="Times">After reading (getting bitmap data for) a rendered image--for example, by invoking NXBitmapImageRep's <b>initData:fromRect:</b> method--in one context, an application could not then read an image in a different context.&nbsp; The problem has been corrected.</font></td></tr>

<tr valign=top>

<td width=97 height=35></td></tr>

<tr valign=top>

<td width=97></td>

<td nowrap><font face="Helvetica" size="-2">Reference</font></td>

<td><font face="Times">31024</font></td></tr>

<tr valign=top>

<td width=97 height=10></td></tr>

<tr valign=top>

<td width=97></td>

<td nowrap><font face="Times" size="-2">Problem</font></td>

<td><font face="Times"><b>draggedImage:beganAt:</b> notifications were received before the dragged image was on-screen.</font></td></tr>

<tr valign=top>

<td width=97 height=10></td></tr>

<tr valign=top>

<td width=97></td>

<td nowrap><font face="Times" size="-2">Description</font></td>

<td><font face="Times">In 3.0, there was a race condition between&nbsp; <b>draggedImage:beganAt: </b>messages and the dragged image appearing on-screen.&nbsp; This race made it difficult for <b>draggedImage:beganAt:</b> methods to erase underneath the dragged image without an annoying flash.&nbsp; In 3.1, you are guaranteed that the dragged image is on-screen before the message is sent, and thus you can erase under the image without flashing.</font></td></tr>

<tr valign=top>

<td width=97 height=30></td></tr>

<tr valign=top>

<td width=97></td>

<td nowrap><font face="Helvetica" size="-2">Reference</font></td>

<td><font face="Times">31049</font></td></tr>

<tr valign=top>

<td width=97 height=10></td></tr>

<tr valign=top>

<td width=97></td>

<td nowrap><font face="Times" size="-2">Problem</font></td>

<td><font face="Times">NXDataLink's <b>initLinkedToSource:</b>... method would, on rare occasions, cause a crash.</font></td></tr>

<tr valign=top>

<td width=97 height=10></td></tr>

<tr valign=top>

<td width=97></td>

<td nowrap><font face="Helvetica" size="-2">Description</font></td>

<td><font face="Times">The cause of the crash has been removed.</font></td></tr>

<tr valign=top>

<td width=97 height=35></td></tr>

<tr valign=top>

<td width=97></td>

<td nowrap><font face="Helvetica" size="-2">Reference</font></td>

<td><font face="Times">32870</font></td></tr>

<tr valign=top>

<td width=97 height=10></td></tr>

<tr valign=top>

<td width=97></td>

<td nowrap><font face="Times" size="-2">Problem</font></td>

<td><font face="Times">windowWillMove: sender is not the Window.</font></td></tr>

<tr valign=top>

<td width=97 height=10></td></tr>

<tr valign=top>

<td width=97></td>

<td nowrap><font face="Helvetica" size="-2">Description</font></td>

<td><font face="Times">In 3.0, the window delegate message</font> <font face="Courier"><b>windowWillMove:</b></font> <font face="Times">would pass a view from the Window as the sender parameter instead of the Window itself.&nbsp; It has been corrected in 3.1 to pass the window.&nbsp; Apps compiled under 3.0 that worked around this bug will not be affected..</font></td></tr>

</table>

<p><br><br><br><br><br>

<p><img src="../Images/sp.gif" width=8 height=1><font face="Times" size="+1"><b>Notes Specific to Release 3.0</b></font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td><font face="Times">These notes were included with the Release 3.0 version of the Application Kit.&nbsp;&nbsp; Sections that are no longer relevant have been marked with an italicized comment.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=36></td>

<td><font face="Times"><b>Known Problems</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td><font face="Times">Known problems in the Application Kit:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><b><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></b></font></td>

<td><font face="Times">The command line program</font> <font face="Courier"><b>genstrings</b></font> <font face="Times">will crash if the specified output file cannot be created.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=36></td>

<td><font face="Times"><b>Incompatible Changes Since 2.1</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td><font face="Times">Incompatible changes made to the Application Kit since Release 2.1:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">The global variable</font> <font face="Courier"><b>NXSelectionPboard</b></font> <font face="Times">has been renamed to </font><font face="Courier"><b>NXGeneralPboard</b></font><font face="Times">.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">The following Speaker/Listener messages have been obsoleted and replaced with improved API described below under &#34;Interapplication Image Dragging&#34; and &#34;Workspace Protocol&#34;.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (int)registerWindow:(int)<i>windowNum</i> toPort:(port_t)<i>aPort</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (int)unregisterWindow:(int)<i>windowNum</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (int)icon...; (the set of messages received during dragging)</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (int)launchProgram:(const char *)<i>name</i> ok:(int *)<i>flag</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (int)getFileInfoFor:(char *)<i>fullPath</i> app:(char **)<i>appname</i></font><br>
<img src="../Images/sp.gif" width=136 height=1><font face="Courier" size="-1">type:(char **)<i>type</i> ilk:(int *)<i>ilk</i> ok:(int *)<i>flag</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (int)getFileIconFor:(char *)<i>fullPath</i> TIFF:(char **)<i>tiff</i></font><br>
<img src="../Images/sp.gif" width=136 height=1><font face="Courier" size="-1">TIFFLength:(int *)<i>length</i> ok:(int *)<i>flag</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (int)unmounting:(const char *)<i>fullPath</i> ok:(int *)<i>flag</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (int)powerOffIn:(int)<i>ms</i> andSave:(int)<i>aFlag</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (int)extendPowerOffBy:(int)<i>requestedMs</i> actual:(int *)<i>actualMs</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">The function</font> <font face="Courier"><b>PSsetpattern()</b></font> <font face="Times">no longer takes an argument.&nbsp; This change is only visible to programs recompiled under 3.0, and will not affect existing applications built for a 2.x release.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">The constants</font> <font face="Courier"><b>NX_RESIZEBUTTONMASK</b></font> <font face="Times">and</font> <font face="Courier"><b>NX_ALLBUTTONS</b></font> <font face="Times">have been removed for 3.0.&nbsp; In place of using</font> <font face="Courier"><b>NX_RESIZEBUTTONMASK</b></font><font face="Times">, you should create a window with style</font> <font face="Courier"><b>NX_RESIZEBARSTYLE</b></font><font face="Times">. In place of</font> <font face="Courier"><b>NX_ALLBUTTONS</b></font> <font face="Times">you should use (</font><font face="Courier"><b>NX_CLOSEBUTTONMASK|NX_MINIATURIZEBUTTONMASK</b></font><font face="Times">).</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Courier"><b>PrintInfo</b></font> <font face="Times">has been changed to use the</font> <font face="Courier"><b>NXPrinter</b></font> <font face="Times">object for specific information about the printer that is being used.&nbsp;&nbsp; See the description of</font> <font face="Courier"><b>NXPrinter</b></font> <font face="Times">above.&nbsp; Thus, the following methods have been removed from the public API:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- setManualFeed:(BOOL)<i>flag</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (BOOL)isManualFeed;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- setPrinterName:(const char *)<i>aString</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (const char *)<i>printerName</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- setPrinterType:(const char *)<i>aString</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (const char *)<i>printerType</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- setPrinterHost:(const char *)<i>aString</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (const char *)<i>printerHost</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- setResolution:(int)<i>anInt</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (int)resolution;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Because of the addition of</font> <font face="Courier"><b>updateFromPrintInfo</b></font> <font face="Times">and </font><font face="Courier"><b>finalWritePrintInfo</b></font> <font face="Times">(see below), the following methods have been removed from PrintPanel API:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- readPrintInfo;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- writePrintInfo;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">The following methods have been removed from the NXColorPanel API :</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">+ new</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">+ newColorMask:</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">+ newContent:style:backing:buttonMask:defer:</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">+ newContent:style:backing:buttonMask:defer:colorMask:</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- updateCustomColorList</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (int)colorMask;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- setColorMask:(int)colorMask</font>

<p><img src="../Images/sp.gif" width=96 height=1><font face="Times">The only initializer for this class is now</font>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">+ sharedInstance:(BOOL)<i>create</i></font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">The</font> <font face="Courier"><b>setColorMask:</b></font> <font face="Times">method was always a no-op.&nbsp; The initial color mask can now only be set before the ColorPanel is instantiated, using the</font> <font face="Courier"><b>setPickerMask:</b></font> <font face="Times">method (see below).</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">The following constants have been renamed in the NXColorPanel API :</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=108></td>

<td nowrap><font face="Courier" size="-1">NX_CUSTOMCOLORMODE</font></td>

<td nowrap><font face="Times" size="-1">-&gt;</font></td>

<td><font face="Courier" size="-1">NX_COLORLISTMODE</font></td></tr>

<tr valign=top>

<td width=108></td>

<td nowrap><font face="Courier" size="-1">NX_BEGINMODE</font></td>

<td nowrap><font face="Times" size="-1">-&gt;</font></td>

<td><font face="Courier" size="-1">NX_WHEELMODE</font></td></tr>

<tr valign=top>

<td width=108 height=14></td></tr>

<tr valign=top>

<td width=108></td>

<td nowrap><font face="Courier" size="-1">NX_CUSTOMCOLORMODEMASK</font></td>

<td nowrap><font face="Times" size="-1">-&gt;</font></td>

<td><font face="Courier" size="-1">NX_COLORLISTMODEMASK</font></td></tr>

<tr valign=top>

<td width=108></td>

<td nowrap><font face="Courier" size="-1">NX_BEGINMODEMASK</font></td>

<td nowrap><font face="Times" size="-1">-&gt;</font></td>

<td><font face="Courier" size="-1">NX_WHEELMODEMASK</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Courier"><b>NXReadBitmap()</b></font><font face="Times">,</font> <font face="Courier"><b>NXSizeBitmap()</b></font><font face="Times">, and</font> <font face="Courier"><b>NXDrawBitmap()</b></font> <font face="Times">have been moved from</font> <font face="Courier">tiff.h</font> <font face="Times">to</font> <font face="Courier">graphics.h</font><font face="Times">. Because</font> <font face="Courier">tiff.h</font> <font face="Times">imports</font> <font face="Courier">graphics.h, </font><font face="Times">this shouldn't cause any source changes.</font>&nbsp; <font face="Courier"><b>NXImageBitmap()</b></font><font face="Times">, now obsolete, has been removed from</font> <font face="Courier">tiff.h</font><font face="Times">.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">In 2.1, in windows that become key only if needed a view that did not accept first mouse would be passed the mouse clicks even if the window was not key.&nbsp; In 3.0 this has been fixed.&nbsp;&nbsp; Custom controls in these windows should return</font> <font face="Courier"><b>YES</b></font> <font face="Times">to </font><font face="Courier"><b>acceptsFirstMouse:</b></font><font face="Times">.&nbsp; Applications compiled under 2.1 are not affected by this change.</font></td></tr>

<tr valign=top>

<td width=72 height=18></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><b><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></b></font></td>

<td><font face="Times">The global variables</font> <font face="Courier"><b>NXSystemFont</b></font> <font face="Times">and</font> <font face="Courier"><b>NXBoldSystemFont</b></font> <font face="Times">have been removed from the API.&nbsp; Use the new font methods below in their place.</font></td></tr>

<tr valign=top>

<td width=72 height=15></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><b><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></b></font></td>

<td><font face="Times">The location field in flags changed events is no longer valid in 3.0.&nbsp; Also note that the location field in key down and key up events has never been valid.</font></td></tr>

<tr valign=top>

<td width=72 height=15></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><b><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></b></font></td>

<td><font face="Times">The defaults.h header file has moved from the appkit headers directory to the defaults directory. Thus imports of</font> <font face="Courier"><b>&lt;appkit/defaults.h&gt;</b></font> <font face="Times">should be changed to </font><font face="Courier"><b>&lt;defaults/defaults.h&gt;</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=36></td>

<td><font face="Times"><b>New Features</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><b><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></b></font></td>

<td><font face="Times">Color dragging</font></td></tr>

<tr valign=top>

<td width=72 height=18></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">Color-dragging is now accomplished using the new dragging API (see below).&nbsp; Thus, though supported, the</font> <font face="Courier"><b>acceptColor:atPoint:</b></font> <font face="Times">method should be avoided.&nbsp; For those who continue to use</font> <font face="Courier"><b>acceptColor:atPoint:</b></font> <font face="Times">in any case, two points should be kept in mind: 1) This method will now be properly called on flipped views (this did not used to be the case in earlier versions) and 2) If your view implements both the dragging protocol <i>and</i> the</font> <font face="Courier"><b>acceptColor:atPoint:</b></font> <font face="Times">method, <b>your </b></font><font face="Courier"><b>acceptColor:atPoint:</b></font> <font face="Times"><b>method will never get called!!</b></font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">To support the new color-dragging methodology, a new Pasteboard type has been added called</font> <font face="Courier"><b>NXColorPboardType</b></font><font face="Times">.&nbsp; You can read and write colors from the Pasteboard using the following functions:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">NXColor NXReadColorFromPasteboard(id pasteboard);</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">void NXWriteColorToPasteboard(id pasteboard, NXColor color);</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td><img src="../Images/sp.gif" width=18 height=1><font face="Times">Here is a look at what your code might look like to replace your current  </font><font face="Courier"><b>acceptColor:atPoint:</b></font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- initFrame:(NXRect const *)theFrame</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">{</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">[super initFrame:theFrame];</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">[self registerForDraggedTypes:&amp;NXColorPboardType count:1];</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">return self;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">}</font>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (NXDragOperation)draggingEntered:(id &lt;NXDraggingInfo&gt;)sender</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">{</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">if ([sender draggingSourceOperationMask] &amp;</font><br>
<img src="../Images/sp.gif" width=144 height=1><font face="Courier" size="-1">NX_DragOperationGeneric) {</font>

<p><img src="../Images/sp.gif" width=144 height=1><font face="Courier" size="-1">return NX_DragOperationGeneric;</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">} else {</font><br>
<img src="../Images/sp.gif" width=144 height=1><font face="Courier" size="-1">return NX_DragOperationNone;</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">}</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">}</font>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (BOOL)performDragOperation:(id &lt;NXDraggingInfo&gt;)sender</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">{</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">NXPoint p = [sender draggingLocation];</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">NXColor c = NXReadColorFromPasteboard(</font><br>
<img src="../Images/sp.gif" width=325 height=1><font face="Courier" size="-1">[sender draggingPasteboard]);</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">[self acceptColor:c atPoint:&amp;p];</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">return YES;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">}</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Application Tile</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">A new named image,</font> <font face="Courier"><b>NXAppTile</b></font><font face="Times">,&nbsp; has been added to allow apps to draw in their application icon without destroying the standard look. Developers who want to draw in their application icons should find this image with</font> <font face="Courier"><b>findImageNamed:</b></font> <font face="Times">and composite it at the lower left corner of the content view of the window. Then any custom drawing should be done above, <i>centered</i> on this image.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><b><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></b></font></td>

<td><font face="Times">RTFD support in the Text object</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">There is now support in the text object for reading, writing, and editing</font> <font face="Courier">.rtfd</font> <font face="Times">file format.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- setGraphicsImportEnabled:(BOOL)<i>flag</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">Enables dragging of graphics into the text object.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (BOOL)isGraphicsImportEnabled;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">Returns whether graphics importing is enabled.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (NXRTFDError)saveRTFDTo:(const char *)<i>path</i></font><br>
<img src="../Images/sp.gif" width=199 height=1><font face="Courier" size="-1">removeBackup:(BOOL)<i>removeBackup</i></font><br>
<img src="../Images/sp.gif" width=199 height=1><font face="Courier" size="-1">errorHandler:<i>errorHandler</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">Saves the contents of the text object to an</font> <font face="Courier">.rtfd</font> <font face="Times">format file. The file name passed in should end with</font> <font face="Courier">.rtfd</font><font face="Times">. If</font> <font face="Courier"><i>removeBackup</i></font> <font face="Times">is</font> <font face="Courier"><b>YES</b></font><font face="Times">, the backup document that is created to safely save the document is&nbsp; removed.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (NXRTFDError)openRTFDFrom:(const char *)<i>path</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">Loads an</font> <font face="Courier">.rtfd</font> <font face="Times">document into the text object.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- writeRTFDTo:(NXStream *)<i>stream</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">Writes a flattened form of the</font> <font face="Courier">.rtfd</font> <font face="Times">document into a stream. See</font> <font face="Courier"><b>readRTFDFrom: </b></font><font face="Times">to read the contents of such a stream.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- readRTFDFrom:(NXStream *)<i>stream</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">Reads from a stream an</font> <font face="Courier">.rtfd</font> <font face="Times">document, written out by the</font> <font face="Courier"><b>writeRTFDTo: </b></font><font face="Times">method.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- writeRTFDSelectionTo:(NXStream *)<i>stream</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">Writes a flattened form of the</font> <font face="Courier">.rtfd</font> <font face="Times">selection into a stream. See </font><font face="Courier"><b>replaceSelWithRTFD:</b></font> <font face="Times">to read the contents of such a stream.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- replaceSelWithRTFD:(NXStream *)<i>stream</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">Reads from a stream an</font> <font face="Courier">.rtfd</font> <font face="Times">document, replacing the current selection.&nbsp; This reads the output of&nbsp; the</font> <font face="Courier"><b>writeRTFDSelectionTo:</b></font> <font face="Times">method.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">New Filter Services Support</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">There are three new types of services: Filter services, Print Filter services and Spell-Checking services.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">Filters are services which have no Services menu entry and which have the semantic of converting a piece of data from one type to another.&nbsp; Filter services are accessed via the following Pasteboard methods:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">+ (NXAtom *)typesFilterableTo:(const char *)<i>type</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">+ newByFilteringFile:(const char *)<i>filename</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">+ newByFilteringData:(id &lt;NXData&gt;)<i>data</i></font><br>
<img src="../Images/sp.gif" width=206 height=1><font face="Courier" size="-1">ofType:(const char *)<i>type</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">+ newByFilteringTypesInPasteboard:(Pasteboard *)<i>pboard</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">The last three create a Pasteboard which has declared in it all the types which the argument to the method can be filtered to.&nbsp; When you actually ask for the data of a type in the returned Pasteboard, the filter service will be invoked.&nbsp; Thus, calling these methods is reasonably cheap until you actually ask for the data.</font>

<p><font face="Times">The first method is sort of the opposite of the last three.&nbsp; Given a type, it will return a null terminated list of types which can be converted TO that type.</font>

<p><font face="Times">For convenience (since many filter services operate on files), the following functions are provided to go between filename/contents pasteboard types and file extensions:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">NXAtom NXCreateFilenamePboardType(const char *fileType);</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">NXAtom NXCreateFileContentsPboardType(const char *fileType);</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">const char *NXGetFileType(const char *pboardType);</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">const char **NXGetFileTypes(const char *const *pboardTypes);</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">Creating a filter service is very similar to creating a regular service except that instead of using the &#34;Message:&#34; keyword in your Services description, you use the &#34;Filter:&#34; keyword.</font>

<p><font face="Times">In addition, there are a few special kinds of &#34;Port:&#34; you can use for filter services...</font>

<p><font face="Times">For those which operate on</font> <font face="Courier"><b>NXFilenamePboardType</b></font><font face="Times">, there are special ports called</font> <font face="Courier"><b>NXUNIXSTDIO</b></font> <font face="Times">and</font> <font face="Courier"><b>NXMAPFILE</b></font><font face="Times">.&nbsp; The first will cause your filter to get launched with the name of the file to be converted on the command line and which expects the data to be put in the Pasteboard to come out of the filter's stdout.&nbsp; This is mostly for compatibility with existing filters which work this way, it is strongly encouraged that you NOT use this mechanism because it causes the filter to be repeatedly launched rather than staying around and waiting on a Listener port (which is much more efficient).&nbsp; The second one is for file types which map directly to primitive pasteboard types.&nbsp; An example of this is</font> <font face="Courier"><b>.rtf</b></font> <font face="Times">files which map directly to the </font><font face="Courier"><b>NXRTFPboardType</b></font><font face="Times">.</font>

<p><font face="Times">The other special &#34;Port:&#34; is for associating types which can be converted from one to the other with no actual modification to the data.&nbsp; It is called</font> <font face="Courier"><b>NXIDENTITY</b></font><font face="Times">.&nbsp; An example of this is the</font> <font face="Courier"><b>.eps</b></font> <font face="Times">file format which can be &#34;filtered&#34; to the</font> <font face="Courier"><b>.ps</b></font> <font face="Times">format with no change.&nbsp; Remember to be clear about which way the filter is filtering when you use this port (because, for example, a</font> <font face="Courier"><b>.ps</b></font> <font face="Times">file can NOT be filtered to</font> <font face="Courier"><b>.eps</b></font> <font face="Times">using this special port, only the other way around).</font>

<p><font face="Times">Print Filter services are a specialized form of services which are largely unrelated to Filter services.&nbsp; Essentially, these filters take PostScript on their stdin and munge it and write the result out to a file specified on their command line via &#34;-o outputfile.ps&#34;.&nbsp; Print Filters can also generate non-.ps files (but still from PostScript input).&nbsp; A services description for a Print Filter looks like this:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">Print Filter: <i>superps</i></font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">Executable: <i>ps2superps</i></font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">Menu Item: <i>Super PostScript Output</i></font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">Device Dependent: <i>YES</i></font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">The</font> <font face="Courier"><i>superps</i></font> <font face="Times">is the file extension to use and is optional and, if not present, defaults to &#34;ps&#34;.&nbsp; The Executable is the name of the filter (just like in any other Service not provided by an application).&nbsp; The Menu Item will appear in a PopUpList in the SavePanel brought up by the PrintPanel when you choose Save in the PrintPanel. Device Dependent is optional (and defaults to NO)--it tells the printing machinery whether to generate PostScript (which will be stdin to the Print Filter) which is specific to the type of printer the user has chosen in the PrintPanel before clicking the Save button.&nbsp; The Menu Item is fully localizable through the Services localization mechanisms.</font>

<p><font face="Times">Spell-checking services are accessible via the new NXSpellServer and NXSpellChecker classes (see under <b>New Classes</b>).</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">New Pasteboard Type</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">In order to better support Filter services and other processes which want to rendezvous on communicating files as a data type, a new Pasteboard type has been added to the AppKit:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=90 height=1><font face="Courier">NXFileContentsPboardType</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">The first type can only be written or read from the Pasteboard using the methods:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (BOOL)writeFileContents:(const char *)<i>filename</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (char *)readFileContentsType:(const char *)<i>type</i></font><br>
<img src="../Images/sp.gif" width=276 height=1><font face="Courier" size="-1">toFile:(const char *)<i>filename</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">The format of the data written/read to/from the Pasteboard by these methods is unspecified in 3.0.&nbsp; These methods are analogous to the methods</font> <font face="Courier"><b>writeType:...</b></font><font face="Times">, so you must be sure to declare</font> <font face="Courier"><b>NXFileContentsPboardType</b></font> <font face="Times">before calling the </font><font face="Courier"><b>writeFileContents:</b></font> <font face="Times">method.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">TIFF 6.0 Support</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">The TIFF library has been updated to support revision 6.0 of TIFF.&nbsp; It should still be the case that all TIFFs that could be read with the earlier versions of NEXTSTEP can still be read, and, as an added bonus, some new images can also be understood.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">Under NEXTSTEP 2.0 JPEG images were written using a very early draft of the new TIFF standard. Because of numerous revisions to this spec, JPEG images written under 2.0 are pretty much <i>not</i> compatible with anything, except that they can be loaded under NEXTSTEP 3.0.&nbsp; JPEG images written under 3.0 are compatible with the TIFF 6.0 draft but cannot be read back on earlier versions of NEXTSTEP.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">Note that because JPEG compression can be applied to 8-bit images only, non-8-bit images will be written out as 8-bit when compressed using JPEG.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">The TIFF library now also allows writing one-bit images with CCITT Group 3 and Group 4 compression. It is an error to try to write deeper images with these compression types.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">One of the other changes in NEXTSTEP 3.0 is the way the presence of alpha is indicated in the TIFF file. Under 2.0, the private</font> <font face="Courier"><b>Matte</b></font> <font face="Times">tag (32995) was used to indicate that the extra channel of data was to be interpreted as alpha and the image data was premultiplied. 3.0 uses the TIFF 6.0-blessed</font> <font face="Courier"><b>ExtraSamples</b></font> <font face="Times">tag (338) to accomplish the same thing. Because of the safety checks built into the TIFF reader, 2.0 is actually able to read 3.0 files and deduce that the extra samples are alpha, despite the fact that the</font> <font face="Courier"><b>Matte</b></font> <font face="Times">tag is no longer written out.&nbsp; Thus files with alpha are interchangable between 2.0 and 3.0 systems. However, tiffutil under 2.0 is not smart enough to indicate that the file has alpha when the</font> <font face="Courier"><b>-info</b></font> <font face="Times">option is used; thus some of the output from tiffutil on a 2.0 system will be misleading on alpha images written under 3.0.&nbsp; The</font> <font face="Courier"><b>-dump</b></font> <font face="Times">option will indicate the presence of unrecognized tag 338 with a value of 1.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Dynamic Services</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">You can now dynamically add Services menu entries to the system by creating a file or directory with the extension</font> <font face="Courier"><b>.service</b></font> <font face="Times">and placing it in your normal application path or one of</font> <font face="Courier"><b>/NextLibrary/Services</b></font><font face="Times">,</font> <font face="Courier"><b>/LocalLibrary/Services</b></font> <font face="Times">or </font><font face="Courier"><b>~/Library/Services</b></font><font face="Times">.&nbsp; The contents of this file (or, if a directory, a file called &#34;services&#34; inside it) is exactly equivalent to the contents of a services control file.&nbsp; After adding the file, call the function</font> <font face="Courier"><b>NXUpdateDynamicServices(void)</b></font> <font face="Times">to get the system to recognize your newly-added services.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Interapplication Image Dragging (declared in</font> <font face="Courier"><b>&lt;appkit/drag.h&gt;</b></font><font face="Times">, </font><font face="Courier"><b>&lt;appkit/View.h&gt;</b></font> <font face="Times">and</font> <font face="Courier"><b>&lt;appkit/Window.h&gt;</b></font><font face="Times">)</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">New support has been added to View and Window for dragging images within and between applications.&nbsp; Since the actual data transfer is pasteboard based, any type of data may be transfered (not just filenames).&nbsp; A View that wishes to be the destination for dragged images sends itself the following message, which registers the Pasteboard data types that it is willing to accept.&nbsp; (Note that to receive files, use the </font><font face="Courier"><b>NXFilenamePboardType</b></font> <font face="Times">type, <i>not</i> extensions like &#34;.tiff&#34; or &#34;.eps&#34;).</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- registerForDraggedTypes:(const char *const *)<i>newTypes</i></font><br>
<img src="../Images/sp.gif" width=248 height=1><font face="Courier" size="-1">count:(int)<i>numTypes</i></font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">When an image is dragged into and out of the View, the View is sent messages so it can respond to the dragging interaction.&nbsp; These methods are all passed a</font> <font face="Courier"><b><i>sender</i></b></font><font face="Times">, which can be queried for information about the object being dragged in.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (NXDragOperation)draggingEntered:<i>sender</i></font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">... is sent to the view when the dragged image first enters the view.&nbsp; The receiver returns a</font> <font face="Courier">NXDragOperation</font> <font face="Times">to indicate which operation on the data it will perform (move, copy, link),&nbsp; which is used to set the cursor as the user drags the image.&nbsp; The view should first ask</font> <font face="Courier"><b><i>sender</i></b></font> <font face="Times">for drag source's operation mask (see below) to know what operations it can choose from.&nbsp; The default behavior is to return </font><font face="Courier"><b>NX_DragOperationNone,</b></font> <font face="Times">which indicates the dragged image will not be accepted.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (NXDragOperation)draggingUpdated:<i>sender</i></font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">... is sent periodically while the image being dragged remains within the View.&nbsp; As with </font><font face="Courier"><b>draggingEntered:</b></font><font face="Times">, an</font> <font face="Courier"><b>NXDragOpMask</b></font> <font face="Times">is returned.&nbsp; The default behavior is to simply return the value last returned by</font> <font face="Courier"><b>draggingEntered:</b></font><font face="Times">.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- draggingExited:sender</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">... is sent when the image is dragged out of the view.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (BOOL)prepareForDragOperation:<i>sender</i></font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">... is sent when the image is dropped on the view.&nbsp; It returns whether the View will accept the data represented by the dragged image.&nbsp; The default behavior is to return </font><font face="Courier"><b>YES</b></font><font face="Times">.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (BOOL)performDragOperation:<i>sender</i></font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">... is sent after the dragged image is removed from the screen.&nbsp; The View should implement this method to do the real work of importing the data represented by the image.&nbsp; It returns whether the View accepted the data.&nbsp; The default behavior is to return </font><font face="Courier"><b>NO</b></font><font face="Times">.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- concludeDragOperation:<i>sender</i></font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">... is sent after the complete dragging interaction is finished, if the destination accepted the data.</font>

<p><font face="Times">From within the above methods, the receiver can send</font> <font face="Courier"><b><i>sender</i></b></font> <font face="Times">a number of messages to find out about the drag session:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td nowrap><font face="Courier" size="-1">- draggingDestinationWindow;</font></td>

<td><font face="Times">The Window receiving the image</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=90 height=1><font face="Courier" size="-1">- (NXDragOperation)draggingSourceOperationMask;</font>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=351></td>

<td><font face="Courier">T</font><font face="Times">he operation mask supplied by the source, anded with the operation indicated by the user by holding down any modifier keys.</font></td></tr>

</table>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td nowrap><font face="Courier" size="-1">- (NXPoint)draggingLocation;</font></td>

<td><font face="Times">The current location of the mouse in the Window's coordinate system</font></td></tr>

<tr valign=top>

<td width=90></td>

<td nowrap><font face="Courier" size="-1">- (NXPoint)draggedImageLocation;</font></td>

<td><font face="Times">The current location of the dragged image in the Window's coordinate system</font></td></tr>

<tr valign=top>

<td width=90></td>

<td nowrap><font face="Courier" size="-1">- (NXImage *)draggedImage;</font></td>

<td><font face="Times">An</font> <font face="Courier"><b>NXImage</b></font> <font face="Times">of the dragged image</font></td></tr>

<tr valign=top>

<td width=90></td>

<td nowrap><font face="Courier" size="-1">- (NXImage *)draggedImageCopy;</font></td>

<td><font face="Times">A copy of an</font> <font face="Courier"><b>NXImage</b></font> <font face="Times">of the dragged image</font></td></tr>

<tr valign=top>

<td width=90></td>

<td nowrap><font face="Courier" size="-1">- (Pasteboard *)draggingPasteboard;</font></td>

<td><font face="Times">A</font> <font face="Courier"><b>Pasteboard</b></font> <font face="Times">with the data represented by the dragged image</font></td></tr>

<tr valign=top>

<td width=90></td>

<td nowrap><font face="Courier" size="-1">- (BOOL)isDraggingSourceLocal;</font></td>

<td><font face="Times">Whether the source is in the same application</font></td></tr>

<tr valign=top>

<td width=90></td>

<td nowrap><font face="Courier" size="-1">- draggingSource;</font></td>

<td><font face="Times">The source object (if dragging source is local)</font></td></tr>

<tr valign=top>

<td width=90></td>

<td nowrap><font face="Courier" size="-1">- (int)draggingSequenceNumber;</font></td>

<td><font face="Times">An int identifying this image dragging session</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">The object returned by</font> <font face="Courier"><b>draggedImage</b></font> <font face="Times">remains valid for the duration of the drag interaction.&nbsp; The object returned by</font> <font face="Courier"><b>draggedImageCopy</b></font> <font face="Times">can be retained indefinitely by the caller, and will not be freed automatically.&nbsp; Use</font> <font face="Courier"><b>draggedImage</b></font> <font face="Times">when you just need to give feedback during the drag interaction.&nbsp; Use</font> <font face="Courier"><b>draggedImageCopy</b></font> <font face="Times">when you need to retain the image for use after the drag is completed.&nbsp; Usually you won't call </font><font face="Courier"><b>draggedImageCopy</b></font> <font face="Times">until you know the image has been deposited on your View or Window.</font>

<p><font face="Times">The following method can be sent (only from</font> <font face="Courier"><b>prepareForDragOperation:</b></font><font face="Times">) to the sender to cause the icon to slide to a certain location after the dragged image has been released and accepted:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- slideDraggedImageTo:(NXPoint *)<i>screenPoint</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">All of the above methods can also be used at the Window level instead with a particular View.</font>&nbsp; <font face="Courier"><b>registerForDraggedTypes:count:</b></font> <font face="Times">is sent to the Window (instead of to a View), and the Window's delegate receives the messages when an images enters, exits, etc.</font>

<p><br><br>

<p><font face="Times">To be the source of a drag, an application initiates the dragging session by sending the following message to a View or Window:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- dragImage:<i>anImage</i></font><br>
<img src="../Images/sp.gif" width=171 height=1><font face="Courier" size="-1">at:(NXPoint *)<i>location</i></font><br>
<img src="../Images/sp.gif" width=143 height=1><font face="Courier" size="-1">offset:(NXPoint *)<i>initialOffset</i></font><br>
<img src="../Images/sp.gif" width=150 height=1><font face="Courier" size="-1">event:(NXEvent *)<i>mouseDownEvent</i></font><br>
<img src="../Images/sp.gif" width=115 height=1><font face="Courier" size="-1">pasteboard:(Pasteboard *)<i>dragPasteboard</i></font><br>
<img src="../Images/sp.gif" width=143 height=1><font face="Courier" size="-1">source:<i>sourceObj</i></font><br>
<img src="../Images/sp.gif" width=122 height=1><font face="Courier" size="-1">slideBack:(BOOL)<i>slideFlag</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Courier"><i>anImage</i></font> <font face="Times">is the image to be dragged.</font>&nbsp; <font face="Courier"><i>location</i></font> <font face="Times">is initial location of the image. </font><font face="Courier"><i>initialOffset</i></font> <font face="Times">is the amount the mouse has moved since the initial mouse down event.&nbsp; This should be (0,0) unless you track the mouse before calling this method (possibly to implement some hysteresis before initiating the drag session).&nbsp; A NULL pointer is interpretted as (0,0).</font>&nbsp; <font face="Courier"><i>mouseDownEvent</i></font> <font face="Times">is the original mouse down event that was received to start the drag session.</font>&nbsp;&nbsp; <font face="Courier"><i>dragPasteboard</i></font> <font face="Times">is a pasteboard containing the data to be transfered to the destination.&nbsp; The source should aquire this pasteboard by using</font> <font face="Courier">[Pasteboard newName:NXDragPboard]</font><font face="Times">, and declare the data types it can supply to that pasteboard before calling</font> <font face="Courier"><b>dragImage:</b></font><font face="Times">... . </font><font face="Courier"><i>sourceObj</i></font> <font face="Times">is an object that will receive messages described below during the drag sesssion.</font>&nbsp; <font face="Courier"><i>slideFlag</i></font> <font face="Times">controls whether the image will slide back to the source if it is not successfully accepted by some destination.</font>

<p><font face="Times">During the drag session, the</font> <font face="Courier"><i>sourceObj</i></font> <font face="Times">is sent the following messages:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (NXDragOperation)draggingSourceOperationMaskForLocal:(BOOL)<i>flag</i></font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">... is sent to request the mask of dragging operations available.</font>&nbsp; <font face="Courier"><i>flag</i></font> <font face="Times">indicates whether the potential destination object is in the same application.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- draggedImage:(NXImage *)<i>image</i> beganAt:(NXPoint *)<i>screenPoint</i></font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">... is sent after the dragged image has been displayed on the screen,&nbsp; but before it has begun following the mouse.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- draggedImage:(NXImage *)<i>image</i> endedAt:(NXPoint *)<i>screenPoint</i></font><br>
<img src="../Images/sp.gif" width=143 height=1><font face="Courier" size="-1">deposited:(BOOL)<i>flag</i></font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">... is sent after the dragged image has been released.</font>&nbsp; <font face="Courier"><i>flag</i></font> <font face="Times">indicates whether the image was successfully deposited on a destination.</font>

<p><font face="Times"><b>Using the NXDragOperation's:</b>&nbsp; The drag operation provided by the source and destination are used to help the apps negotiate the type of operation that will be performed, and to give the user feedback via the cursor shape.&nbsp; The possible values are:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">NX_DragOperationNone</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">NX_DragOperationCopy</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">NX_DragOperationLink</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">NX_DragOperationGeneric</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">NX_DragOperationPrivate</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">&#34;None&#34; means no operation will be taken.&nbsp; &#34;Copy&#34; means that the data being dragged will be copied when it is deposited.&nbsp; &#34;Link&#34; means a link of some sort will be made to the source of the data.&nbsp; &#34;Generic&#34; means the data being dragged will be accepted and the &#34;standard&#34; operation for the given scenario will be performed.&nbsp; For example, in the &#34;Generic&#34; case the Workspace Manager will move files.&nbsp; In color dragging &#34;Generic&#34; simply means a successful association of the dragged color with the destination.&nbsp; If data is not being clearly copied or linked <i>in the user's model</i> &#34;Generic&#34; is the right operation to use.&nbsp; &#34;Private&#34; means special messages will be exchanged between the source and destination.&nbsp; In this case, the system does not alter the cursor appearance.</font>

<p><font face="Times">A source should respond to</font> <font face="Courier"><b>draggingSourceOperationMaskForLocal:</b></font><font face="Times">with a <i>mask</i> of as many operations as it supports.&nbsp; This should almost always include </font><font face="Courier">NX_DragOperationGeneric,</font><font face="Times">and</font> <font face="Courier">NX_DragOperationCopy</font> <font face="Times">if this is applicable (it usually is for files).</font>&nbsp; <font face="Courier">NX_DragOperationLink</font> <font face="Times">should be included only if there is an expected linking mechanism for the data, i.e., a destination may make an ObjectLink to a file.&nbsp; You may not want to include</font> <font face="Courier">NX_DragOperationLink</font> <font face="Times">if the source is a file inside a file package, since it may be dangerous for the user to directly edit this data without the container's knowledge.</font>

<p><font face="Times">A destination responds to its messages with a <i>single operation</i>, not a mask.&nbsp; A destination should always ask for the</font> <font face="Courier"><b>draggingSourceOperationMask</b></font> <font face="Times">and choose an operation supplied by the source, or else return </font><font face="Courier">NX_DragOperationNone</font> <font face="Times">if no operation is workable.&nbsp; You are also free to examine the available data types, if this affects your decision.&nbsp; If the user is using no modifier keys, the entire mask provided by the source will be visible, and you should choose the best default operation (usually &#34;Copy&#34; for moving files, &#34;Generic&#34; for other types, rarely &#34;Links&#34;).&nbsp; If the user holds down a modifer key, his preference will mask the operations supplied by the source. (The Control key is &#34;Link&#34;, Alternate is &#34;Copy&#34;, Command is &#34;Generic&#34;).&nbsp; In this case, the destination will see only one available operation.&nbsp; If it is supported, the destination should return that operation, else </font><font face="Courier">NX_DragOperationNone</font><font face="Times">.</font></td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">New Defaults</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">The default</font> <font face="Courier"><b>NXUseTrueGrays</b></font> <font face="Times">has been added.&nbsp; If set to</font> <font face="Courier"><b>YES</b></font><font face="Times">, then areas of the UI that use patterns to implement various gray dithers will instead be drawn with the real gray value.&nbsp; The most noticeable example of this is in Scrollers.&nbsp; This default can be useful when grabbing bits for screen shots.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">The defaults</font> <font face="Courier"><b>NXSystemFonts</b></font> <font face="Times">and</font> <font face="Courier"><b>NXBoldSystemFonts</b></font> <font face="Times">have been added for settting the system font and bold system fonts of an application or the system.&nbsp; Their values are a list of semi-colon separated font names.&nbsp; The first available font is used.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">The</font> <font face="Courier"><b>GLOBAL</b></font> <font face="Times">default</font> <font face="Courier"><b>NXLanguages</b></font> <font face="Times">has been added.&nbsp; It can be used to set the prefered languages to use on an application by application basis.&nbsp; Its value is a list of languages separated by semi-colons.&nbsp; Apps should use Application's </font><font face="Courier"><b>systemLanguages</b></font> <font face="Times">method intead of reading this default directly.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">The application defaults</font> <font face="Courier"><b>NXUseCalibratedColor</b></font> <font face="Times">and </font><font face="Courier"><b>NXColorCalibrateLevelOneOps</b></font> <font face="Times">have been added to disable color calibration features of the kit for applications that break or exhibit strange behaviour. These two defaults are described elsewhere in these notes.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">The application default</font> <font face="Courier"><b>NXMaxSharedImageWidth</b></font> <font face="Times">has been added to control how non-unique NXImages share caches within an application. This default should be used for debugging purposes only and is described elsewhere in these notes.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=36></td>

<td><font face="Times"><b>New Classes</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Courier"><b>NXDataLinkManager, NXDataLink, NXSelection, NXDataLinkPanel</b></font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">These four classes have been added to the AppKit to support the dynamic linking of data between documents of different applications.&nbsp; Information on this feature can be found in the ObjectLinks release notes.</font></td></tr>

<tr valign=top>

<td width=72 height=14></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Courier"><b>NXColorList</b></font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">Instances of NXColorList manage lists of named colors.&nbsp; Example of color lists include PANTONE and the various lists that appear in the &#34;Custom Color&#34; mode of the Color Panel. In addition, an application can use NXColorLists in managing document-specific color lists.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">Color lists come in two varieties: Ones that generate <i>named</i> colors and ones that don't. By default, color lists generate unnamed colors; thus, once the color is handed out, it has no idea what its name was or what list it came from.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">Named colors not only remember their color value but also the name of the list and the color. When they are asked to print the color (through</font> <font face="Courier"><b>NXSetColor()</b></font><font face="Times">), these colors generate a reference to the color list and name to allow the printing system to search for the correct value for the device.&nbsp; Only lists such as PANTONE are set up to generate named colors.&nbsp; Such lists are also considered immutable and attempts to change them at runtime will raise errors.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">Color lists, except for those created at runtime and saved out programmatically, are stored in file-wrappers. This allows for localized and/or device-dependent versions of the lists.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Courier"><b>NXColorPicker</b></font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">This class is added only for subclassing, and can be used by application developers who want to &#34;inject&#34; their own color pickers into the ColorPanel.&nbsp; This class conforms to the NXColorPicking protocol.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Courier"><b>NXSpellChecker</b></font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">It is now possible to access the NeXT spell checking mechanism from your application. In other words, the NeXT spell checker can spell check other objects besides our Text object.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">For an object to be &#34;spell-checkable&#34;, it need only implement the following two protocols:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=108></td>

<td><font face="Times"><b>NXReadOnlyTextStream</b></font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- openTextStream;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (BOOL)seekToCharacterAt:(int)<i>offset</i> relativeTo:(int)<i>seekMode</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (int)readCharacters:(char *)<i>buffer</i> count:(int)<i>count</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (int)currentCharacterOffset;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (BOOL)isAtEOTS;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- closeTextStream;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=108></td>

<td><font face="Times"><b>NXSelectRange</b></font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (void)selectCharactersFrom:(int)<i>start</i> to:(int)<i>end</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (int)selectionCharacterCount;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (int)readCharactersFromSelection:(char *)<i>buffer</i></font><br>
<img src="../Images/sp.gif" width=311 height=1><font face="Courier" size="-1">count:(int)<i>count</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (void)makeSelectionVisible;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">The first is used by spell-checking services to suck the text out of the object you want spell-checked.&nbsp; The characters should be NEXTSTEP encoding characters (so, if you run across some Kanji text or other text whose characters do not exist anywhere in the NEXTSTEP encoding, please turn those characters into a &#34;space&#34; character).</font>

<p><font face="Times">Note that the object may choose to break itself up into lots of little <b>NXReadOnlyTextStream</b>'s.&nbsp; An example of this is if you can mark ranges of text with a language in your application, you would probably want to return YES to</font> <font face="Courier"><b>isAtEOTS </b></font><font face="Times">(and stop returning characters via</font> <font face="Courier"><b>readCharacters:count:</b></font><font face="Times">) whenever you get to the end of a string of text in a single language.&nbsp; Then, you can tell the NXSpellChecker object to switch languages and start up another spell check.</font>

<p><font face="Times">Note that the</font> <font face="Courier"><b>currentCharacterOffset</b></font> <font face="Times">should always reflect either the position of the insertion point of the text, or the start of the selection in the text, or, if neither of those exist, the start of the text.&nbsp; Note that this means that the <b>NXReadOnlyTextStream</b> is only expected to be valid during the duration of a call to </font><font face="Courier"><b>checkSpelling:of:</b></font><font face="Times">.</font>

<p><font face="Times">A spell-check is initiated by sending ...</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (BOOL)checkSpelling:(NXSpellCheckType)<i>type</i></font><br>
<img src="../Images/sp.gif" width=136 height=1><font face="Courier" size="-1">of:(id &lt;NXReadOnlyTextStream, NXSelectRange&gt;)<i>textStream</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">... to the NXSpellChecker's</font> <font face="Courier"><b>sharedInstance</b></font><font face="Times">.&nbsp; The spell-check ends either when a misspelled word is found or when the NXReadOnlyStream runs out of characters.&nbsp; It returns whether a misspelled word was found.</font>

<p><font face="Courier"><i>type</i></font> <font face="Times">almost always wants to be <b>NX_CheckSpelling</b>, in which case, if the spell-check was initiated at a</font> <font face="Courier"><b>currentCharacterOffset</b></font> <font face="Times">not equal to 0 and a misspelled word is not found by the time the</font> <font face="Courier"><b>EOTS</b></font> <font face="Times">is reached, the NXSpellChecker will attempt to wrap around to the beginning of the text and continue spell-checking (until it reaches the original start point).</font>

<p><font face="Times">Calling</font> <font face="Courier"><b>checkSpelling:of:</b></font> <font face="Times">with a</font> <font face="Courier"><i>type</i></font> <font face="Times">of <b>NX_CheckSpellingToEnd</b> will not wrap around to the start of the text.&nbsp; <b>NX_CheckSpellingFromStart</b> starts the spell checking at the beginning of the NXReadOnlyTextStream.&nbsp; There are other modes as well, see the header file.</font>

<p><font face="Times">The spell-checker also allows you to insert an accessory view into the spell-checking panel.</font>

<p><font face="Times">You can control the language of spell-checking programatically by calling </font><font face="Courier"><b>setLanguage:</b></font><font face="Times">.&nbsp; The arguments to this function are the same as those returned by </font><font face="Courier"><b>systemLanguages</b></font> <font face="Times">(they are strings registered by NeXT for each language, please check with NeXT to determine what they are or register new ones).&nbsp; Be careful to give the user some control over this, because calling this method will blast whatever choice the user may have made in the spelling panel.&nbsp; You should probably only do this if the user has explicitly set the language he wants in the document somehow, and, even then, let him turn that auto-language-setting off.</font>

<p><font face="Times">If you want your object to support correction of misspellings, it should implement the NXChangeSpelling protocol which only has one method,</font> <font face="Courier"><b>changeSpelling:</b></font><font face="Times">, whose argument is a Control which the receiver should ask the</font> <font face="Courier"><b>stringValue</b></font> <font face="Times">of to and replace its selection with whatever that</font> <font face="Courier"><b>stringValue</b></font> <font face="Times">returns.</font>

<p><font face="Times">If you want your document to have its own &#34;ignored word&#34; list, your textStream must implement the <b>NXIgnoreMisspelledWords</b> protocol which has only one method:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (int)spellClientTag;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td><img src="../Images/sp.gif" width=18 height=1><font face="Times">This should return a unique integer.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">If you implement this method, then the Ignore button in the spelling panel will be enabled and you are eligible to use the following methods:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (char **)ignoredWordsForSpellClient:(int)tag;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- setIgnoredWords:(const char *const *)words</font><br>
<img src="../Images/sp.gif" width=129 height=1><font face="Courier" size="-1">forSpellClient:(int)tag;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- closeSpellClient:(int)tag;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">The first two are for getting and setting the ignored word list.&nbsp; You can use these to store the ignored word list with your document and reset it up when the document is opened again.&nbsp; You should call the last one when your document is closed so that the storage of the ignored words is freed up.</font>

<p><font face="Times">Finally, you may want to make it easy on your user by putting whatever word he selects in your document into the NXSpellChecker's word field.&nbsp; You should probably only do this on double-click (i.e. only do it when the user actually selects a word).&nbsp; This is accomplished via ...</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- setWordFieldValue:(const char *)aWord;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Courier"><b>NXSpellServer</b></font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">It is now possible to write your own spelling checker for the NeXT machine.&nbsp; You do this simply by implementing an object which knows how to do two things: find a misspelled word in a stream of text and suggest guess for a misspelled word.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">A spell server is never an application, it is a simple program whose</font> <font face="Courier"><b>main()</b></font> <font face="Times">looks something like this ...</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">void main()</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">{</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">NXSpellServer *server = [[NXSpellServer alloc] init];</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">if ([server registerLanguage:&#34;English&#34; byVendor:&#34;ACME&#34;]) {</font><br>
<img src="../Images/sp.gif" width=144 height=1><font face="Courier" size="-1">[server setDelegate:[ACMEEnglishSpellChecker new]];</font><br>
<img src="../Images/sp.gif" width=144 height=1><font face="Courier" size="-1">[server run];</font><br>
<img src="../Images/sp.gif" width=144 height=1><font face="Courier" size="-1">fprintf(stderr, &#34;Unexpected death!\n&#34;);</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">} else {</font><br>
<img src="../Images/sp.gif" width=144 height=1><font face="Courier" size="-1">fprintf(stderr, &#34;Unable to check spell-checker in.\n&#34;);</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">}</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">}</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">... where the</font> <font face="Courier"><b>ACMEEnglishSpellChecker</b></font> <font face="Times">is a simple subclass of <b>Object</b> which implements the following two delegate methods:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (BOOL)spellServer:(NXSpellServer *)<i>sender</i></font><br>
<img src="../Images/sp.gif" width=115 height=1><font face="Courier" size="-1">findMisspelledWord:(int *)<i>start</i></font><br>
<img src="../Images/sp.gif" width=199 height=1><font face="Courier" size="-1">length:(int *)<i>length</i></font><br>
<img src="../Images/sp.gif" width=171 height=1><font face="Courier" size="-1">inLanguage:(const char *)<i>language</i></font><br>
<img src="../Images/sp.gif" width=157 height=1><font face="Courier" size="-1">inTextStream:(id &lt;NXReadOnlyTextStream&gt;)<i>textStream</i></font><br>
<img src="../Images/sp.gif" width=171 height=1><font face="Courier" size="-1">startingAt:(int)<i>startPosition</i>;</font>

<p><img src="../Images/sp.gif" width=122 height=1><font face="Courier" size="-1">- (void)spellServer:(NXSpellServer *)<i>sender</i></font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">suggestGuessesForWord:(const char *)<i>word</i></font><br>
<img src="../Images/sp.gif" width=185 height=1><font face="Courier" size="-1">inLanguage:(const char *)<i>language</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">A single server can spell-check in many languages (i.e. repeated calls to </font><font face="Courier"><b>registerLanguage:byVendor:</b></font> <font face="Times">is perfectly acceptable).</font>

<p><font face="Times">See the description of the <b>NXReadOnlyTextStream</b> above (under NXSpellChecker) to see how your spell-checker can suck text out of the object being spell-checked.&nbsp; The return value for</font> <font face="Courier"><b>findMisspelledWord:</b></font> <font face="Times">is whether or not a misspelled word was found.&nbsp; If one was found, then</font> <font face="Courier"><b>start</b></font> <font face="Times">(and</font> <font face="Courier"><b>length</b></font><font face="Times">) should be set to the start (and length) of the misspellled word in the</font> <font face="Courier"><b>textStream</b></font><font face="Times">.</font>

<p><font face="Times">The implementation of</font> <font face="Courier"><b>suggestGuessesForWord:</b></font> <font face="Times">should call the NXSpellServer method:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- addGuess:(const char *)<i>aWord</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">whenever it figures out another guess for the passed-in</font> <font face="Courier"><b><i>word</i></b></font><font face="Times">.</font>

<p><font face="Times">The system also maintains a simple user dictionary which you can check the contents of via:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (BOOL)isInUserDictionary:(const char *)word</font><br>
<img src="../Images/sp.gif" width=199 height=1><font face="Courier" size="-1">caseSensitive:(BOOL)flag</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">This method is very efficient and appropriate for calling inside inner loops, in fact, you may want to use the Objective-C</font> <font face="Courier"><b>methodFor:</b></font> <font face="Times">mechanism to get a pointer to a C function which implements this method.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Courier"><b>NXHelpPanel</b></font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">There is now a class</font> <font face="Courier"><b>NXHelpPanel</b></font> <font face="Times">for applications to use when presenting help to the user.&nbsp; It is simple to use and there is very little API for the programmer to be aware of .&nbsp; To enable the help panel to be shown you will need to put a &#34;Help...&#34; menu item in your Info submenu.&nbsp; It&nbsp; should have the First Responder (NULL) as its target and </font><font face="Courier"><b>showHelpPanel:</b></font> <font face="Times">as its action.&nbsp;&nbsp; This item will display the help panel.&nbsp; Initially the help text is set to the first item in the table of contents of your</font> <font face="Courier"><b>Help</b></font> <font face="Times">directory. Subsequent times the help panel is displayed it shows whatever was last shown when the panel was hidden (however, if you are displaying context-sensitive help, see below). If you get your Info menu from InterfaceBuilder it will already have a &#34;Help...&#34; item correctly set for you.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">The main task for&nbsp; the developer is to create and customize a</font> <font face="Courier"><b>Help</b></font> <font face="Times">directory in the various .lproj directories in your application wrapper.&nbsp; The preferred way create a Help directory is to have ProjectBuilder copy a template into the .lproj for you to modify.&nbsp; The </font><font face="Courier"><b>Help</b></font> <font face="Times">directory contains two special files with names</font> <font face="Courier"><b>TableOfContents.rtf</b></font> <font face="Times">and </font><font face="Courier"><b>Index.rtfd</b></font><font face="Times">.&nbsp; Other files in the directory are RTF (or RTFD) files containing help text specific to your application.</font><br>
<font face="Times">The</font> <font face="Courier"><b>TableOfContents.rtf</b></font> <font face="Times">(TOC) file should contain one entry for each help text file in the Help directory.&nbsp; It is important that this one to one mapping of TOC entries to files be maintained.&nbsp; The first thing on each active line should be a link to whatever file corresponds to the entry (more on links below).&nbsp; Following that is the text of the TOC entry which may wrap and span several lines.&nbsp; The TOC looks like it is displayed using a Matrix, but actually it is a modified Text object.&nbsp; You can therefore use the full generality of RTF to format your table of contents.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">The</font> <font face="Courier"><b>Index.rtfd</b></font> <font face="Times">file is structured similarly although there is no one to one mapping enforced.&nbsp; Generally the link that starts an index entry will specify a file and a marker within that file to go to.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">The Text object for 3.0 has been modified to use hypertext-like links.&nbsp; Edit has been modified to allow the insertion of links and markers.&nbsp;&nbsp;&nbsp; A link consists of a filename and optional markername and is displayed as a little diamond embedded in the text.&nbsp; When the user clicks the diamond the help panel (or Edit for that matter) will display the specified file.&nbsp; If&nbsp; a destination marker is specified&nbsp; as part of the link it is scrolled into view and the text from the marker to the end of the line will be selected.&nbsp; Unless explicitly shown in Edit the actual markers are not displayed in the text.&nbsp; You can inspect both links and markers in Edit by holding down the Command key while clicking them.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">In the template that ProjectBuilder copies into you English.lproj you will initially only have a <b>TableOfContents.rtf</b> and and an <b>Index.rtfd</b> file.&nbsp; If you use Edit you inspect the links in the TOC you will see that they link to files that are not found in the template.&nbsp; If you try to follow those links by clicking them, Edit will say that the files cannot be found.&nbsp; This is because the HelpPanel makes use of a search path to locate files to display.&nbsp; It will first look in your Help directory.&nbsp; If the file is found there it will be displayed.&nbsp; If the file is not found the HelpPanel looks in a special compressed store file /usr/lib/NextStep/Resources/{language}.lproj/Help.store to see if the file can be located there.&nbsp; This pathing allows NeXT to supply standard help about getting started&nbsp; and for some user inferface objects.&nbsp; If you do not want to have this standard help in you application you may delete the unappropriate TOC entries.&nbsp; You may also customize copies of the standard files if you so desire.&nbsp; To do this use the HelpBuilder panel in InterfaceBuilder to display the file (Edit will not be able to find it since it doesn't perform the pathing).&nbsp; Then select all the text and copy and paste it into a new document.&nbsp; Save the document in your Help directory under the same name as is shown in the HelpBuilder panel.&nbsp; Be sure to size the window to the same width as the original so that the text will wrap the same.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">The click for help feature allows a user to click on some object on the screen to get help on it.&nbsp; If the Help modifier key is pressed the cursor changes to a special help cursor, indicating you can then get help by clicking on some UI object (on keyboards without a Help key, you can hold Control and Alternate simultaneously to click and get help.&nbsp; You will generally used the HelpBuilder panel and Help inspector&nbsp; in InterfaceBuilder to specify which help gets displayed when a given object is help clicked.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">You can also attach a help file to a user interface object programatically.&nbsp; You need to send the message:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- attachHelpFile:(const char *)<i>filename</i></font><br>
<img src="../Images/sp.gif" width=150 height=1><font face="Courier" size="-1">markerName:(const char *)<i>markername</i></font><br>
<img src="../Images/sp.gif" width=206 height=1><font face="Courier" size="-1">to:<i>object</i></font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">to the</font> <font face="Courier"><b>NXHelpPanel</b></font> <font face="Times">factory.&nbsp; The arguments</font> <font face="Courier"><b><i>filename</i></b></font> <font face="Times">and</font> <font face="Courier"><b><i>markername</i></b></font> <font face="Times">are the same as when creating a link.&nbsp; The</font> <font face="Courier"><b>object</b></font> <font face="Times">argument is the object that the help is attached to.&nbsp; There is also a corresponding</font> <font face="Courier"><b>detachHelpFrom:<i>object</i></b></font> <font face="Times">message to remove help from that object.</font>

<p><font face="Times">There is an exception to the above stated rule that there must be a one-to-one correspondence between TOC entries and help files in the Help directory.&nbsp; It is possible to have a set of files within a &#34;hidden files&#34; directory that do not have TOC entries. Since these files cannot be accessed from the TOC, the only way for the user to view them is by finding them with the Find command or linking to them from the Index or some other file.&nbsp; An example of this in the NeXT supplied help are the files in the <b>Objects</b> directory.&nbsp; These files are designed to be accessed by help-clicking the appropriate user interface object.&nbsp; It is necessary to have a TOC entry for highlighting whenever a file in a given hidden files directory is displayed.&nbsp; In the NeXT supplied help that TOC entry is entitled <b>Commands, Panels and Buttons</b>.&nbsp; The TOC entry for a hidden files directory must link to a special file <b>Prolog.rtfd</b> within that directory.&nbsp; This file will be displayed if the user clicks the TOC entry.&nbsp; The prolog file in the NeXT help says that you can get help on any command panel or button by help-clicking that object.</font>

<p><font face="Times">It is possible for your application to&nbsp; provide context sensitive help.&nbsp;&nbsp; The help displayed when the <b>Help...</b> menu item is choosen will be dependent on the state of the application. To do this your application will need to initialize the panel to display the appropriate help information.&nbsp; This may be done by having the Application delegate respond to the </font><font face="Courier"><b>app:willShowHelpPanel:</b></font> <font face="Times">method.&nbsp; The method should do something like the following:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- app:sender willShowHelpPanel:panel</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">{</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">char path[MAXPATHLEN + 1];</font>

<p><img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">sprintf (path, &#34;%s/%s&#34;, [panel helpDirectory],  &#34;Tasks/AddressingMail/CreatingAddressBook.rtfd&#34;);</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">[panel showFile:path atMarker:NULL];</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">return self;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">}</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">In this case you must specify a fully qualified path in this case.&nbsp; This is because with partial paths the HelpPanel assumes the path is relative to the currently displayed help file.&nbsp; Since you want the code to work independently of what file is currently being displayed you should always give a full path.</font>

<p><font face="Times">The Find command makes use of the Indexing kit to quickly locate files containing the word in question.&nbsp; For the Find command to work quickly you should create indexes for your help files using the Indexing kit (Note: this index is different from the Index.rtfd that the user will see).&nbsp;&nbsp; If you have a hidden files directory you should first make an index of it before creating an index of the entire Help directory.&nbsp; That way the hidden files will not be indexed in the main index.&nbsp; To create the index, in a shell, change the working directory to the directory you want indexed.&nbsp; Then type</font> <font face="Courier">ixbuild -v</font>&nbsp; <font face="Times">with no other arguments.&nbsp; A .index.store file will be created in that directory for you.</td></tr>

</table>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Courier"><b>NXPrinter</b></font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Courier"><b>NXPrinter</b></font> <font face="Times">provides access to static information on printers.&nbsp; It is a substitute for some of the</font> <font face="Courier"><b>prdb</b></font> <font face="Times">library functions.&nbsp; It also provides access to printer-specific information, like page imageable regions, whether a printer does manual feed, possible resolutions, etc, using PPD files.&nbsp; This object returns information in NetInfo and PPD files, it does not provide dynamic information about the printer state like whether the printer is running, whether it is out of paper, etc.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">PPD files are now supported through the</font> <font face="Courier"><b>NXPrinter</b></font> <font face="Times">object.&nbsp; These are newer versions of the .pdf files found in /usr/lib/NextPrinter/pdf in older releases.&nbsp; The new extension is .ppd.&nbsp; They are now searched for in : </font><font face="Courier"><b>/NextLibrary/PrinterTypes, ~/Library/PrinterTypes, /HostLibrary/PrinterTypes, and /LocalLibrary/PrinterTypes</b></font><font face="Times">. The spec for these files, and most of the files we ship, are provided by Adobe.&nbsp; These files adhere to a newer PPD format specification than the older pdf files.&nbsp; They describe printer-specific information (like whether the printer is color, paper imageable regions, etc), and printer-specific pieces of PostScript (like setting particular resolutions).&nbsp; For compatibility purposes, /usr/lib/NextPrinter/pdf is also searched for .pdf files.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=36></td>

<td><font face="Times"><b>New Methods</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td><font face="Times">New methods (providing incremental functionality) added to existing classes:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">NXColorPanel</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">The following methods have been added to NXColorPanel:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">+ (void)setPickerMode:(int)<i>mode</i></font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">+ (void)setPickerMask:(int)<i>mask</i></font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (BOOL)doesShowAlpha</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (float)alpha</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (BOOL)isContinuous</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (int)mode</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Courier"><b>setPickerMode:</b></font> <font face="Times">allows apps to set the ColorPanel's initial picker mode (what picker will initially be visible), without actually instantiating the ColorPanel. The </font><font face="Courier"><b>setPickerMask:</b></font> <font face="Times">method is similar to the old</font> <font face="Courier"><b>setColorMask:</b></font> <font face="Times">method.&nbsp; It takes as a parameter one or more (<i>or</i>d together) of the the picker masks defined in NXColorPanel.h.&nbsp; This determines which pickers will be available in the ColorPanel. This method only has an effect before the ColorPanel is instantiated. </font><font face="Courier"><b>doesShowAlpha</b></font> <font face="Times">returns YES if the ColorPanel has an opacity slider.&nbsp; The</font> <font face="Courier"><b>alpha </b></font><font face="Times">method allows one to find out the current alpha level of the Color Panel based on its opacity slider.&nbsp; The</font> <font face="Courier"><b>isContinuous</b></font> <font face="Times">method returns whether or not colors are currently being set continuously.&nbsp; The</font> <font face="Courier"><b>mode</b></font> <font face="Times">method return what picker mode the Color Panel is currently in.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">NXColorWell</font></td></tr>

<tr valign=top>

<td width=72 height=16></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">The following methods have been added to NXColorWell:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- setBordered:(BOOL)<i>flag</i></font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (BOOL)isBordered</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">These enable the creation of color wells without a border (like the one in the NXColorPanel).</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">TextField</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">The following methods return the nextText and previousText instance variables of the receiver:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- nextText</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- previousText</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">TextField now overrides the cell method,</font> <font face="Courier"><b>drawCellInside:</b></font><font face="Times">.&nbsp; Additionally, TextFields now ensure that their opaque state matches that of their cells.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- drawCellInside:<i>aCell</i></font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Application</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">You can miniaturize all document windows in an application (i.e. all windows which appear in the Windows menu) via the following new method:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- miniaturizeAll:<i>sender</i></font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">Two methods have been added to suppress the normal window ordering and activation behavior that happens when the user clicks on a window, so that the source window doesn't jump to the front when the user tries to drag an item from it to another window. If a view has items that the user can drag to another window, the view should implement</font> <font face="Courier"><b>shouldDelayWindowOrderingForEvent:</b></font> <font face="Times">to return YES if the given event might initiate a drag.&nbsp; This method is called for every mouse down event that the view receives.&nbsp; Returning YES causes the normal window ordering and activation behavior that is performed in response to a mouse down to be delayed until the mouse is released.&nbsp; If the user does in fact drag the clicked on item, </font><font face="Courier"><b>preventWindowOrdering</b></font> <font face="Times">should be sent to prevent the pending ordering behavior from happening on the mouse up.&nbsp; Most applications will not need to send this message because the</font> <font face="Courier"><b>dragImage:</b></font> <font face="Times">method sends it when it initiates a dragging session.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (BOOL)shouldDelayWindowOrderingForEvent:(NXEvent *)<i>theEvent</i></font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- preventWindowOrdering</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">The following method should be used to indicate whether or not your application can deal with alpha components in the colors it receives from the user, or other applications (it has no effect on internal programmatic manipulations of colors).&nbsp; If this value is set to </font><font face="Courier"><b>YES</b></font><font face="Times">, then all colors your application receives (through color wells, ColorPanel, etc.) will be guaranteed to contain an alpha component, between 0 and 1.0.&nbsp; If you set this value to</font> <font face="Courier"><b>NO</b></font><font face="Times">, then every color your application receives will have an alpha component of </font><font face="Courier"><b>NX_NOALPHA</b></font><font face="Times">.&nbsp; Additionally, if this flag is set to</font> <font face="Courier"><b>NO</b></font><font face="Times">, if a ColorPanel is shown it will not have an opacity slider.&nbsp; The ColorPanel method</font> <font face="Courier"><b>setShowAlpha:</b></font> <font face="Times">can reverse the effects of&nbsp; the</font> <font face="Courier"><b>setImportAlpha:</b></font> <font face="Times">method, and the</font> <font face="Courier"><b>setImportAlpha:</b></font> <font face="Times">method can reverse the effects of</font> <font face="Courier"><b>setShowAlpha:</b></font><font face="Times">.</font>

<p><font face="Times">The default state is</font> <font face="Courier"><b>NO</b></font><font face="Times">, do not use alpha.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- setImportAlpha:(BOOL)<i>flag</i></font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">The following method returns the current, application-wide, &#34;importAlpha&#34; state, as set by either</font> <font face="Courier"><b>setImportAlpha:</b></font> <font face="Times">or NXColorPanel's</font> <font face="Courier"><b>setShowAlpha:</b></font> <font face="Times">method.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (BOOL)doesImportAlpha</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Workspace Protocol</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">Instead of using Speaker to communicate to the Workspace Manager (to do things like open files, etc.), in 3.0 you send the messages to an object which responds to the </font><font face="Courier"><b>NXWorkspaceRequest</b></font> <font face="Times">protocol found in</font> <font face="Courier"><b>workspaceRequest.h</b></font><font face="Times">.&nbsp; These methods have the same semantics as they did before 3.0, they are just in a nicer (not restricted by Speaker/Listener argument types) form.&nbsp; You get this object by sending the message</font> <font face="Courier"><b>workspace</b></font> <font face="Times">to the Application factory.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">Example of asking the Workspace for the icon for the file &#34;</font><font face="Courier">/x.draw</font><font face="Times">&#34;:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">NXImage *i = [[Application workspace] getIconForFile:&#34;/x.draw&#34;];</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">As part of this protocol, there are two new application delegate methods for finding out when various media (usually floppies or opticals) are mounted and unmounted.&nbsp; These complement the already existing</font> <font face="Courier"><b>unmounting:ok:</b></font> <font face="Times">method which is sent just before a device is unmounted so that applications can end all their accesses to that device. These are sent after a device has been mounted or unmounted.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (int)app:sender unmounted:(const char *)fullPath</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (int)app:sender mounted:(const char *)fullPath</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">To receive these messages, you must send </font><font face="Courier"><b>beginListeningForDeviceStatusChanges</b></font> <font face="Times">to [Application workspace].</font>

<p><font face="Times">Further, if you wish to hear about changes in the status of other applications, send the message</font> <font face="Courier"><b>beginListeningForApplicationStatusChanges</b></font> <font face="Times">to </font><font face="Courier"><b>[Application workspace]</b></font> <font face="Times">and your application delegate will receive:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- app:sender applicationWillLaunch:(const char *)appName</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- app:sender applicationDidLaunch:(const char *)appName</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- app:sender applicationDidTerminate:(const char *)appName</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">Finally, you can ask the Workspace to perform a file operation for you via the </font><font face="Courier"><b>[Application workspace]</b></font> <font face="Times">method ...</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (int)performFileOperation:(const char *)operation</font><br>
<img src="../Images/sp.gif" width=179 height=1><font face="Courier" size="-1">source:(const char *)source</font><br>
<img src="../Images/sp.gif" width=144 height=1><font face="Courier" size="-1">destination:(const char *)destination</font><br>
<img src="../Images/sp.gif" width=186 height=1><font face="Courier" size="-1">files:(const char *)files</font><br>
<img src="../Images/sp.gif" width=172 height=1><font face="Courier" size="-1">options:(const char *)options</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">This method returns 0 if the operation is synchronous and completed successfully.&nbsp; It returns a negative number if it fails.&nbsp; And if it returns a positive integer, that is a tag which will be sent back to you when the operation completes via the delegate method:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- app:sender fileOperationCompleted:(int)operation</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Font</font></td></tr>

<tr valign=top>

<td width=72 height=14></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">These methods return a particular size of the user's default font , the user's default fixed pitch font, the System Font, and the Bold System Font.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">If fontSize is 0, the defaults database is used to determine the size.&nbsp; Otherwise the passed value is used.&nbsp; fontMatrix is used as in the other Font new methods.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">Developers should use</font> <font face="Courier"><b>userFontOfSize:matrix:</b></font> <font face="Times">to init their new documents to the font the user has chosen in Preferences.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">+ userFontOfSize:(float)fontSize</font><br>
<img src="../Images/sp.gif" width=136 height=1><font face="Courier" size="-1">matrix:(const float *)fontMatrix;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">+ userFixedPitchFontOfSize:(float)fontSize</font><br>
<img src="../Images/sp.gif" width=136 height=1><font face="Courier" size="-1">matrix:(const float *)fontMatrix;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">+ systemFontOfSize:(float)fontSize</font><br>
<img src="../Images/sp.gif" width=136 height=1><font face="Courier" size="-1">matrix:(const float *)fontMatrix;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">+ boldSystemFontOfSize:(float)fontSize</font><br>
<img src="../Images/sp.gif" width=136 height=1><font face="Courier" size="-1">matrix:(const float *)fontMatrix;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">The font objects returned by these methods, when archived out will be replaced upon unarchiving by the system (or user or bold system or user fixed pitch) font <i>in effect at the time of unarchiving</i>.</font>

<p><font face="Times">The following methods have been added to Font to allow an app to set the user's default font &amp; the user's default fixed pitch font for that application:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">+ setUserFont:(Font *)<i>aFont</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">+ setUserFixedPitchFont:(Font *)<i>aFont</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">FontManager</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">It is now possible to filter the fonts which appear in the FontPanel via the FontManager delegate method:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (BOOL)fontManager:<i>sender</i></font><br>
<img src="../Images/sp.gif" width=136 height=1><font face="Courier" size="-1">willIncludeFont:(const char *)<i>fontName</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">The FontManager is also now subclassable.&nbsp; To do this, you must call the method:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">+ setFontManagerFactory:<i>factoryId</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">before loading your initial InterfaceBuilder file (which will, more than likely, try to instantiate the shared FontManager).</font>

<p><font face="Times">Two methods have been added to FontManager to round out all the possible conversions that can be made to a font via all the existing user-interface elements which can be used for that purpose (the FontPanel and the Font menu).&nbsp; By subclassing and overriding these (and the other convert: methods), you can track what modifications the user is making to fonts (for scripting or other purposes).</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- convert:<i>fontObj</i> toSize:(float)<i>size</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- convert:<i>fontObj</i> toFace:(const char *)<i>typeface</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">NXBrowser (and Matrix)</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">You can get the selected cells in a Matrix or NXBrowser by calling:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (List *)getSelectedCells:(List *)<i>aList</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">If</font> <font face="Courier"><i>aList</i></font> <font face="Times">is nil, the Matrix or NXBrowser will create a list for you.</font>

<p><font face="Times">Horizontal movement in the NXBrowser can now be done via a horizontal scroller rather than the left/right buttons on the left of the NXBrowser.&nbsp; There are six new methods to support his functionality:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- scrollViaScroller:<i>sender</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- updateScroller;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- setHorizontalScrollerEnabled:(BOOL)<i>flag</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (BOOL)isHorizontalScrollerEnabled;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- setHorizontalScrollButtonsEnabled:(BOOL)<i>flag</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (BOOL)areHorizontalScrollButtonsEnabled;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">The first is the target/action method sent by the scroller to the NXBrowser.&nbsp; The second can be used to redraw the scroller so that it accurately reflects the number of columns and firstVisibleColumn of the NXBrowser.&nbsp; The next two turn the horizontal scroller on and off.&nbsp; The last two are a replacement for</font> <font face="Courier"><b>hideLeftAndRightButtons:</b></font> <font face="Times">which is now obsolete.</font>

<p><font face="Times">The Matrix/NXBrowser methods</font> <font face="Courier"><b>allowEmptySel:</b></font><font face="Times">,</font> <font face="Courier"><b>allowMultiSel:</b></font> <font face="Times">and </font><font face="Courier"><b>allowBranchSel:</b></font> <font face="Times">have been renamed and have been complemented by methods to get the value of these various attributes.&nbsp; setEmptySelectionEnabled: has been added to NXBrowser.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- setMultipleSelectionEnabled:(BOOL)<i>flag</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (BOOL)isMultipleSelectionEnabled;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- setBranchSelectionEnabled:(BOOL)<i>flag</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (BOOL)isBranchSelectionEnabled;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- setEmptySelectionEnabled:(BOOL)<i>flag</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (BOOL)isEmptySelectionEnabled;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">The method:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- acceptArrowKeys:(BOOL)<i>flag</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">Has been renamed to support sending an action when navigating through the NXBrowser using the arrow keys:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- acceptArrowKeys:(BOOL)<i>flag</i> andSendActionMessages:(BOOL)<i>sFlag</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">A Control standard method was missing from NXBrowser.&nbsp; It has been added:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- selectedCell;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">NXColorPicking</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Courier"><b>NXColorPicking</b></font> <font face="Times">is the protocol which all custom picker objects which are inserted into the ColorPanel must conform to.&nbsp; Some, but not all of these methods have default implementations in the NXColorPicker class.&nbsp; Custom color pickers occupy the area in the ColorPanel which is below the &#34;picker mode&#34; buttons, and above the opacity slider. The definition of this protocol may be found in the file &#34;colorPicking.h&#34;.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">Custom color pickers are installed by 1) having a directory within the application's &#34;app wrapper&#34; named &#34;ColorPickers&#34;.&nbsp; Within this directory, there should be a separate directory for each custom picker to be installed.&nbsp; These directories should have the extension &#34;.bundle&#34;, and should contain, whatever resources are necessary for that particular picker (e.g. nib files, .tiff images, etc.).&nbsp; The prefix name of the directory should be the name of a class defined by the application, which conforms to the NXColorPicking protocol, and which has the same name as the prefix of the .bundle directory.&nbsp; This class should also be a subclass of &#34;NXColorPicker&#34;.&nbsp; For instance, if an application wants to install a custom picker named &#34;DiagramPicker&#34;, then in the .app directory of the application (Diagram.app) there would be a directory named &#34;ColorPickers&#34;, and within the ColorPickers directory there would be a directory named &#34;DiagramPicker.bundle&#34;.&nbsp; When the ColorPanel is instantiated, it will search for all the .bundle files found in the app's ColorPickers directory.&nbsp; For each .bundle found, it will instantiate (allocate) an object with the class name of the .bundle directory, and then send that newly allocated object an</font> <font face="Courier"><b>initFromPickerMask:withColorPanel: </b></font><font face="Times">message.&nbsp; So, in this example, the ColorPanel will essentially do:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">customPicker = [[MyPicker alloc]</font><br>
<img src="../Images/sp.gif" width=220 height=1><font face="Courier" size="-1">initFromPickerMask:someMask</font><br>
<img src="../Images/sp.gif" width=220 height=1><font face="Courier" size="-1">withColorPanel:self]</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">If no such class is found in the application, loading of the custom picker will be aborted. Once the controlling object has been instantiated, it will be sent a number of messages from the ColorPanel.&nbsp; These messages will continue to flow throughout the ColorPanel's lifetime.&nbsp; The custom picker can communicate to the ColorPanel using the ColorPanel's public API.&nbsp; If the custom picker needs to load .nib files, etc. (from its .bundle directory), or perform other initialization code, the </font><font face="Courier"><b>initFromPickerMask:withColorPanel:</b></font> <font face="Times">message is one time to do that. The other time do do initialization (preferred, because it's lazy), is the first time the </font><font face="Courier"><b>provideNewView:</b></font> <font face="Times">message is received.&nbsp; See below for more detail.</font>

<p><font face="Times"><b>The following methods are implemented, and derive default behavior from the NXColorPicker class:</b></font>

<p><font face="Times">This message is sent to installed objects when the ColorPanel is initializing.&nbsp;&nbsp; This method is the designated initializer of NXColorPicker, and of all custom color pickers. This notifies the picker of the mode mask specified by the caller of the ColorPanel method,</font> <font face="Courier"><b>setPickerMask:</b></font> <font face="Times">(or the default mask,</font> <font face="Courier"><b>NX_ALLMODESMASK</b></font><font face="Times">, if it has never been explicitly set).&nbsp; The return value of this init methods is an indication of whether or not your picker supports any of the modes listed in the mode mask.&nbsp; If your picker supports any of the bits in the mask, return &#34;self&#34;, otherwise, return</font> <font face="Courier"><b>nil</b></font> <font face="Times">(default NXColorPicker return value is &#34;self&#34;, since if the</font> <font face="Courier"><b>setPickerMask:</b></font> <font face="Times">method is never called, the ColorPanel will just start off with the normal picker modes, of which your custom mode will not be a part, but by returning &#34;self&#34;, the ColorPanel thinks you are part of the mask, and will continue to load this custom picker). This method can be used to turn off some (or all) of your subpickers, if you have any (like sliders), by seeing whether or not they are included in&nbsp; the mask.</font>&nbsp; <font face="Courier"><b><i>owningColorPanel</i></b></font> <font face="Times">is the id of the ColorPanel, which can be saved away for future use (this is normally done by the super's initFromPickerMask method).</font>

<p><font face="Times">This method also allows for object initialization, though most initialization (loading .nib files, etc.) should be done lazily, the first time</font> <font face="Courier"><b>provideNewView:</b></font> <font face="Times">is called.</font>

<p><font face="Times">This method rarely needs to be overriden, however, if it is, it should first call </font><font face="Courier"><b>initFromPickerMask:withColorPanel:</b></font> <font face="Times">in super, as this is when the instance variable &#34;colorPanel&#34; will get set, from the passed in</font> <font face="Courier"><b><i>owningColorPanel</i></b></font><font face="Times">.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- initFromPickerMask:(int)<i>mask</i> withColorPanel:<i>owningColorPanel</i></font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">The following message is sent to installed objects to request the name of the image they want loaded, for subsequent installation in their mode button in the ColorPanel.&nbsp; An NXImage should be returned by this method.&nbsp; The default action of NXColorPicker is to return an image&nbsp; found by loading a .tiff file from the picker's .bundle which has the name &#34;PickerClassName.tiff&#34; (in our above example it would be called &#34;DiagramPicker.tiff&#34;).&nbsp; This method rarely needs to be overriden.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- provideNewButtonImage</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">The following message is sent to installed objects to have the image, </font><font face="Courier"><b><i>newButtonImage</i></b></font><font face="Times">, inserted into the mode button for this picker.&nbsp; This provides a mechanism for special treatment, e.g. scaling the image first, etc.&nbsp; The default action of NXColorPicker is to insert this image in the button without any modification, using </font><font face="Courier"><b>setImage:</b></font><font face="Times">.&nbsp; This method rarely needs to be overriden.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- insertNewButtonImage:<i>newButtonImage</i> in:<i>newButton</i></font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">The next message is sent to installed objects when the ColorPanel view size changes. NXColorPicker does nothing when it receives this message, other than returning &#34;self&#34;. This method should be overriden by custom pickers if they have special preparation to do when they are resized.&nbsp; This method should be overridden, rather than </font><font face="Courier"><b>superViewSizeChanged:</b></font> <font face="Times">type methods.</font>&nbsp; <font face="Courier"><b><i>sender</i></b></font> <font face="Times">is the ColorPanel.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- viewSizeChanged:sender</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">The next message is sent to installed objects when the ColorPanel has been told to add or remove the alpha (opacity) slider.&nbsp; Upon receiving this message, custom pickers can determine the current state of the opacity slider by asking the ColorPanel (i.e. </font><font face="Courier"><b>[sender doesShowAlpha]</b></font><font face="Times">).&nbsp; The default action of NXColorPicker is to simply return &#34;self&#34;.&nbsp; This method rarely needs to be overriden.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- alphaControlAddedOrRemoved:<i>sender</i></font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">The</font> <font face="Courier"><b>insertionOrder</b></font> <font face="Times">method is sent to installed objects immediately after loading. The number returned by this method indicates the position in the ColorPanel's list of &#34;picker mode&#34; buttons where this picker's button should be installed.&nbsp; The standard pickers which come with the system have the following numbers:</font>

<p><img src="../Images/sp.gif" width=18 height=1><font face="Times">WheelPicker&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.50</font><br>
<img src="../Images/sp.gif" width=18 height=1><font face="Times">SliderPicker&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.51</font><br>
<img src="../Images/sp.gif" width=18 height=1><font face="Times">CustomPalettePicker&nbsp;&nbsp; 0.52</font><br>
<img src="../Images/sp.gif" width=18 height=1><font face="Times">List Picker&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.53</font>

<p><font face="Times">These values are #defined in NXColorPanel.h.&nbsp; The default action of NXColorPicker is to return 0.4, meaning that the custom picker will be inserted before the other pickers. If The picker is to be inserted, say, between the wheel and the slider picker, it could return 0.501.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (float)insertionOrder</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">The next message is sent to installed objects when the ColorPanel has been told, through its API (i.e. the ColorPanel method</font> <font face="Courier"><b>attachColorList:</b></font><font face="Times">) to add a ColorList.&nbsp; This notifies the picker of this.&nbsp; This message is used, for example, by the provided list mode picker, so that if a ColorList is added to the ColorPanel, that new ColorList will appear in the ColorList picker.&nbsp; The default action of NXColorPicker is to simply return &#34;self&#34;.&nbsp; This method rarely needs to be overriden.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- attachColorList:<i>colorList</i></font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">The next message is sent to installed objects when the ColorPanel has been told, through its API (i.e. the ColorPanel method</font> <font face="Courier"><b>detachColorList:</b></font><font face="Times">) to remove a ColorList.&nbsp; This notifies the picker of this.&nbsp; This message is used, for example, by the provided list mode picker, so that if a ColorList is removed from the ColorPanel, the removed ColorList will be removed from the ColorList picker.&nbsp; The default action of NXColorPicker is to simply return &#34;self&#34;.&nbsp; This method rarely needs to be overriden.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- detachColorList:<i>colorList</i></font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">This message is sent to installed objects when the ColorPanel has been told, through its API (i.e. the ColorPanel method</font> <font face="Courier"><b>setMode:</b></font><font face="Times">) to change the picker mode it is in.&nbsp; This notifies the picker of this.&nbsp; This message is used, for example, by the provided slider mode picker, which has submodes, so that it knows what submode to switch to.&nbsp; The default action of NXColorPicker is to simply return &#34;self&#34;.&nbsp; This method rarely needs to be overriden, as most ColorPickers only have one mode.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- setMode:(int)<i>mode</i></font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times"><b>The following methods MUST be implemented by the custom picker:</b></font>

<p><font face="Times">If your custom picker supports the mode specified by</font> <font face="Courier"><b><i>mode</i></b></font><font face="Times">, return</font> <font face="Courier"><b>YES</b></font><font face="Times">, otherwise return</font> <font face="Courier"><b>NO</b></font><font face="Times">.&nbsp; This method is called as a result of the ColorPanel being told, through its </font><font face="Courier"><b>setMode:</b></font> <font face="Times">API, to switch modes.&nbsp; It is also called when the ColorPanel first starts up, and tries to restore the user's last used mode.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (BOOL)supportsMode:(int)<i>mode</i></font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">Your custom picker should return an integer value that uniquely identifies what mode it is.&nbsp; This may be any integer value of your choice, though it normally should not conflict with one of the predefined and supplied modes, listed in NXColorPanel.h.&nbsp; This is the same integer which may get passed to you on a</font> <font face="Courier"><b>supportsMode:</b></font> <font face="Times">or</font> <font face="Courier"><b>setMode: </b></font><font face="Times">message.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (int)currentMode</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">The following message is sent by the ColorPanel when it is ready to display this picker. This might happen when the user switches pickers, when the ColorPanel first comes up, or when the mode is switched through the API.&nbsp; The ColorPanel also passes in a flag indicating whether or not this is the first time this object has been sent this message. This allows objects to load their UI elements in a lazy fashion (e.g. don't load .nib files, etc., until the first time this method is called).&nbsp; This method should return an id of a View or View subclass which will be inserted as a subview in the picker area of the ColorPanel.&nbsp; This view should typically be set to autoresize both its width and height.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- provideNewView:(BOOL)<i>initialRequest</i></font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">Finally this last message is sent by the ColorPanel when the color in its ColorWell changes (perhaps a color was dragged into the Well).&nbsp; Some pickers update their appearance to reflect the current color in the ColorPanel (for instance the position of slider knobs in the Slider mode of the ColorPanel), so this method provides them with a notification that it is time to update their current color.&nbsp; This method will be called whenever the ColorPanel's</font> <font face="Courier"><b>setColor:</b></font> <font face="Times">method is called, <i>even if ColorPanel's setColor method is called from this ColorPicker</i>, so in a typical implementation of this method, a check is should is done to see if the passed in color is actually different than the color that the picker is currently displaying.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- setColor:(NXColor)<i>newColor</i></font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Open/SavePanel</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">A new method has been added to the OpenPanel which causes file packages to be treated like directories (i.e. users can go into file packages, to, for example, look for .eps or .tiff files).</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- setTreatsFilePackagesAsDirectories:(BOOL)<i>flag</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (BOOL)doesTreatFilePackagesAsDirectories;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">You can use the OpenPanel to get the name of a directory from the user by calling the following method before running the panel.&nbsp; If the user is choosing directories, the </font><font face="Courier"><b>filterTypes</b></font> <font face="Times">of the OpenPanel are ignored and only directories will appear in the OpenPanel.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- chooseDirectories:(BOOL)<i>flag</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">You can control the ordering of files in the Open/SavePanel via the delegate method:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (int)panel:<i>sender</i></font><br>
<img src="../Images/sp.gif" width=122 height=1><font face="Courier" size="-1">compareFilenames:(const char *)<i>file1</i></font><br>
<img src="../Images/sp.gif" width=234 height=1><font face="Courier" size="-1">:(const char *)<i>file2</i></font><br>
<img src="../Images/sp.gif" width=171 height=1><font face="Courier" size="-1">checkCase:(BOOL)<i>caseSensitive</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">Do not do this lightly since it may confuse the user to have the files in one Open/SavePanel in a different order than those in other Open/SavePanels or in the WSM (the Open/SavePanels sort files in the same order as the WSM by default).&nbsp; Note that this will also slow down the operation of the panel somewhat.</font>

<p><font face="Times">You can now set the specific subclass of OpenPanel or SavePanel used when people call</font> <font face="Courier"><b>[OpenPanel new]</b></font> <font face="Times">or</font> <font face="Courier"><b>[SavePanel new]</b></font> <font face="Times">in your application.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">+ setOpenPanelFactory:<i>factoryId</i></font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">+ setSavePanelFactory:<i>factoryId</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Slider and SliderCell</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">The following method sets the background of a slider to the NXImage specified by the argument. If the provided image is scalable, then the cell will resize it to fit its bounds. Otherwise the image might either get clipped or not fill the whole slider.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- setImage:(NXImage *)<i>backgroundImage</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">The following methods allow changing the width (for horizontal sliders) or height (for vertical sliders) of the slider knob to the thickness specified by the argument.&nbsp; These methods are available to both Slider and SliderCell classes.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- setKnobThickness:(NXCoord)<i>newKnobThickness</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (NXCoord)knobThickness;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">The following methods have been added to allow developers to set Slider title text, text color, and text font.&nbsp; These methods are available to both Slider and SliderCell classes.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- setTitleGray:(float)<i>grayVal</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (float)titleGray;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- setTitleColor:(NXColor)<i>newColor</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (NXColor)titleColor;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- setTitleFont:<i>fontObj</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- titleFont;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- setTitle:(const char *)<i>aString</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- setTitleNoCopy:(const char *)<i>aString</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (const char *)title;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">The following methods have been added to allow developers to retrieve and/or modify the text cell used by a SliderCell (and hence by a Slider) to actually draw the text, and modify the text attributes.&nbsp; By default, this cell is a TextFieldCell.&nbsp; Additional text attributes may be set by getting the text cell, and modifying it directly, then redisplaying the slider.&nbsp; The first method, setTitleCell, will not free any existing titleCell, it will simply return the old one.&nbsp; These methods are available to both Slider and SliderCell classes.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- setTitleCell:<i>aCell</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- titleCell;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">The following methods have been added to SliderCell to set/get the amount the slider moves by when ALT is held down, these methods are only p[rovided in the SliderCell class, and not the Slider class:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- setAltIncrementValue:(double)<i>incValue</i></font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (double)altIncrementValue</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Window</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">A new delegate method has been added that is called when the user begins to drag a window.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- windowWillMove:<i>sender</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">New methods for setting the title and image in a miniwindow have been added:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- setMiniwindowImage:<i>image</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- setMiniwindowTitle:(const char *)<i>title</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (NXImage *)miniwindowImage;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (const char *)miniwindowTitle;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">The following method has been added to return whether flushing of the window's backing store is currently disabled.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=93 height=1><font face="Courier">- (BOOL)isFlushWindowDisabled</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">A method has been added that will order a window to the front of all windows in its tier, regardless of what app is active.&nbsp; Normally the system avoids putting windows on top of the key window, unless the window being ordered is in the same app as the key window.&nbsp; These checks are very important in multi-tasking system.&nbsp; This method bypasses these checks, and should be used <b>only</b> in rare cases where the app knows it should put its window above all others.&nbsp; One case might be when two apps are working together via a private protocol, and the active app is using the other app to display some data, yet wants to remain active.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=90 height=1><font face="Courier">- orderFrontRegardless;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">A method has been added to return the counterpart of a window.&nbsp; For most windows, this is the mini-window.&nbsp; If the mini-window has not been created, it returns nil.&nbsp; The counterpart of a mini-window is the corresponding normal window.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=90 height=1><font face="Courier">- counterpart;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">Methods have been added to set and return the backing store type of a window.&nbsp; These should be used instead of PSsetwindowtype().</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=90 height=1><font face="Courier">- setBackingType:(int)<i>bufferingType</i>;</font><br>
<img src="../Images/sp.gif" width=90 height=1><font face="Courier">- (int)backingType;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">Methods have been added to control whether a window's app is activated when the user clicks on a window.&nbsp; This can be useful for windows that are primarily controlled via the mouse, that interact with other applications.&nbsp; For example, a Panel owned by a Service provider may contain only mouse controls.&nbsp; It may be more convenient for the user to have the Service provider not activate when he uses that window, since he is repeatedly invoking the service from the already active Services client.&nbsp; Since this feature makes the window an exception to some of the normal rules windows follow, it should only be used in cases where it is well justified.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">- setAvoidsActivation:(BOOL)<i>flag</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (BOOL)avoidsActivation;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">The following methods allow setting minimum and maximum sizes:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- setMinSize:(const NXSize *)<i>frameSize</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- setMaxSize:(const NXSize *)<i>frameSize</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- getMinSize:(NXSize *)<i>frameSize</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- getMaxSize:(NXSize *)<i>frameSize</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">These methods set/get the minimum and maximum window <i>frame</i> rect sizes. These size limits will be used only in those cases where the delegate would have been consulted with the</font> <font face="Courier"><b>windowWillResize:to:</b></font> <font face="Times">method; first these size limits will be applied, then the delegate will be informed and given a chance to fix the size up further. These limits are <i>not</i> consulted if the window size is changed programmatically (for instance, through the</font> <font face="Courier"><b>sizeWindow::</b></font> <font face="Times">or</font> <font face="Courier"><b>placeWindow:</b></font> <font face="Times">methods).</font>

<p><font face="Times">Interface Builder provides support for setting the minimum size of a window from the Window inspector.&nbsp; Due to limitations in autosizing, contents of windows and panels which contain kit objects with autosizing parameters may get screwed up when they are sized very small. Giving such windows reasonable minimum sizes will solve this problem.</font>

<p><font face="Times">The following new methods provide easy ways to save/restore window positions:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (void)saveFrameUsingName:(const char *)<i>name</i></font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (BOOL)setFrameUsingName:(const char *)<i>name</i></font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">These methods let you save/restore the window's location and size. Typically you might use</font> <font face="Courier"><b>saveFrameUsingName:</b></font> <font face="Times">when a window is going away, and call </font><font face="Courier"><b>setFrameUsingName:</b></font> <font face="Times">right after it's recreated to put it back in the same location. The name argument provides the key with which the stored information is accessed; this name is specific to an application.</font>

<p><font face="Courier"><b>setFrameUsingName:</b></font> <font face="Times">will redisplay the window if it is on screen and the size is changed.&nbsp; The restored size is validated by comparing it against the window's min and max sizes and calling the delegate's</font> <font face="Courier"><b>windowWillResize:to:</b></font> <font face="Times">method. The return value for</font> <font face="Courier"><b>setFrameUsingName:</b></font> <font face="Times">indicates if a frame was found using the provided name.</font>

<p><font face="Times">If the screen on which the window's size was saved is different than the screen on which it's restored, the window will auto-position itself to look good.</font>

<p><font face="Times">The following method makes the window automatically save its position everytime its frame changes. When called with a non-NULL name, this method first retrieves its frame using the name,&nbsp; and then saves it on every change. When called with a NULL name, this method stops the automatic save. This works fine for panels and other non-document windows and it is recommended that apps use this functionality to remember panel positions:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (BOOL)setFrameAutosaveName:(const char *)<i>name</i></font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (const char *)frameAutosaveName;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">Finally a method is provided to remove any frame information associated with a name:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">+ (void)removeFrameUsingName:(const char *)<i>name</i></font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">The following two methods allow saving frame information in a string which can then be saved by the app in any suitable place (and not the defaults database, like the above methods do). The above methods work fine for panels and such but not for document windows (as it might be difficult to come up with unique names for documents). The following two allow saving position information with documents (if possible):</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (void)saveFrameToString:(char *)<i>string</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (void)setFrameFromString:(const char *)<i>string</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">These methods parallel the</font> <font face="Courier"><b>saveFrameUsingName:</b></font><font face="Times">/</font><font face="Courier"><b>setFrameUsingName: </b></font><font face="Times">pair. The string passed into</font> <font face="Courier"><b>saveFrameToString:</b></font> <font face="Times">should contain at least </font><font face="Courier"><b>NX_MAXFRAMESTRINGLENGTH</b></font> <font face="Times">characters; it will be terminated by a zero byte upon return. The app should save away the section upto the zero byte, not all </font><font face="Courier"><b>NX_MAXFRAMESTRINGLENGTH</b></font> <font face="Times">bytes.</font>

<p><font face="Times">A method has been added to find out what bucky-bits were down when a window resize was initiated by the user.&nbsp; This can be used to provide advanced, somewhat hidden functionality to power users.&nbsp; This method should be used with care because there is no way for the user to know in advance what the bucky bits might do when resizing.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">+ (int)resizeFlags;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Text</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">The following changes were made to enhance ruler in the Text object for international functionality - i.e., so it can be set to display centimeters and other units in addition to inches.&nbsp; the ruler looks at the</font> <font face="Courier"><b>NXMeasurementUnits</b></font> <font face="Times">default for its initial state.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (NXMeasurementUnit)setRulerUnits:(NXMeasurementUnit)<i>unit</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (NXMeasurementUnit)rulerUnits;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- toggleRulerUnits:<i>sender</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">The PageLayout panel has been enhanced to read the value of </font><font face="Courier"><b>NXMeasurementUnit</b></font> <font face="Times">from the defaults database, and to use it for initialization. The PageLayout&nbsp; panel does not set the value, however.&nbsp; (Preferences will be enhanced to change NXMeasurementUnit to appropriate international defaults.)</font>

<p><font face="Times">The following methods have been added to the Text object to query the color or gray of the selection or of a run.&nbsp; The color or gray of a selection is defined to be the color or gray of the first character in the selection or the color the next character typed will be if the selection is a blinking cursor.&nbsp; Note that</font> <font face="Courier"><b>selGray</b></font> <font face="Times">was unimplemented in release 2.1--it is now functional.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (NXColor)selColor;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (float)selGray;</font>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (float)runGray:(NXRun *)<i>run</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (NXColor)runColor:(NXRun *)<i>run</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">The ability to find text has been added to the Text object:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (BOOL)findText:(const char *)<i>textPattern</i></font><br>
<img src="../Images/sp.gif" width=150 height=1><font face="Courier" size="-1">ignoreCase:(BOOL)<i>ignoreCase</i></font><br>
<img src="../Images/sp.gif" width=157 height=1><font face="Courier" size="-1">backwards:(BOOL)<i>backwards</i></font><br>
<img src="../Images/sp.gif" width=192 height=1><font face="Courier" size="-1">wrap:(BOOL)<i>wrap</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">You can also locate a help marker (see NXHelpPanel description).&nbsp; The method returns whether or not the marker was found and, if it was found, it selects the text associated with it.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (BOOL)findMarker:(const char *)<i>markername</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">NXImage/NXImageRep</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">NXImage now provides a more generalized image file handling framework. Classes which follow the NXImageRep protocol and which can load images from files or streams can register themselves with NXImage, allowing NXImage to automatically create and use instances of these classes much in the same way it did with NXBitmapImageRep and NXEPSImageRep in 2.0.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">The following two methods allow registering/unregistering image reps. Requests to register a class twice or unregister a class which isn't registered will be ignored without an error:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">+ (void)registerImageRep:(Class)<i>imageRepClass</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">+ (void)unregisterImageRep:(Class)<i>imageRepClass</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">A good place for classes to register themselves is the</font> <font face="Courier"><b>+load</b></font> <font face="Times">method.</font>

<p><font face="Times">The following methods will return the appropriate registered class. Note that for </font><font face="Courier"><b>imageRepForStream:</b></font> <font face="Times">to work, the stream should be seekable; otherwise an error will be raised.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">+ (Class)imageRepForFileType:(const char *)<i>type</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">+ (Class)imageRepForPasteboardType:(NXAtom)<i>type</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">+ (Class)imageRepForStream:(NXStream *)<i>stream</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">The following method returns a</font> <font face="Courier"><b>NULL</b></font><font face="Times">-terminated list of file types which all the image reps registered with NXImage can load from. This list belongs to the NXImage and should not be freed or changed:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">+ (const char *const *)imageUnfilteredFileTypes;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">There is also a parallel for returning the supported pasteboard types:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">+ (const NXAtom *)imageUnfilteredPasteboardTypes;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">These lists contain all types directly supported by the registered image reps. NXImage builds these lists by calling methods of the same name in all of its registered image rep classes. Thus, in order to provide NXImage with the information on what types are supported, every subclass of NXImageRep that gets registered with NXImage needs to implement the two methods</font> <font face="Courier"><b>imageUnfilteredFileTypes</b></font> <font face="Times">and </font><font face="Courier"><b>imageUnfilteredPasteboardTypes.</b></font> <font face="Times">As is the case with NXImage, these return</font> <font face="Courier"><b>NULL</b></font><font face="Times">-terminated lists of strings.</font>

<p><font face="Times">For instance, NXBitmapImageRep might define</font> <font face="Courier"><b>imageUnfilteredFileTypes </b></font><font face="Times">as:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">+ (const char *const *)imageUnfilteredFileTypes</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">{</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">static const char *const types[] = {&#34;tiff&#34;, &#34;tif&#34;, NULL};</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">return types;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">}</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">The list</font> <font face="Courier"><b>{NULL}</b></font> <font face="Times">should be returned in case a class does not recognize any file or pasteboard types.&nbsp; If a subclass of a subclass of NXImageRep is willing to support the types supported by the superclass, then it should declare them in addition to its own types. This can be done by getting the types supported from the superclass and actually building and caching a local list at runtime, augmenting it with it the additional types.</font>

<p><font face="Times">There are also parallel sets of methods in NXImage and NXImageRep which return all types that can be opened, including those accessible through the use of filter services. (See elsewhere for discussion of filter services.)&nbsp; These methods are:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">+ (const char *const *)imageFileTypes;</font>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">+ (const NXAtom *)imagePasteboardTypes;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">These methods are implemented in both NXImage and NXImageRep and there is no need for NXImageRep subclasses to implement them. Because these methods return </font><font face="Courier"><b>NULL</b></font><font face="Times">-terminated lists of strings, the return values can be passed directly into the OpenPanel</font> <font face="Courier"><b>runModalForTypes:</b></font> <font face="Times">method. In fact, most applications which accept images (either through the OpenPanel or through dragging) and use NXImage to open them should switch over from using a hardwired list such as</font> <font face="Courier"><b>{&#34;tiff, &#34;eps&#34;, NULL}</b></font> <font face="Times">to using one of these two methods.</font>

<p><font face="Times">The following NXImageRep method allows NXImage to determine if a registered image rep can load an image from a given stream. This method should look at the stream to see if it contains a valid image. The stream pointer should be left at where it was on entry:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">+ (BOOL)canLoadFromStream:(NXStream *)<i>stream</i></font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">Two other new methods in NXImage and NXImageRep are:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">+ (BOOL)canInitFromPasteboard:(Pasteboard *)<i>pasteboard</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- initFromPasteboard:(Pasteboard *)<i>pasteboard</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">These methods can be used to initialize NXImages and NXImageReps from a pasteboard.&nbsp; Data can come from a supported pasteboard type (such as TIFF or EPS) or a file name type containing a file name which can be filtered to a supported pasteboard type.</font>

<p><font face="Times">This next method allows NXImage to load representations from a file:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (BOOL)loadFromFile:(const char *)<i>fileName</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">This method is essentially a short cut to opening a stream on the specified file and calling</font> <font face="Courier"><b>loadFromStream:</b></font><font face="Times">. Thus the data is loaded immediately (rather than lazily, which is what</font> <font face="Courier"><b>useFromFile:</b></font><font face="Times">and</font> <font face="Courier"><b>initFromFile:</b></font> <font face="Times">do) and the file name is not remembered.</font>

<p><font face="Times">Note that NXImage can use filters only when typed data is available--for instance when an image is loaded from a file (using methods such as</font> <font face="Courier"><b>initFromFile:</b></font><font face="Times">, </font><font face="Courier"><b>loadFromFile:</b></font><font face="Times">, etc.) or from a pasteboard (with</font> <font face="Courier"><b>initFromPasteboard:</b></font><font face="Times">). Images loaded from streams cannot be filtered as no type information is available to aid in choosing the right filter. If you load images into NXImages from streams which you create yourself, you can just switch over to using</font> <font face="Courier"><b>loadFromFile:</b></font><font face="Times">, which will map the file in (filtering if necessary) into a stream and use</font> <font face="Courier"><b>loadFromStream:</b></font> <font face="Times">to read the data in.</font>

<p><font face="Times">On a somewhat unrelated note, NXImage and NXCachedImageRep now have </font><font face="Courier"><b>copyFromZone:</b></font> <font face="Times">methods. This allows NXImages to be copied.</font>

<p><font face="Times">And, finally, another new method in NXImage is the following, which allows you to specify the compression type &amp; factor when writing an NXImage to a TIFF file. </font><font face="Courier"><b>writeTIFF:allRepresentations:</b></font> <font face="Times">now calls this method.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">- writeTIFF:(NXStream *)<i>stream</i></font><br>
<img src="../Images/sp.gif" width=143 height=1><font face="Courier" size="-1">allRepresentations:(BOOL)<i>flag</i></font><br>
<img src="../Images/sp.gif" width=157 height=1><font face="Courier" size="-1">usingCompression:(int)<i>compression</i></font><br>
<img src="../Images/sp.gif" width=206 height=1><font face="Courier" size="-1">andFactor:(float)<i>aFloat</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">NXBitmapImageRep</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">NXBitmapImageRep factory now has methods to indicate whether the app can deal with unpacked image data:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">+ (void)setUnpackedImageDataAcceptable:(BOOL)<i>flag</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">+ (BOOL)isUnpackedImageDataAcceptable;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">Unpacked images have non-default bytesPerRow and/or bitsPerPixel values. The 3.0 WindowServer can generate such images and NXBitmapImageRep can store them; however, such an image will never be given back to a client which is not expecting it.</font>

<p><font face="Times">An app linked against a pre-3.0 shlib is never given unpacked data; an app linked with a 3.0 shlib is assumed to be capable of dealing with it. The </font><font face="Courier"><b>setUnpackedImageDataAcceptable:</b></font> <font face="Times">method or the </font><font face="Courier"><b>NXUnpackedImageDataAcceptable</b></font> <font face="Times">default can be used to override this behaviour.</font>

<p><font face="Times">It's often more efficient to leave unpacked images unpacked; thus applications should pay attention to</font> <font face="Courier"><b>bytesPerRow</b></font> <font face="Times">and</font> <font face="Courier"><b>bitsPerPixel</b></font> <font face="Times">when traversing image data. When an unpacked image is written out to a TIFF file or printed a packed copy will be used (as TIFF and PostScript print jobs are not capable of dealing with unpacked data); this packing takes place automatically.</font>

<p><font face="Times">There are some constraints on the format of unpacked data; please refer to the discussion on</font> <font face="Courier"><b>NXDrawBitmap()</b></font> <font face="Times">elsewhere in this document and the window server notes for more information if you wish to create and manipulate your own unpacked images.</font>

<p><font face="Times">In 3.0 NXBitmapImageReps loaded from TIFF files remember their compression type. Methods are provided to change the compression:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (void)getCompression:(int *)<i>compression</i></font><br>
<img src="../Images/sp.gif" width=197 height=1><font face="Courier" size="-1">andFactor:(float *)<i>factor</i>;</font>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (void)setCompression:(int)<i>compression</i></font><br>
<img src="../Images/sp.gif" width=197 height=1><font face="Courier" size="-1">andFactor:(float)<i>factor</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Courier"><b>writeTIFF:</b></font> <font face="Times">(without the explicit</font> <font face="Courier"><b>compression:andFactor:</b></font> <font face="Times">arguments) will use the stored compression when saving. This behaviour is changed from 2.0 where </font><font face="Courier"><b>writeTIFF:</b></font> <font face="Times">would use no compression. The benefit is that if a compressed image is read in and later saved, its compression will be preserved. If the image cannot be written out with the compression that is provided (this could happen with compressions no longer supported, such as the NEXTSTEP 1.0 2-bit encoding), then</font> <font face="Courier"><b>writeTIFF: </b></font><font face="Times">will use no compression.</font>

<p><font face="Times">The following methods were added to give developers information about what TIFF compression types are available and which ones are applicable to a given image. Because not all compression types can be used with all images and because future releases of NEXTSTEP may bring along other compression types, these methods should be used whenever an application wants to put up some UI to let the user choose a compression type for an image.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">+ (void)getTIFFCompressionTypes:(const int **)<i>compList</i></font><br>
<img src="../Images/sp.gif" width=290 height=1><font face="Courier" size="-1">count:(int *)<i>numTypes</i>;</font>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">+ (const char *)localizedNameForTIFFCompressionType:(int)<i>comp</i>;</font>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (BOOL)canBeCompressedUsing:(int)<i>comp</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">The first method above returns a pointer to an array of ints containing all available compression types that can be used when writing a TIFF image. These compression types are currently defined in tiff.h. The list argument belongs to NXBitmapImageRep and should not be freed or altered. It points to an array of</font> <font face="Courier"><b>numTypes</b></font> <font face="Times">ints.</font>

<p><font face="Times">The</font> <font face="Courier"><b>localizedNameForTIFFCompressionType:</b></font> <font face="Times">method returns the localized name for the specified compression type.</font> <font face="Courier"><b>NULL</b></font> <font face="Times">will be returned if the compression type is not recognized. The returned string should not be freed or altered in any way.</font>

<p><font face="Times">The last method,</font>&nbsp; <font face="Courier"><b>canBeCompressedUsing:</b></font><font face="Times">, allows asking an instance of NXBitmapImageRep if it can be compressed with specified compression type.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Pasteboard</font></td></tr>

<tr valign=top>

<td width=72 height=16></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">The owner of a pasteboard can implement the following method to find out when he loses ownership of the pasteboard.&nbsp; The owner is not able to read the contents of the pasteboard he owned when responding to this method.&nbsp; The owner should be prepared to receive this method at any time, even in from within the </font><font face="Courier"><b>declareTypes:num:owner:</b></font> <font face="Times">he uses to declare his ownership.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- pasteboardChangedOwner:<i>sender</i></font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">The following method has been added to deallocate data returned by </font><font face="Courier"><b>readType:data:length:</b></font><font face="Times">.&nbsp; This method should <b>always</b> be used to free Pasteboard data returned by that method (i.e. do <b>not</b> use</font> <font face="Courier"><b>vm_deallocate()</b></font><font face="Times">):</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- deallocatePasteboardData:(char *)<i>data</i></font><br>
<img src="../Images/sp.gif" width=248 height=1><font face="Courier" size="-1">length:(int)<i>numBytes</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">A convenience method has been added to scan the available types for one you want.&nbsp; It returns the first type in the</font> <font face="Courier"><b><i>types</i></b></font> <font face="Times">that you supply that is available in the Pasteboard:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (const char *)findAvailableTypeFrom:(const char *const *)<i>types</i></font><br>
<img src="../Images/sp.gif" width=346 height=1><font face="Courier" size="-1">num:(int)<i>numTypes</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">The following method allows you to add types to the list previously declared by using the existing Pasteboard method</font> <font face="Courier"><b>declareTypes:num:owner:</b></font><font face="Times">.&nbsp; It can be useful when subclassing</font> <font face="Courier"><b>copy</b></font> <font face="Times">methods, or when multiple modules need to contribute data to a single</font> <font face="Courier"><b>copy</b></font><font face="Times">.&nbsp; It should only be sent when you know that a </font><font face="Courier"><b>declareTypes:num:owner:</b></font> <font face="Times">has already been sent for the particular copy operation.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (int)addTypes:(const char *const *)<i>newTypes</i></font><br>
<img src="../Images/sp.gif" width=192 height=1><font face="Courier" size="-1">num:(int)<i>numTypes</i></font><br>
<img src="../Images/sp.gif" width=178 height=1><font face="Courier" size="-1">owner:<i>newOwner</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">Another convenience method for getting data from a stream into the Pasteboard has been added.&nbsp; It takes the data from the stream and inserts it into the receiver under the given</font> <font face="Courier"><b><i>dataType</i></b></font><font face="Times">.&nbsp; The</font> <font face="Courier"><b>stream</b></font> <font face="Times">must be readable.&nbsp; If it is seekable, the</font> <font face="Courier"><b>stream</b></font> <font face="Times">is seeked back to the start before the data is read; otherwise, data is read from the current position until the end of the</font> <font face="Courier"><b>stream</b></font><font face="Times">.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- writeType:(const char *)<i>dataType</i></font><br>
<img src="../Images/sp.gif" width=122 height=1><font face="Courier" size="-1">fromStream:(NXStream *)<i>stream</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">A similar method get data out of the Pasteboard into a stream.&nbsp; <i>Be sure to deallocate the stream returned with</i></font> <font face="Courier">NXCloseMemory(stream, NX_FREEBUFFER)</font><font face="Times">.&nbsp; You do not need to send the</font> <font face="Courier">deallocatePasteboardData:</font> <font face="Times">message with the stream data.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (NXStream *)readTypeToStream:(const char *)<i>dataType</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">A new method has been added to the Pasteboard which returns an instance of a Pasteboard with a name that is guaranteed to be unique with respect to other Pasteboards on the system.&nbsp; This would only be used by applications doing their own IPC using pasteboards to pass data.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">+ newUnique;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">View</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">A new method in View has been added as a convenience for copying EPS to the pasteboard.&nbsp; It writes the EPS representing an image of the receiver to the pasteboard under the EPS pasteboard type.&nbsp; If passed</font> <font face="Courier"><b>NULL</b></font> <font face="Times">for the rectangle, EPS for the entire view is generated.&nbsp; The caller should first use the</font> <font face="Courier"><b>declareTypes:num:owner: </b></font><font face="Times">Pasteboard method in the standard way.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- writePSCodeInside:(const NXRect *)<i>copyArea</i></font><br>
<img src="../Images/sp.gif" width=227 height=1><font face="Courier" size="-1">to:<i>pasteboard</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">A method to return the autosizing parameters of a View has been added:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=129 height=1><font face="Courier" size="-1">- (unsigned int)autosizing;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">A method has been added which allows the developer to send a fax without putting up the fax panel UI:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- faxPSCode:<i>sender</i></font><br>
<img src="../Images/sp.gif" width=143 height=1><font face="Courier" size="-1">toList:(const char *const *)<i>names</i></font><br>
<img src="../Images/sp.gif" width=115 height=1><font face="Courier" size="-1">numberList:(const char *const *)<i>numbers</i></font><br>
<img src="../Images/sp.gif" width=143 height=1><font face="Courier" size="-1">sendAt:(time_t)<i>when</i></font><br>
<img src="../Images/sp.gif" width=115 height=1><font face="Courier" size="-1">wantsCover:(BOOL)<i>cFlag</i></font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">wantsNotify:(BOOL)<i>nFlag</i></font><br>
<img src="../Images/sp.gif" width=115 height=1><font face="Courier" size="-1">wantsHires:(BOOL)<i>hFlag</i></font><br>
<img src="../Images/sp.gif" width=136 height=1><font face="Courier" size="-1">faxName:(const char *)<i>aString</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">PrintInfo/PrintPanel</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">The</font> <font face="Courier"><b>NXPrinter</b></font> <font face="Times">object associated with the</font> <font face="Courier"><b>PrintInfo</b></font> <font face="Times">should be used to get/set information which used to be accessed via methods like</font> <font face="Courier"><b>setManualFeed:</b></font><font face="Times">.&nbsp; These new methods have been added to access the</font> <font face="Courier"><b>NXPrinter</b></font><font face="Times">:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- setPrinter:(NXPrinter *)<i>pr</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (NXPrinter *)printer;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- initializeJobDefaults;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Courier"><b>PrintInfo</b></font> <font face="Times">has a number of other new features.&nbsp; It provides and sets the default </font><font face="Courier"><b>NXPrinter</b></font> <font face="Times">object.&nbsp; New methods:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">+ (NXPrinter *)getDefaultPrinter;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">+ setDefaultPrinter:(NXPrinter *)<i>pr</i>;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">Methods have been added to</font> <font face="Courier"><b>PrintInfo</b></font> <font face="Times">to specify whether the generated page order should be &#34;normal&#34; or &#34;reversed&#34;.&nbsp; Normal page order depends on the device that is being output to.&nbsp; &#34;Save&#34; is done first-to-last, as are some printers.&nbsp; The NeXT Laser Printer is done last-to-first.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- setReversePageOrder:(BOOL)<i>flag</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (BOOL)reversePageOrder;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Courier"><b>PrintInfo</b></font> <font face="Times">also supports printer-specific PostScript operations using PPD info. These are called &#34;job features&#34;, and include manual feed, setting resolution, page size, and others.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- setJobFeature:(const char *)<i>feature</i></font><br>
<img src="../Images/sp.gif" width=164 height=1><font face="Courier" size="-1">toValue:(const char *)<i>string</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (const char *)valueForJobFeature:(const char *)<i>feature</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- setJobFeature:(const char *)<i>feature</i></font><br>
<img src="../Images/sp.gif" width=136 height=1><font face="Courier" size="-1">toValueList:(const char *const *)<i>list</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (const char **)valueListForJobFeature:(const char *)<i>feature</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- removeJobFeature:(const char *)<i>feature</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (const char *const *)<i>jobFeatures</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- setPaperFeed:(const char *)str;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (const char *)paperFeed;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">The following two methods have been added to the PrintPanel.&nbsp; They can be called to update the PrintPanel from its PrintInfo (or write out the changes in the PrintPanel to its PrintInfo).</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- updateFromPrintInfo;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- finalWritePrintInfo;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Matrix</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">It is now possible to do &#34;drag selection&#34; in Matrix programatically via the method:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=129 height=1><font face="Courier" size="-1">- setSelectionFrom:(int)startPos</font><br>
<img src="../Images/sp.gif" width=241 height=1><font face="Courier" size="-1">to:(int)endPos</font><br>
<img src="../Images/sp.gif" width=213 height=1><font face="Courier" size="-1">anchor:(int)anchorPos</font><br>
<img src="../Images/sp.gif" width=234 height=1><font face="Courier" size="-1">lit:(BOOL)lit;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">Drag selection in Matrix now works in a visual fashion (i.e. the user will drag out rectangular regions) rather than on a row-oriented basis.&nbsp; The old behaviour is still available, but applications must call</font> <font face="Courier"><b>setSelectionByRect:NO</b></font> <font face="Times">to turn off this behaviour:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- setSelectionByRect:(BOOL)<i>flag</i>;</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">- (BOOL)isSelectionByRect;</font>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=36></td>

<td><font face="Times"><b>New Functions</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Alert</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">A new, localizable version of</font> <font face="Courier">NXRunAlertPanel()</font> <font face="Times">has been added to the kit:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">int NXRunLocalizedAlertPanel(</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">const char *<i>table</i>,</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">const char *<i>title</i>,</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">const char *<i>s</i>,</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">const char *<i>first</i>,</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">const char *<i>second</i>,</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">const char *<i>third</i>, <i>...</i>,</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">const char *<i>comment</i></font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">);</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">The</font> <font face="Courier"><b>genstrings</b></font> <font face="Times">program will generate an appropriate entry in the strings file </font><font face="Courier"><i>table</i></font> <font face="Times">with the comment</font> <font face="Courier"><i>comment</i></font> <font face="Times">and translation entries for each of the items.&nbsp; This only works, of course, for literal string arguments and will obviously not translate the &#34;</font><font face="Courier"><i>...</i></font><font face="Times">&#34; arguments.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Imaging functions</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">The following function is a cover for the new window-to-window imaging feature in the WindowServer:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">extern void NXCopyBitmapFromGState(int <i>srcGState</i>,</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">const NXRect *<i>srcRect</i>,</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">const NXRect *<i>destRect</i>);</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">Bits from the rectangle specified by</font> <font face="Courier"><b><i>srcRect</i></b></font> <font face="Times">in the source graphics state </font><font face="Courier"><b><i>srcGState</i></b></font> <font face="Times">will be imaged into the destination rectangle specified by</font> <font face="Courier"><b><i>destRect</i></b></font> <font face="Times">in the current graphics state.</font>

<p><font face="Times">NXCachedImageRep's</font> <font face="Courier"><b>draw</b></font> <font face="Times">and NXImage's</font> <font face="Courier"><b>setSize:</b></font> <font face="Times">methods now also take advantage of this functionality whenever possible and thus are considerably faster under the right circumstances.</font>

<p><font face="Times">The following function,</font> <font face="Courier"><b>NXDrawBitmap()</b></font><font face="Times">, replaces</font> <font face="Courier"><b>NXImageBitmap()</b></font><font face="Times">. Two additional arguments (</font><font face="Courier"><b><i>bytesPerRow</i></b></font> <font face="Times">and</font> <font face="Courier"><b><i>bitsPerPixel</i></b></font><font face="Times">) are provided and the existing arguments have been cleaned up to take new-style image parameters (</font><font face="Courier"><b><i>colorSpace</i></b></font><font face="Times">,</font> <font face="Courier"><b><i>isPlanar</i></b></font><font face="Times">, and</font> <font face="Courier"><b><i>hasAlpha</i></b></font> <font face="Times">instead of</font> <font face="Courier"><b><i>photoInt</i></b></font> <font face="Times">and </font><font face="Courier"><b><i>planarConfig</i></b></font><font face="Times">).</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">extern void NXDrawBitmap(</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">const NXRect *<i>rect</i>,</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">int <i>pixelsWide</i>,</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">int <i>pixelsHigh</i>,</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">int <i>bitsPerSample</i>,</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">int <i>samplesPerPixel</i>,</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">int <i>bitsPerPixel</i>,</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">int <i>bytesPerRow</i>,</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">BOOL <i>isPlanar</i>,</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">BOOL <i>hasAlpha</i>,</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">NXColorSpace <i>colorSpace</i>,</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">const unsigned char *const <i>data</i>[5]</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">);</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">When converting any existing calls to</font> <font face="Courier"><b>NXImageBitmap()</b></font> <font face="Times">to</font> <font face="Courier"><b>NXDrawBitmap()</b></font><font face="Times">, you can use the following mapping from the old style arguments to the new style arguments:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">isPlanar&nbsp;&nbsp;&nbsp;&nbsp; = (planarConfig == NX_PLANAR) ? YES : NO;</font>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">hasAlpha&nbsp;&nbsp;&nbsp;&nbsp; = ((photoInt &amp; NX_ALPHAMASK) != 0) ? YES : NO;</font>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">colorSpace&nbsp;&nbsp; = ((photoInt &amp; 3) == 3) ? NX_CMYKColorSpace :</font><br>
<img src="../Images/sp.gif" width=220 height=1><font face="Courier" size="-1">(photoInt &amp; 3);</font>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">data&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = {data1, data2, data3, data4, data5};</font>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">bitsPerPixel = bitsPerSample *</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">((planarConfig == NX_PLANAR) ? 1 : samplesPerPixel);</font>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">bytesPerRow&nbsp; = (7 + pixelsWidth * bitsPerSample *</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">((planarConfig == NX_PLANAR) ? 1 : samplesPerPixel)) / 8;</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">The</font> <font face="Courier"><b><i>colorSpace</i></b></font> <font face="Times">argument to</font> <font face="Courier"><b>NXDrawBitmap()</b></font> <font face="Times">can be </font><font face="Courier"><b>NX_CustomColorSpace</b></font><font face="Times">, indicating that the image data is to be interpreted according to the current color space in the PostScript graphics state. This allows for imaging using custom color spaces. The image parameters supplied as the other arguments should match what the color space is expecting.</font>

<p><font face="Times">If the image data is planar,</font> <font face="Courier"><b><i>data</i>[0]</b></font> <font face="Times">through</font> <font face="Courier"><b><i>data</i>[spp-1]</b></font> <font face="Times">point to the planes; if the data is meshed, only</font> <font face="Courier"><b><i>data</i>[0]</b></font> <font face="Times">needs to be set.</font>

<p><font face="Times">Under 3.0, there are some restrictions on</font> <font face="Courier"><b><i>bytesPerRow</i></b></font> <font face="Times">and</font> <font face="Courier"><b><i>bitsPerPixel </i></b></font><font face="Times">arguments; please refer to the window server notes for details. Also, any unused space within a pixel (which happens if</font> <font face="Courier"><b><i>bitsPerPixel</i></b></font> <font face="Times">is greater than </font><font face="Courier"><b><i>samplesPerPixel</i></b></font> <font face="Times">*</font> <font face="Courier"><b><i>bitsPerSample</i></b></font><font face="Times">) should be filled with ones; this will be the case by default for images read back from the window server, but not images you create yourself. This requirement doesn't apply to unused space at the end of scanlines (which happens when</font> <font face="Courier"><b><i>bytesPerRow</i></b></font> <font face="Times">is different than the default value).</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">NXColor</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">The following functions have been added to get the list and color names of named colors. (Please refer to the discussion on NXColorList for more information on named colors.) These functions return</font> <font face="Courier"><b>NULL</b></font> <font face="Times">if the color is not named. Under 3.0, only lists such as PANTONE (and similar lists which maybe be created manually), generate named colors; other colors will not remember their names.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">const char *NXColorListName (NXColor <i>color</i>);</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">const char *NXColorName (NXColor <i>color</i>);</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">The following function allows getting a color given a list and color name. NO will be returned if</font> <font face="Courier"><b><i>listName</i></b></font> <font face="Times">and</font> <font face="Courier"><b><i>colorName</i></b></font> <font face="Times">do not refer to any color.</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">BOOL NXFindColorNamed (</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">const char *<i>listName</i>,</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">const char *<i>colorName</i>,</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">NXColor *<i>color</i></font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">);</font>

<p><br>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Reading a pixel</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Courier"><b>NXReadPixel()</b></font> <font face="Times">will read the color from the specified pixel of the currently lockfocus'ed view, for example:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">if ([myNXImage lockFocus]) {</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">NXSize imageSize;</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">NXPoint centerPoint;</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">NXColor centerColor;</font>

<p><img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">[myNXImage getSize:&amp;imageSize];</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">centerPoint.x = floor(imageSize.width / 2);</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">centerPoint.y = floor(imageSize.height / 2);</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">centerColor = NXReadPixel(&amp;centerPoint);</font>

<p><img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">[myNXImage unlockFocus];</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">}</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">This function will always convert the point into screen coordinates, round down to the nearest pixel (if necessary), and then take the pixel encompassed by a 1 X 1 rectangle with the specified point being the lower-left origin.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Services</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">To invoke a Services Menu services programatically, use the function:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">BOOL NXPerformService(const char *<i>itemName</i>, Pasteboard *<i>pboard</i>);</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">It returns whether the service was successfully performed.</font>&nbsp; <font face="Courier"><i>itemName</i></font> <font face="Times">is a Services menu item (in any language).&nbsp; Note that Services menu entries which are in subdirectories must include a slash wherever there is a subdirectory, e.g., &#34;</font><font face="Courier">Mail/Selection</font><font face="Times">&#34;.&nbsp; The</font> <font face="Courier"><i>pboard</i></font> <font face="Times">must include the requisite data which feeds the services and, upon return of the function, will contain the resultant data provided by the service provider.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">DPSClient/pswrap</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">Single operator wraps have been added for all level 2 operators.</font></td></tr>

<tr valign=top>

<td width=72 height=16></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Courier"><b>DPSAsynchronousWaitContext()</b></font> <font face="Times">has been added to allow a client to learn asynchronously when all PostScript code it has generated has been executed.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">Wraps that take</font> <font face="Courier"><b>numstring</b></font> <font face="Times">arguments will now produce PostScript that will work on all PostScript printers, so it is no longer necessary to have separate versions of these wraps for printing.</font>&nbsp; <font face="Courier"><b>DPSWriteNumString()</b></font> <font face="Times">has been added to to support pswrap's sending of encoded number strings.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Courier"><b>DPSSendPort()</b></font> <font face="Times">has been added to send a tagged port to the Window Server using </font><font face="Courier"><b>DPSSendTaggedMsg()</b></font><font face="Times">.&nbsp; It is used to communicate a port to PostScript operators that receive a port via that tagged message mechanism.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Courier"><b>DPSAddNotifyPortProc()</b></font> <font face="Times">and</font> <font face="Courier"><b>DPSRemoveNotifyPortProc()</b></font> <font face="Times">have been added to allow an application to filter messages received on the task's notify port. Procedures registered in this way should check all notify messages they are passed to be sure they pertain to the ports they are interested in.&nbsp; Clients that previously passed the notify port to</font> <font face="Courier"><b>DPSAddPort</b></font> <font face="Times">should switch to this API.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">The function</font> <font face="Courier"><b>DPSCreateNonsecureContext()</b></font> <font face="Times">has been added to allow the creation of DPS contexts that are able to to write files.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">A new function</font> <font face="Courier"><b>DPSSynchronizeContext()</b></font><font face="Times">.&nbsp; If called with</font> <font face="Courier"><b>YES</b></font><font face="Times">, a </font><font face="Courier"><b>DPSWaitContext()</b></font> <font face="Times">will be performed after every pswrap that is executed.&nbsp; The default</font> <font face="Courier"><b>NXSyncPS</b></font> <font face="Times">is automatically passed to this function.&nbsp; This is useful in conjunction with</font> <font face="Courier"><b>NXShowPS</b></font> <font face="Times">when debugging PS errors, since it allows you to isolate the piece of PS causing the error.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">The function</font> <font face="Courier"><b>DPSSendTaggedMsg()</b></font> <font face="Times">has been added.&nbsp; It is used to send a Mach message to the Window Server on behalf of a DPSContext.&nbsp; It is used in conjunction with certain PostScript operators that operate on Mach ports or out-of-line data. Usually a higher level interface will handle calling this function.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=36></td>

<td><font face="Times"><b>Semantic Changes</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td><font face="Times">The following changes affect the semantics of existing functionality in the Application Kit:</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">NXColorPanel</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">The ColorPanel's opacity default has changed from its 2.1 default.&nbsp; In 2.1 the ColorPanel had an opacity slider by default.&nbsp; Now it does not have an opacity slider by default, and the Application is set to &#34;not import alpha&#34; by default (see Application's </font><font face="Courier"><b>setImportAlpha:</b></font> <font face="Times">method).&nbsp; This change has no effect on applications which have not been recompiled for 3.0.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">The ColorPanel's &#34;continuous&#34; default has changed from its 2.1 default.&nbsp; In 2.1 the ColorPanel was not continuous by default.&nbsp; Now it is.&nbsp; This change has no effect on applications which have not been recompiled for 3.0.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">If color panel's initial mode mask is &#34;0&#34; (no pickers), the panel will not be shown.&nbsp; This is an effective way of preventing the panel from ever being shown (even when wells in your app are clicked on, etc.).</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">NXColorWell</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">NXColorWell's</font> <font face="Courier"><b>drawWellInside:</b></font> <font face="Times">used to</font> <font face="Courier"><b>lockFocus</b></font> <font face="Times">and</font> <font face="Courier"><b>unlockFocus</b></font><font face="Times">. In apps linked against 3.0, it will no longer do this.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Panel</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">The autosizing bits contained in the view passed to Panel's</font> <font face="Courier"><b>setAccessoryView: </b></font><font face="Times">method used to be ignored, and replaced.&nbsp; This has changed so that if there are autosizing bits with this view, they will not be modified.&nbsp; If there are no autosizing bits, the</font> <font face="Courier"><b>(NX_MINXMARGINSIZABLE | NX_MAXXMARGINSIZABLE)</b></font> <font face="Times">bits will be added. This change has no effect on applications which have not been recompiled for 3.0.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">NXImage</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">Under 2.0, if an NXImage had a delegate implementing the </font><font face="Courier"><b>imageDidNotDraw:inRect:</b></font> <font face="Times">error handling method, this delegate would be consulted whenever the image was told to</font> <font face="Courier"><b>composite:...</b></font> <font face="Times">(or</font> <font face="Courier"><b>dissolve:...</b></font><font face="Times">) and the operation failed (most probably because the cache could not be created, the image did not exist, or there were errors during rendering).&nbsp; Under 3.0, for apps linked against 3.0, this delegate method will also be consulted when</font> <font face="Courier"><b>lockFocus</b></font> <font face="Times">or </font><font face="Courier"><b>lockFocusOn:</b></font> <font face="Times">encounters an error. If the delegate method does return an alternate image, then that image will be sent a</font> <font face="Courier"><b>lockFocus</b></font> <font face="Times">and the result of that operation will be returned to the client. If either</font> <font face="Courier"><b>lockFocus</b></font> <font face="Times">(on the original image or on the error handler) succeeds, the client should call</font> <font face="Courier"><b>unlockFocus</b></font> <font face="Times">(on the original image).</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">Under 2.x, all NXImages caches created as a result of</font> <font face="Courier"><b>useCacheWithDepth:</b></font> <font face="Times">(or </font><font face="Courier"><b>lockFocus</b></font> <font face="Times">without any other image source)&nbsp; were unique, even&nbsp; through the unique bit is off by default. What's worse, even if you called</font> <font face="Courier"><b>setUnique:NO</b></font><font face="Times">, they'd still remain unique. Under 3.0, by default, these caches will still be unique; however, if you do set the uniqueness one way or the other, the unique bit will be honored. Thus it's possible for simple cached images to share caches between each other--Just make sure you don't accidentally promote caches (thus all other images in the caches) to have more colors or alpha while drawing into an image.&nbsp; Alpha promotion is the greater problem; because windows depths are normally limited, undesired color promotion won't happen too often. For instance, caches which are meant to serve as temporary backing stores for underbits of covered areas in windows should probably still be kept unique--Otherwise if they are accidently promoted, they will end up promoting the original source window when composited!</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">This is not an issue for images created from files or streams as their depths are determined by the NXImage and appropriate caches chosen. For custom images (added to NXImage with</font> <font face="Courier"><b>useDrawMethod:inObject:</b></font><font face="Times">) you should set the image characteristics of the image rep to let NXImage choose the appropriate depth cache.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">Under 2.x, images upto 128 pixels wide could be put into shared image caches; under 3.0, this limit is 256 and can be set with</font> <font face="Courier"><b>NXMaxSharedImageWidth</b></font> <font face="Times">default. The purpose of this default is to allow developers to easily catch bugs resulting from images inadvertently sharing caches; if you think an application is having problems due to shared image caching, try:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">dwrite <i>appname</i> NXMaxSharedImageWidth -1</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">Value of -1 disables all image cache sharing. During normal use an app should not have to set this default; if an image cannot be put in a shared cache for some reason, use </font><font face="Courier"><b>setUnique:YES</b></font><font face="Times">.</font>

<p><font face="Times">The</font> <font face="Courier"><b>setSize:</b></font> <font face="Times">method of NXImage no longer forces a cache redraw if the new size is the same as the old size.&nbsp; This change will only take effect for applications that are linked under 3.0.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Designated initializer for Window and its subclasses</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">This is not a semantic change, just a reiteration that the designated initializer (the one you should override to put subclass-specific behaviour in) for Window is </font><font face="Courier"><b>initContent:style:backing:buttonMask:defer:</b></font><font face="Times">, not the same method with</font> <font face="Courier"><b>screen:</b></font> <font face="Times">at the end!</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Speaker/Listener</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">Speaker/Listener messages are now secure (meaning you cannot get the port of a Listener on another machine unless that machine is running with PublicWindowServer turned on).</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">The</font>&nbsp; <font face="Courier"><b>performRemoteMethod:paramList:</b></font> <font face="Times">method of Listener no longer requires that the method contained in the NXRemoteMethod structure come from the </font><font face="Courier"><b>remoteMethodFor:</b></font> <font face="Times">method.&nbsp; These structures can now be composed, and the method will be searched based on a comparison of the selector in the structure.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Matrix</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">Radiomode matrices now properly allow &#34;Empty Selection&#34; (i.e. the absence of any selected cell), when set to allow it.&nbsp; In the past, if a Radiomode matrix was set to allow empty selection, it would still never allow all cells to be deselected at once.&nbsp; It will now allow this.&nbsp; This change will only effect applications which are recompiled for 3.0.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">In list mode, the</font> <font face="Courier"><b>selectedCell, selectedRow</b></font><font face="Times">, and</font> <font face="Courier"><b>selectedCol</b></font> <font face="Times">methods used to return the row, column and cell of the cell which received the mouse up during a tracking session.&nbsp; To return a more useful result, if the cell moused-up on was deslected as a result (i.e. the shift key was down), Matrix will now return the previously selected cell, if it is still selected, otherwise it will find the first highlighted cell it can, if there are no highlighted cells, it will return the cell moused-up on.&nbsp; This fix only effects apps which recompile post-2.1.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">When the Matrix's</font> <font face="Courier"><b>selectAll:</b></font> <font face="Times">method is called, each cell in the Matrix will have their</font> <font face="Courier"><b>highlight:inView:lit:</b></font> <font face="Times">method called.&nbsp; Before 3.0, only their state was set to 1.&nbsp; This change will only take effect in applications relinked under 3.0.</font></td></tr>

<tr valign=top>

<td width=72 height=18></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">According to the documentation,</font> <font face="Courier"><b>selectCell:<i>aCell</i></b></font> <font face="Times">was supposed to return</font> <font face="Courier"><b>nil </b></font><font face="Times">if</font> <font face="Courier"><b>aCell</b></font> <font face="Times">is not in the receiving Matrix. In actuality, it would return whatever value was contained in</font> <font face="Courier"><b>aCell</b></font><font face="Times">.&nbsp; For applications relinked under 3.0, this has been changed to behave as described in the documentation (e.g. return</font> <font face="Courier"><b>nil</b></font> <font face="Times">if</font> <font face="Courier"><b>aCell</b></font> <font face="Times">is not in the receiving Matrix).</font></td></tr>

<tr valign=top>

<td width=72 height=18></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">According to the documentation,</font> <font face="Courier"><b>findIndexWithTag:<i>aTag</i></b></font> <font face="Times">was supposed to return</font> <font face="Courier"><b>-1</b></font> <font face="Times">if there is no field with</font> <font face="Courier"><b>aTag</b></font> <font face="Times">in the receiving Form. In actuality, it would return 0.&nbsp; For applications relinked under 3.0, this has been changed to behave as described in the documentation (e.g. return</font> <font face="Courier"><b>-1</b></font> <font face="Times">if a field with</font> <font face="Courier"><b>aTag</b></font> <font face="Times">is not in the receiving Matrix).</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">The</font> <font face="Courier"><b>insertRowAt:</b></font> <font face="Times">and</font> <font face="Courier"><b>insertColAt:</b></font> <font face="Times">methods have been changed so that&nbsp; if the column or row where the insertion is to take place is larger that the last row or column, then all necessary rows or columns will be created in order to accomodate the request.&nbsp; This sort of request used to cause a segmentation fault.&nbsp; This is now a useful method for increasing the size of matrices by more than one row or column at a time.</font></td></tr>

<tr valign=top>

<td width=72 height=18></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">The semantic for sending a</font> <font face="Courier"><b>doubleAction</b></font> <font face="Times">in Matrix has been changed.&nbsp; In 2.1, if a Matrix received a double-click, it would first try to send it to the cell's</font> <font face="Courier"><b>action </b></font><font face="Times">method.&nbsp; If the cell had no</font> <font face="Courier"><b>action</b></font> <font face="Times">method, it would use the Matrix's </font><font face="Courier"><b>doubleAction</b></font> <font face="Times">method.&nbsp; If the Matrix had no</font> <font face="Courier"><b>doubleAction</b></font> <font face="Times">method, it would use the Matrix's</font> <font face="Courier"><b>action</b></font> <font face="Times">method.&nbsp; Applications linked under 3.0 will have the following semantic: the Matrix will first try and call the</font> <font face="Courier"><b>doubleAction</b></font> <font face="Times">method associated with itself.&nbsp; If and only if there is none, then it will try calling the cell's </font><font face="Courier"><b>action</b></font> <font face="Times">method.&nbsp; If that is not set, it will call its own (Matrix's)</font> <font face="Courier"><b>action</b></font> <font face="Times">method.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Text object delegate method</font> <font face="Courier"><b>textWillEnd:</b></font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">In 2.x, the Text delegate would receive the</font> <font face="Courier"><b>textWillEnd:</b></font> <font face="Times">method immediately before the Text object resigns first responder, but only if the Text object had been changed since last becoming first responder.&nbsp; Apps linked against the 3.0 library will receive this action, regardless of whether the Text object has changed.&nbsp; To detect if the text has in fact changed, the delegate must respond to</font> <font face="Courier"><b>textDidChange:</b></font> <font face="Times">and remember this fact when</font> <font face="Courier"><b>textWillEnd:</b></font> <font face="Times">is sent to the delegate.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap><img src="../Images/sp.gif" width=3 height=1><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">NXPortFromName()</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">When passed</font> <font face="Courier"><b>NULL</b></font> <font face="Times">or &#34;&#34; as a hostname, this function will now try to look up the port on the host specified by the</font> <font face="Courier"><b>NXHost</b></font> <font face="Times">default, if the default has been set.&nbsp; Otherwise it will look on the local host.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">NXImageRep</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">Under 2.0 and 2.1 the</font> <font face="Courier"><b>drawAt:</b></font> <font face="Times">and</font> <font face="Courier"><b>drawIn:</b></font> <font face="Times">methods could change the graphics state under certain circumstances. (Mostly by design and in one case, NXEPSImageRep's</font> <font face="Courier"><b>draw</b></font><font face="Times">, due to a bug). In apps linked against 3.0, this is no longer the case; these methods always leave the graphics state as they found it.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">In 2.x, the</font> <font face="Courier"><b>write:</b></font> <font face="Times">methods of NXBitmapImageRep and NXEPSImageRep saved either the filename or the data depending on whether the image rep was created from a file or stream. This made them behave more like NXImage. Under 3.0, for apps linked against 3.0, the</font> <font face="Courier"><b>write:</b></font> <font face="Times">method of these classes always write out the data, whether or not the original data came from a file or a stream.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">Note that NXImage still behaves as it did under 2.x; the</font> <font face="Courier"><b>write:</b></font> <font face="Times">method will write enough data out to recreate the image the same way it was originally created (from a name, from a file, from a section, or from actual data). This behaviour follows the overall design of NXImage--to be lazy and to hold on to as little redundant information as possible.&nbsp; If you wish to create an NXImage from a file but actually have the data archived when you</font> <font face="Courier"><b>write:</b></font><font face="Times">, use the</font> <font face="Courier"><b>loadFromFile:</b></font> <font face="Times">method instead of </font><font face="Courier"><b>useFromFile:</b></font> <font face="Times">or</font> <font face="Courier"><b>initFromFile:</b></font><font face="Times">. NXImages which are handed filenames through</font> <font face="Courier"><b>useFromFile:</b></font> <font face="Times">or</font> <font face="Courier"><b>initFromFile:</b></font> <font face="Times">firmly (and perhaps naively) believe that those files will always be around.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Control/Cell</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">If you send</font> <font face="Courier"><b>setFloatValue:</b></font> <font face="Times">or</font> <font face="Courier"><b>setDoubleValue:</b></font> <font face="Times">to a Cell (or Control), the AppKit will use the appropriate thousands separator depending on the language of the user (usually either &#34;,&#34; or &#34;.&#34;).&nbsp; When the user types into a Cell (whether it be a TextField or Form or whatever), it will accept EITHER the local separator or, for backwards compatibility, &#34;.&#34;. This only occurs in applications which recompile post-2.1. Note that</font> <font face="Courier"><b>floatValue</b></font> <font face="Times">and</font> <font face="Courier"><b>doubleValue</b></font> <font face="Times">will still return valid values.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">The ButtonCell method</font> <font face="Courier"><b>setIconPosition:</b></font> <font face="Times">used to inconsistently update itself.&nbsp; It now always updates itself (for applications relinked under 3.0).</font></td></tr>

<tr valign=top>

<td width=72 height=18></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">The Button and ButtonCell method</font> <font face="Courier"><b>setAltImage:</b></font> <font face="Times">used to only remove the altImage when the &#34;image&#34; parameter was nil IFF there was a &#34;regular&#34; image.&nbsp; Now, if &#34;image&#34; is nil, the altImage will be removed (for applications relinked under 3.0).</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Courier"><b>setEditable:</b></font><font face="Times">in Cell no longer forces a</font> <font face="Courier"><b>setSelectable:</b></font> <font face="Times">(for applications relinked under 3.0).&nbsp; The original selectability is unaffected by calls to </font><font face="Courier"><b>setEditable:NO</b></font><font face="Times">.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">NXBrowser's setCellPrototype: and Matrix's setPrototype:</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">The semantics of</font> <font face="Courier"><b>setPrototype:</b></font> <font face="Times">in Matrix is that the Matrix &#34;owns&#34; that prototype and will free the prototype when the Matrix itself is freed.&nbsp; In 2.1 NXBrowser abused this semantic by giving the same prototype object out to many matrices and then protecting them when the Matrix's were freed so that there would not be multiply freed objects.&nbsp; This was incorrect.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">In 3.0, the NXBrowser now copies (by sending</font> <font face="Courier"><b>copy</b></font> <font face="Times">to the cell) the prototype cell passed to it via</font> <font face="Courier"><b>setCellPrototype:</b></font> <font face="Times">before giving it to its Matrix's via </font><font face="Courier"><b>setPrototype:</b></font><font face="Times">.&nbsp; This also means that the NXBrowser no longer protects against the case where its Matrix's share a single prototype cell.&nbsp; This protection is left in for applications linked under 2.1, but will go away when you rebuild your application under 3.0 (otherwise the Matrix's would leak their prototype cells).</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">Thus, if you set the prototypes of the Matrix's in an NXBrowser DIRECTLY (i.e. not via</font> <font face="Courier"><b>setCellPrototype:</b></font> <font face="Times">in NXBrowser), such that more than one of the Matrix's have exactly the same prototype cell (and not copies thereof), your application will crash when you rebuild it under 3.0.&nbsp; The fix is simple, either use </font><font face="Courier"><b>setCellPrototype:</b></font> <font face="Times">in NXBrowser, or, if you find you must set the prototypes directly in the Matrix's, use</font><br>
<font face="Courier"><b>[matrix setPrototype:[myProto copy]]</b></font> <font face="Times">so that they each get their own copy and don't share a single object.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">NXBrowser</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">It is legal now (if the NXBrowser's delegate implements </font><font face="Courier"><b>loadCell:atRow:inColumn:</b></font><font face="Times">) to pass nil for the NXBrowser's</font> <font face="Courier"><b>prototype</b></font> <font face="Times">or </font><font face="Courier"><b>cellClass</b></font><font face="Times">.&nbsp; This will cause the NXBrowser to never allocate any cells in the columns.&nbsp; This means that every time any information is needed about a cell, the delegate will be consulted.&nbsp; This is obviously somewhat more time consuming that caching the information in cells in the matrix, but for extremely long lists (100,000s, 1,000,00s or more), the space/time trade-off may be worth it.&nbsp; Notice that an NXBrowser like this must be treated with care because there are no cells in the matrices, thus normal activity (like selecting ranges of cells, for example) is sometimes not possible.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">NXColor</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">The</font> <font face="Courier"><b>NXSetColor()</b></font> <font face="Times">function now uses the new window server operator </font><font face="Courier"><b>nxsetrgbcolor</b></font> <font face="Times">to set its color when in any modes other than CMYK. </font><font face="Courier"><b>nxsetrgbcolor</b></font> <font face="Times">uses the</font> <font face="Courier"><b>NXCalibratedRGB</b></font> <font face="Times">color space which is closely related to colorimetry of NeXT monitors; thus it is fast and suitable for interactive rendering.&nbsp; (Please refer to the window server notes for details.)</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">Because</font> <font face="Courier"><b>nxsetrgbcolor</b></font> <font face="Times">changes the color in a color space other than </font><font face="Courier"><b>DeviceRGB</b></font><font face="Times">, apps setting the color through</font> <font face="Courier"><b>NXSetColor()</b></font> <font face="Times">and then reading it back from the server with operators such as</font> <font face="Courier"><b>currentrgbcolor</b></font> <font face="Times">or its friends will fail to get correct results. A default,</font> <font face="Courier"><b>NXUseCalibratedColor</b></font><font face="Times">, has been provided to disable the use of the</font> <font face="Courier"><b>NXCalibratedRGB</b></font> <font face="Times">color space in NXColors for such apps:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">dwrite <i>appname</i> NXUseCalibratedColor NO</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">Note that one side-effect of all these changes is that when printing the output that the kit produces relies more on the standard print package than it did in 2.0. (The &#34;standard print package&#34; is the printPackage.ps file which gets included with every print job or EPS file generated by the kit.) For instance,</font> <font face="Courier"><b>NXSetColor()</b></font> <font face="Times">now generates </font><font face="Courier"><b>nxsetrgbcolor</b></font> <font face="Times">operator and assumes it has been defined appropriately in the print package. The standard print package does indeed contain a definition for this operator; the definition is conditional on whether the printing device is Level I or Level II. However, if the print package has not been included for some reason, this operator will generate PostScript errors on non-NeXT printers.</font>

<p><font face="Times">The bottom line is that <i>any app which relies on the kit objects in any way to generate PostScript should go through the View machinery when generating EPS files and printing</i>.&nbsp; A 2.1 application which doesn't do this might not be able to print on non-NeXT printers under 3.0; in that case, the</font> <font face="Courier"><b>NXUseCalibratedColor</b></font> <font face="Times">default can be used as shown above to get the app to print.</font>

<p><font face="Times">As mentioned earlier, by default, the kit will color calibrate the print output from old applications (applications linked with a version of NEXTSTEP older than 3.0) by interpreting</font> <font face="Courier"><b>setrgbcolor</b></font><font face="Times">,</font> <font face="Courier"><b>setgray</b></font><font face="Times">,</font> <font face="Courier"><b>sethsbcolor,</b></font> <font face="Times">and</font> <font face="Courier"><b>colorimage</b></font> <font face="Times">as calibrated.&nbsp; When a 3.0 application prints, it is assumed that the application is aware of color calibration issues; thus the output (except where EPS files are imported) will not be calibrated. Thus even if an app cannot use NXColors, it should still try to generate calibrated colors. This can be accomplished by using the</font> <font face="Courier"><b>NXCalibratedRGB </b></font><font face="Times">colorspace or the</font> <font face="Courier"><b>nxsetrgbcolor</b></font> <font face="Times">and</font> <font face="Courier"><b>nxsetgray</b></font> <font face="Times">operators, which are defined both when drawing to the display and when printing (the latter is true only when the printPackage is imported).</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">PostScript Level II</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">The kit does not provide Level I emulations of various PostScript Level II operations; thus code which uses patterns, custom colorspaces, etc might not print on Level I printers.&nbsp; However the Kit assures that its own use of Level II operators (such as the </font><font face="Courier"><b>NXCalibratedRGB</b></font> <font face="Times">color space or patterns for scroller backgrounds) will work on Level I printers. Thus NXColor is safe in all cases and</font> <font face="Courier"><b>NXDrawBitmap()</b></font> <font face="Times">is fine as long as long as a custom color space isn't utilized (through </font><font face="Courier"><b>NX_CustomColorSpace</b></font><font face="Times">).</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">The following snippet shows how an application can make sure that any Level II PostScript code it generates is conditional on the</font> <font face="Courier"><b>languagelevel</b></font> <font face="Times">operator so that the PostScript file can be interpreted without errors on both Level I and Level II devices:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">/DeviceIsLevel2</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">systemdict /languagelevel known</font><br>
<img src="../Images/sp.gif" width=127 height=1><font face="Courier" size="-1">{languagelevel 2 ge}{false}ifelse</font><br>
<img src="../Images/sp.gif" width=108 height=1><font face="Courier" size="-1">def</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">OpenPanel/SavePanel</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">When you</font> <font face="Courier"><b>runModalForTypes:...</b></font> <font face="Times">in the OpenPanel, and one of the &#34;types&#34; you were running modal for was not owned by an application in your application paths (e.g., </font><font face="Courier"><b>~/Apps</b></font><font face="Times">,</font> <font face="Courier"><b>/LocalApps</b></font><font face="Times">, etc.), and documents of that type were file packages, they would incorrectly show up as directories in the OpenPanel.&nbsp; This has been fixed.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">The validation method of SavePanel used to be called twice sometimes.&nbsp; It is only called once now (the double call has been left in for compatibility with 2.0 applications--once you recompile your application under 3.0, that behaviour will go away).</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">When running Save or Open panels with &#34;runModalForDirectory&#34;, if the passed in directory string is more than a directory, e.g. it has a filename at the end of it, that filename will be honored, and selected (this was true for 2.1 as well).&nbsp; If a &#34;file:&#34; parameter is specified as well, it will take precedence (if valid) over any trailing filename found in the passed in directory.&nbsp; This will only effect 3.0 apps.&nbsp; As an example, assume there is a directory &#34;/tmp&#34;, and off it are two files, &#34;console.log&#34; and &#34;dummy&#34;, here's what happens under various circumstances:</font><br>
<img src="../Images/sp.gif" width=18 height=1><font face="Times" size="-1">[myPanel runModalForDirectory:&#34;/tmp&#34; file:&#34;dummy&#34;] &lt;- /tmp/dummy are highlighted</font><br>
<img src="../Images/sp.gif" width=18 height=1><font face="Times" size="-1">[myPanel runModalForDirectory:&#34;/tmp&#34; file:&#34;duGmmy&#34;] &lt;- /tmp is highlighted</font><br>
<img src="../Images/sp.gif" width=18 height=1><font face="Times" size="-1">[myPanel runModalForDirectory:&#34;/tmp&#34; file:&#34;&#34;] &lt;- /tmp is highlighted</font><br>
<img src="../Images/sp.gif" width=18 height=1><font face="Times" size="-1">[myPanel runModalForDirectory:&#34;/tmp/dummy&#34; file:&#34;&#34;] &lt;- /tmp/dummy are highlighted</font><br>
<img src="../Images/sp.gif" width=18 height=1><font face="Times" size="-1">[myPanel runModalForDirectory:&#34;/tmp/console.log&#34; file:&#34;&#34;] &lt;- /tmp/console.log are highlighted</font><br>
<img src="../Images/sp.gif" width=18 height=1><font face="Times" size="-1">[myPanel runModalForDirectory:&#34;/tmp/console.log&#34; file:&#34;dummy&#34;] &lt;- /tmp/dummy are highlighted (dummy takes precedence over console.log)</font><br>
<img src="../Images/sp.gif" width=18 height=1><font face="Times" size="-1">[myPanel runModalForDirectory:&#34;/tmp/console.log&#34; file:&#34;duGmmy&#34;] &lt;- /tmp/console.log are highlighted (duGmmy doesn't exist).</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">If users of &#34;chooseDirectories:YES&#34; want file packages to show up as well, then they should also call &#34;setTreatsFilePackagesAsDirectories:YES&#34;.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Delayed Perform change</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">The</font> <font face="Courier"><b>perform:afterDelay:cancelPrevious:</b></font> <font face="Times">method used to (under some circumstances) perform the method twice if you passed 0 for the delay.&nbsp; That is no longer true.&nbsp; Passing a negative number for the delay now means &#34;don't perform it (just </font><font face="Courier"><b>cancelPrevious:</b></font> <font face="Times">if specified).&#34;&nbsp; Passing zero means perform it as soon as possible, but not now (i.e. after the application returns to getting events from the user). This behaviour will only start to happen after you relink your application under 3.0.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">NXHomeDirectory() and NXUserName()</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">The</font> <font face="Courier"><b>NXHomeDirectory()</b></font> <font face="Times">and</font> <font face="Courier"><b>NXUserName()</b></font> <font face="Times">functions operated on the real uid of the process in 2.0.&nbsp; After relinking in 3.0, the semantics will change to operate on the effective uid (euid) of the process unless the euid of the process is zero, in which case, the real uid will be used.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Window</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">If a window has to be moved or resized when being ordered front to fit a given screen, the window delegate will be sent</font> <font face="Courier"><b>windowDidMove:</b></font> <font face="Times">or</font> <font face="Courier"><b>windowDidResize:</b></font><font face="Times">.&nbsp; (In 2.1 this was not the case; the delegate would not be informed.) Along the same lines, if a window has to be resized to fit on the screen, the delegate's </font><font face="Courier"><b>windowWillResize:to:</b></font> <font face="Times">method will be called one or more times to determine if the window can be resized and what an acceptable size is.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Application sections</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">All methods in the AppKit which use look in the macho section to find something (e.g. a </font><font face="Courier"><b>.nib</b></font> <font face="Times">file, an EPS or TIFF file, or a</font> <font face="Courier"><b>.snd</b></font> <font face="Times">file), now look in</font> <font face="Courier"><b>[NXBundle mainBundle]</b></font> <font face="Times">if the thing being searched for is not found in the macho section.&nbsp; The effect of this is to get &#34;for-free&#34; localization of these files simply by making your application an app-wrapper and putting all of your</font> <font face="Courier"><b>.nib</b></font><font face="Times">,</font> <font face="Courier"><b>.snd</b></font><font face="Times">,</font> <font face="Courier"><b>.eps</b></font><font face="Times">, and</font> <font face="Courier"><b>.tiff </b></font><font face="Times">files in</font> <font face="Courier"><b>English.lproj</b></font><font face="Times">.&nbsp; No code changes are required to make these files localizable.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Pasteboard</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">The Pasteboard method</font> <font face="Courier"><b>declareTypes:num:owner:</b></font> <font face="Times">has been changed to return an</font> <font face="Courier"><b>int</b></font> <font face="Times">instead of always returning</font> <font face="Courier"><b>self</b></font><font face="Times">.&nbsp; The</font> <font face="Courier"><b>int</b></font> <font face="Times">returned is the new </font><font face="Courier"><b>changeCount</b></font> <font face="Times">resulting from the declaration.&nbsp; This fixes the race condition inherent in declaring types and then asking for the</font> <font face="Courier"><b>changeCount</b></font><font face="Times">.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Font</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">The Font class no longer gives errors when sent</font> <font face="Courier"><b>alloc</b></font> <font face="Times">or</font> <font face="Courier"><b>allocFromZone</b></font><font face="Times">.&nbsp; It imposes its own zone on all objects it allocates.</font></td></tr>

<tr valign=top>

<td width=72 height=18></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">View</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">Under 2.1, the</font> <font face="Courier"><b>shouldDrawColor</b></font> <font face="Times">method of View always returns YES when printing. Under 3.0, this method queries NXPrinter object when printing and might return YES or NO depending on the current printer's ability to print color.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">The View printing machinery now uses the new PrintInfo to generate print jobs.&nbsp; It puts comments into the Print stream based on the job features in PrintInfo.&nbsp; It uses </font><font face="Courier"><b>reversePageOrder</b></font> <font face="Times">to set up the generated page order of the job.&nbsp; In the absence of any information about the output device, it now generates pages first-to-last, rather than last-to-first.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">Timed entries</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">In 2.x, timed entries were accurate to only 15 ms.&nbsp; In 3.0, they are accurate to ~1 ms.&nbsp; In addition, the time spent in the client supplied procedure used to get accumulated into the period, e.g., a timed entry with period 2 seconds that took 1 second to execute had an effective period of 3 seconds.&nbsp; In 3.0, the system tries to call the proc with the requested periodicity, regardless of how long the proc takes to execute. However, if the proc takes longer than the period the execute, the timed entries will not try to &#34;catch up&#34; to make up for the missed call(s).</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=36></td>

<td><font face="Times"><b>Other Changes</b></font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td><font face="Times">Additional changes made to the AppKit since Release 2.1.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">If the printer is capable of accepting binary images the kit will generate images in binary format when printing. This speeds printing time by spooling smaller files.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Courier"><b>NXColorSpace</b></font> <font face="Times">enum has been extended to include</font> <font face="Courier"><b>NX_CustomColorSpace</b></font><font face="Times">. This value indicates that the image data is to be interpreted according to the color space in the PostScript graphics state at the time the imaging takes place and allows for imaging using custom color spaces. Note that although NXBitmapImageRep class can accept this value as the colorSpace argument, it can't write or read such images to TIFF files.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">NXMeasurementUnit enum has been added to provide a standard set of measurement units to be used in kit API. The</font> <font face="Courier"><b>NXMeasurementUnit</b></font> <font face="Times">default can be used to determine default setting of units in objects that show units (such as PageLayout).</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">It's now possible to run an application with the global window depth limit set to a value greater than than of the default for the system. This feature should allow testing applications as if they were running on machines with deeper screens and should catch some performance problems not apparent when working just on monochorme systems. To enable this feature, use the</font> <font face="Courier"><b>NXWindowDepthLimit</b></font> <font face="Times">default as before, however, prefix the depth limit with &#34;</font><font face="Courier"><b>Test</b></font><font face="Times">&#34; to indicate that the depth limit should be set to the provided value. (Without this prefix, the depth limit is set to the minimum of the provided value and the system default.) An example:</font></td></tr>

</table>

<p><img src="../Images/sp.gif" width=108 height=1><font face="Courier">dwrite <i>appname</i> NXWindowDepthLimit TestTwentyFourBitRGB</font>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=90></td>

<td><font face="Times">This default is for debugging and performance analysis only and should not be used under normal circumstances.</font></td></tr>

</table>

<p>

<table cellspacing=0 cellpadding=0>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">As mentioned before, the kit will assure that application windows are resized and/or moved to properly fit screens of different sizes. Windows created in Interface Builder will also be placed on screens according to the window placement springs specified in the size inspector panel for the window. These features become especially important when running on a small screen; otherwise the title or resize bars of large windows might end up inaccessible to the user.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">To assure that an application runs properly on small screen, without actually having a small screen, you can trick the machine into believing it has one. To do this you need to edit the screen configuration stored in NetInfo. First run NetInfoManager (in /NextAdmin); you should get a window for your local host. Open the directory </font><font face="Courier"><b>/localconfig/screens/MegaPixel</b></font> <font face="Times">and change the value of the</font> <font face="Courier"><b>active </b></font><font face="Times">property to &#34;1&#34; and the width and height in the</font> <font face="Courier"><b>bounds</b></font> <font face="Times">property to anything you wish. Leave the origin at 0, 0.&nbsp; (&#34;0 832 0 624&#34; is one possibility; it describes a 832 x 624 screen).&nbsp; Then save the directory, logout, and restart the window server by specifying &#34;exit&#34; as the user name at the loginwindow. The system should come back up and use a smaller portion of the display as the screen.</font></td></tr>

<tr valign=top>

<td width=72 height=17></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap></td>

<td><font face="Times">To restore your original screen, change</font> <font face="Courier"><b>active</b></font> <font face="Times">to &#34;0&#34; and the</font> <font face="Courier"><b>bounds</b></font> <font face="Times">to &#34;0 1120 0 832&#34; (or whatever it was initially).</font></td></tr>

<tr valign=top>

<td width=72></td>

<td nowrap><font face="Times"><img src="../Images/bullet1.gif" width=4 height=8 vspace=3></font></td>

<td><font face="Times">The Application class's version number has been incremented from one to two.&nbsp; This will serve as the version of the kit as a whole.</font></td></tr>

</table>



</body>
</html>
